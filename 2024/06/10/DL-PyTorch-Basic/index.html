<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Pythonæ·±åº¦å­¦ä¹ ä¹‹PyTorchåŸºç¡€æ•™ç¨‹ | æ±Ÿæ¹–æ˜¯ä½ ç”»ä¸­äº¦æ˜¯ä½ </title><meta name="keywords" content="PyTorch"><meta name="author" content="Xiaotangsmiles"><meta name="copyright" content="Xiaotangsmiles"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="â›„å‰è¨€ PyTorchæ˜¯ä¸€ä¸ªåŸºäºTorchçš„Pythonå¼€æºæœºå™¨å­¦ä¹ (æ·±åº¦å­¦ä¹ )æ¡†æ¶ï¼Œç”±Facebookçš„äººå·¥æ™ºèƒ½ç ”ç©¶é™¢å¼€å‘ï¼Œä¸ä»…èƒ½å¤Ÿå®ç°å¼ºå¤§çš„GPUåŠ é€Ÿï¼Œè¿˜æ”¯æŒåŠ¨æ€ç¥ç»ç½‘ç»œï¼Œä½¿å¾—ç ”ç©¶äººå‘˜å’Œå¼€å‘äººå‘˜èƒ½å¤Ÿè½»æ¾æ„å»ºå’Œè®­ç»ƒå¤æ‚çš„æ·±åº¦å­¦ä¹ æ¨¡å‹ã€‚ä¸TensorFlowç­‰å…¶ä»–æ¡†æ¶ç›¸æ¯”ï¼ŒPytorchçš„ä¸»è¦ä¼˜åŠ¿åœ¨äºå…¶ç®€å•æ˜“ç”¨çš„æ¥å£ã€é«˜æ•ˆçš„æ€§èƒ½å’Œå¼ºå¤§çš„ç”Ÿæ€ç³»ç»Ÿã€‚PyTorchçš„ä¸»è¦ç‰¹ç‚¹å’ŒåŠŸèƒ½ï¼š  åŸºæœ¬æ¦‚å¿µï¼š">
<meta property="og:type" content="article">
<meta property="og:title" content="Pythonæ·±åº¦å­¦ä¹ ä¹‹PyTorchåŸºç¡€æ•™ç¨‹">
<meta property="og:url" content="https://heartlovelife.github.io/2024/06/10/DL-PyTorch-Basic/index.html">
<meta property="og:site_name" content="æ±Ÿæ¹–æ˜¯ä½ ç”»ä¸­äº¦æ˜¯ä½ ">
<meta property="og:description" content="â›„å‰è¨€ PyTorchæ˜¯ä¸€ä¸ªåŸºäºTorchçš„Pythonå¼€æºæœºå™¨å­¦ä¹ (æ·±åº¦å­¦ä¹ )æ¡†æ¶ï¼Œç”±Facebookçš„äººå·¥æ™ºèƒ½ç ”ç©¶é™¢å¼€å‘ï¼Œä¸ä»…èƒ½å¤Ÿå®ç°å¼ºå¤§çš„GPUåŠ é€Ÿï¼Œè¿˜æ”¯æŒåŠ¨æ€ç¥ç»ç½‘ç»œï¼Œä½¿å¾—ç ”ç©¶äººå‘˜å’Œå¼€å‘äººå‘˜èƒ½å¤Ÿè½»æ¾æ„å»ºå’Œè®­ç»ƒå¤æ‚çš„æ·±åº¦å­¦ä¹ æ¨¡å‹ã€‚ä¸TensorFlowç­‰å…¶ä»–æ¡†æ¶ç›¸æ¯”ï¼ŒPytorchçš„ä¸»è¦ä¼˜åŠ¿åœ¨äºå…¶ç®€å•æ˜“ç”¨çš„æ¥å£ã€é«˜æ•ˆçš„æ€§èƒ½å’Œå¼ºå¤§çš„ç”Ÿæ€ç³»ç»Ÿã€‚PyTorchçš„ä¸»è¦ç‰¹ç‚¹å’ŒåŠŸèƒ½ï¼š  åŸºæœ¬æ¦‚å¿µï¼š">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2024/06/10/KdBQXSmlCgFOWR1.jpg">
<meta property="article:published_time" content="2024-06-10T14:00:05.000Z">
<meta property="article:modified_time" content="2024-06-10T07:06:40.791Z">
<meta property="article:author" content="Xiaotangsmiles">
<meta property="article:tag" content="PyTorch">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2024/06/10/KdBQXSmlCgFOWR1.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://heartlovelife.github.io/2024/06/10/DL-PyTorch-Basic/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":250},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'å¤©',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"ä½ å·²åˆ‡æ¢ä¸ºç¹ä½“","cht_to_chs":"ä½ å·²åˆ‡æ¢ä¸ºç®€ä½“","day_to_night":"ä½ å·²åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼","night_to_day":"ä½ å·²åˆ‡æ¢ä¸ºæµ…è‰²æ¨¡å¼","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Pythonæ·±åº¦å­¦ä¹ ä¹‹PyTorchåŸºç¡€æ•™ç¨‹',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-06-10 15:06:40'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">åŠ è½½ä¸­...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/loading1.gif" data-original="/img/touxiang.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">27</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">27</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">11</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><span> åšæ–‡</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><span> åˆ†ç±»</span></a></li><li><a class="site-page child" href="/tags/"><span> æ ‡ç­¾</span></a></li><li><a class="site-page child" href="/archives/"><span> å½’æ¡£</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> ç”Ÿæ´»</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/photos/"><span> ç›¸å†Œ</span></a></li><li><a class="site-page child" href="/music/"><span> éŸ³ä¹</span></a></li><li><a class="site-page child" href="/movies/"><span> å½±è§†</span></a></li><li><a class="site-page child" href="/shuoshuo/"><span> åˆ†äº«</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><span> ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><span> å…³äºç¬”è€…</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://s2.loli.net/2024/06/10/KdBQXSmlCgFOWR1.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">æ±Ÿæ¹–æ˜¯ä½ ç”»ä¸­äº¦æ˜¯ä½ </a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><span> åšæ–‡</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><span> åˆ†ç±»</span></a></li><li><a class="site-page child" href="/tags/"><span> æ ‡ç­¾</span></a></li><li><a class="site-page child" href="/archives/"><span> å½’æ¡£</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> ç”Ÿæ´»</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/photos/"><span> ç›¸å†Œ</span></a></li><li><a class="site-page child" href="/music/"><span> éŸ³ä¹</span></a></li><li><a class="site-page child" href="/movies/"><span> å½±è§†</span></a></li><li><a class="site-page child" href="/shuoshuo/"><span> åˆ†äº«</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><span> ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><span> å…³äºç¬”è€…</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Pythonæ·±åº¦å­¦ä¹ ä¹‹PyTorchåŸºç¡€æ•™ç¨‹</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2024-06-10T14:00:05.000Z" title="å‘è¡¨äº 2024-06-10 22:00:05">2024-06-10</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2024-06-10T07:06:40.791Z" title="æ›´æ–°äº 2024-06-10 15:06:40">2024-06-10</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Python/">Python</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">æ·±åº¦å­¦ä¹ </a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">12.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>48åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Pythonæ·±åº¦å­¦ä¹ ä¹‹PyTorchåŸºç¡€æ•™ç¨‹"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="å‰è¨€">â›„å‰è¨€</h2>
<p>PyTorchæ˜¯ä¸€ä¸ªåŸºäºTorchçš„Pythonå¼€æºæœºå™¨å­¦ä¹ (æ·±åº¦å­¦ä¹ )æ¡†æ¶ï¼Œç”±Facebookçš„äººå·¥æ™ºèƒ½ç ”ç©¶é™¢å¼€å‘ï¼Œä¸ä»…èƒ½å¤Ÿå®ç°å¼ºå¤§çš„GPUåŠ é€Ÿï¼Œè¿˜æ”¯æŒåŠ¨æ€ç¥ç»ç½‘ç»œï¼Œä½¿å¾—ç ”ç©¶äººå‘˜å’Œå¼€å‘äººå‘˜èƒ½å¤Ÿè½»æ¾æ„å»ºå’Œè®­ç»ƒå¤æ‚çš„æ·±åº¦å­¦ä¹ æ¨¡å‹ã€‚ä¸TensorFlowç­‰å…¶ä»–æ¡†æ¶ç›¸æ¯”ï¼ŒPytorchçš„ä¸»è¦ä¼˜åŠ¿åœ¨äºå…¶ç®€å•æ˜“ç”¨çš„æ¥å£ã€é«˜æ•ˆçš„æ€§èƒ½å’Œå¼ºå¤§çš„ç”Ÿæ€ç³»ç»Ÿã€‚PyTorchçš„ä¸»è¦ç‰¹ç‚¹å’ŒåŠŸèƒ½ï¼š</p>
<ul>
<li><strong>åŸºæœ¬æ¦‚å¿µ</strong>ï¼šPyTorchçš„åŸºæœ¬æ¦‚å¿µåŒ…æ‹¬å¼ é‡(Tensor)ã€è‡ªåŠ¨æ±‚å¯¼(Autograd)å’ŒåŠ¨æ€è®¡ç®—å›¾(Dynamic Computation Graph)ã€‚å¼ é‡æ˜¯PyTorchæœ€åŸºæœ¬çš„æ•°æ®ç±»å‹ï¼Œç±»ä¼¼äºå¤šç»´æ•°ç»„ï¼Œç”¨äºå­˜å‚¨å’Œå¤„ç†å¤§è§„æ¨¡çš„æ•°å€¼æ•°æ®ï¼Œå¹¶æ”¯æŒå„ç§æ•°å­¦è¿ç®—å’Œæ“ä½œã€‚è‡ªåŠ¨æ±‚å¯¼æ˜¯PyTorchçš„ä¸€ä¸ªé‡è¦ç‰¹æ€§ï¼Œå®ƒèƒ½è‡ªåŠ¨è®¡ç®—å¼ é‡çš„æ¢¯åº¦ï¼Œæœ‰åŠ©äºæ·±åº¦å­¦ä¹ æ¨¡å‹çš„è®­ç»ƒã€‚åŠ¨æ€è®¡ç®—å›¾åˆ™ä½¿å¾—PyTorchçš„è®¡ç®—è¿‡ç¨‹å¯ä»¥çµæ´»åœ°è¿›è¡Œæ„å»ºå’Œä¿®æ”¹ï¼Œæœ‰åŠ©äºå¼€å‘å¤æ‚çš„ç¥ç»ç½‘ç»œæ¨¡å‹ã€‚</li>
<li><strong>åŸºæœ¬ä½¿ç”¨æ–¹æ³•</strong>ï¼šPyTorchæä¾›äº†ä¸°å¯Œçš„APIå’Œå·¥å…·ï¼Œä½¿å¾—ç”¨æˆ·å¯ä»¥æ–¹ä¾¿åœ°åˆ›å»ºå’Œæ“ä½œå¼ é‡ï¼Œè¿›è¡ŒåŸºæœ¬çš„æ•°å­¦è¿ç®—ï¼Œä»¥åŠæ„å»ºå’Œè®­ç»ƒç¥ç»ç½‘ç»œæ¨¡å‹ã€‚ä¾‹å¦‚ï¼Œç”¨æˆ·å¯ä»¥è½»æ¾åœ°åˆ›å»ºä¸€ä¸ªçŸ©é˜µï¼Œè¿›è¡ŒåŠ æ³•æ“ä½œï¼Œæ”¹å˜çŸ©é˜µçš„ç»´åº¦ï¼Œä»¥åŠä¸NumPyè¿›è¡ŒååŒæ“ä½œç­‰ã€‚</li>
<li><strong>è½¯ä»¶ç‰¹è‰²</strong>ï¼šPyTorchç”±å¤šä¸ªåº“ç»„æˆï¼ŒåŒ…æ‹¬Tensoråº“ã€è‡ªåŠ¨åˆ†åŒ–åº“ã€ç¥ç»ç½‘ç»œåº“ã€å¤šå¤„ç†åº“å’Œå®ç”¨å‡½æ•°åº“ç­‰ã€‚è¿™äº›åº“æä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½å’Œå·¥å…·ï¼Œä½¿å¾—PyTorchæ—¢å¯ä»¥ä½œä¸ºNumpyçš„æ›¿ä»£å“ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºæ·±åº¦å­¦ä¹ ç ”ç©¶å¹³å°ï¼Œæä¾›æœ€ä½³çš„çµæ´»æ€§å’Œé€Ÿåº¦ã€‚</li>
<li><strong>ç”Ÿæ€ç³»ç»Ÿç»„ä»¶</strong>ï¼štorchvisionä¸€ä¸ªç”¨äºè®¡ç®—æœºè§†è§‰ä»»åŠ¡çš„åº“ï¼ŒåŒ…å«å¸¸è§æ•°æ®é›†ã€é¢„è®­ç»ƒæ¨¡å‹å’Œå·¥å…·ï¼›torchtextä¸€ä¸ªç”¨äºæ–‡æœ¬å¤„ç†ä»»åŠ¡çš„åº“ï¼Œæ”¯æŒæ–‡æœ¬æ¸…æ´—ã€åˆ†è¯ç­‰åŠŸèƒ½ï¼›torch.nnä¸€ä¸ªç”¨äºæ„å»ºç¥ç»ç½‘ç»œçš„æ¨¡å—ï¼Œæä¾›äº†å„ç§å±‚ã€æŸå¤±å‡½æ•°å’Œä¼˜åŒ–å™¨ï¼›torch.distributedä¸€ä¸ªç”¨äºåˆ†å¸ƒå¼è®­ç»ƒçš„åº“ï¼Œå¯ä»¥è½»æ¾å®ç°å¤šæœºå¤šå¡è®­ç»ƒã€‚</li>
<li><strong>å­¦ä¹ èµ„æº</strong>ï¼šPyTorchå®˜æ–¹æ–‡æ¡£æä¾›äº†è¯¦ç»†çš„æ•™ç¨‹å’ŒAPIæ–‡æ¡£ï¼Œé€‚åˆåˆå­¦è€…å…¥é—¨å’Œæ·±å…¥å­¦ä¹ ã€‚æ­¤å¤–ï¼ŒPyTorchä¸­æ–‡ç½‘ã€GitHubä¸Šçš„å¼€æºé¡¹ç›®ä»¥åŠåšå®¢ã€è®ºå›å’Œåœ¨çº¿ç¤¾åŒºç­‰ä¹Ÿæä¾›äº†ä¸°å¯Œçš„æ•™ç¨‹ã€è§£ç­”å’Œè®¨è®ºï¼Œæœ‰åŠ©äºç”¨æˆ·æ›´å¥½åœ°å­¦ä¹ å’Œä½¿ç”¨PyTorchã€‚</li>
<li><strong>åº”ç”¨åœºæ™¯</strong>ï¼šPyTorchçš„åº”ç”¨åœºæ™¯éå¸¸å¹¿æ³›ï¼ŒåŒ…æ‹¬å›¾åƒè¯†åˆ«ã€è‡ªç„¶è¯­è¨€å¤„ç†ã€è®¡ç®—æœºè§†è§‰ç­‰é¢†åŸŸã€‚ä¾‹å¦‚ï¼Œåœ¨å›¾åƒè¯†åˆ«é¢†åŸŸï¼ŒPyTorchå¯ä»¥ç”¨äºè®­ç»ƒå›¾åƒåˆ†ç±»å™¨ï¼›åœ¨è‡ªç„¶è¯­è¨€å¤„ç†é¢†åŸŸï¼ŒPyTorchå¯ä»¥ç”¨äºè®­ç»ƒæ–‡æœ¬åˆ†ç±»å™¨ï¼›åœ¨è®¡ç®—æœºè§†è§‰é¢†åŸŸï¼ŒPyTorchå¯ä»¥ç”¨äºå®ç°è®¡ç®—æœºè§†è§‰æ¨ç†ç³»ç»Ÿç­‰ã€‚</li>
</ul>
<p>æ€»çš„æ¥è¯´ï¼ŒPyTorchæ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§ã€çµæ´»æ˜“ç”¨çš„æ·±åº¦å­¦ä¹ å¹³å°ï¼Œé€‚ç”¨äºå„ç§äººå·¥æ™ºèƒ½ç ”ç©¶å’Œåº”ç”¨åœºæ™¯ã€‚PyTorchæ˜¯ä¸€ä¸ªåŸºäºPythonçš„ç§‘å­¦è®¡ç®—åŒ…ï¼Œä¸»è¦å®šä½ä¸¤ç±»äººç¾¤ï¼š</p>
<ul>
<li><p>NumPyçš„æ›¿ä»£å“ï¼Œå¯ä»¥åˆ©ç”¨GPUçš„æ€§èƒ½è¿›è¡Œè®¡ç®—ï¼›</p></li>
<li><p>æ·±åº¦å­¦ä¹ ç ”ç©¶å¹³å°æ‹¥æœ‰è¶³å¤Ÿçš„çµæ´»æ€§å’Œé€Ÿåº¦ã€‚</p></li>
</ul>
<h2 id="pytorchåŸºç¡€">â›„PyTorchåŸºç¡€</h2>
<h3 id="numpyåŸºç¡€">ğŸ‘€NumpyåŸºç¡€</h3>
<p>åœ¨æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ ä¸­ï¼Œå›¾åƒã€å£°éŸ³ã€æ–‡æœ¬ç­‰è¾“å…¥æ•°æ®æœ€ç»ˆéƒ½è¦è½¬æ¢ä¸ºæ•°ç»„æˆ–çŸ©é˜µã€‚å¦‚ä½•æœ‰æ•ˆåœ°è¿›è¡Œæ•°ç»„å’ŒçŸ©é˜µçš„è¿ç®—ï¼Ÿè¿™å°±éœ€è¦å……åˆ†åˆ©ç”¨Numpyã€‚Numpyæ˜¯æ•°æ®ç§‘å­¦çš„é€šç”¨è¯­è¨€ï¼Œè€Œä¸”ä¸PyTorchå…³ç³»éå¸¸å¯†åˆ‡ï¼Œå®ƒæ˜¯ç§‘å­¦è®¡ç®—ã€æ·±åº¦å­¦ä¹ çš„åŸºçŸ³ã€‚å°¤å…¶å¯¹PyTorchè€Œè¨€ï¼Œå…¶é‡è¦æ€§æ›´åŠ æ˜æ˜¾ã€‚PyTorchä¸­çš„Tensorä¸Numpyéå¸¸ç›¸ä¼¼ï¼Œå®ƒä»¬ä¹‹é—´å¯ä»¥éå¸¸æ–¹ä¾¿åœ°è¿›è¡Œè½¬æ¢ï¼ŒæŒæ¡Numpyæ˜¯å­¦å¥½PyTorchçš„é‡è¦åŸºç¡€ã€‚</p>
<p>Numpy(Numerical Python)æä¾›äº†ä¸¤ç§åŸºæœ¬çš„å¯¹è±¡ï¼šndarray(N-dimensional Array Object)å’Œufunc(Universal Function Object)ã€‚ndarrayæ˜¯å­˜å‚¨å•ä¸€æ•°æ®ç±»å‹çš„å¤šç»´æ•°ç»„ï¼Œè€Œufuncåˆ™æ˜¯èƒ½å¤Ÿå¯¹æ•°ç»„è¿›è¡Œå¤„ç†çš„å‡½æ•°ã€‚</p>
<h4 id="numpyæ•°ç»„">ğŸ‘Numpyæ•°ç»„</h4>
<p><strong>ï¼ˆ1ï¼‰ä»å·²æœ‰æ•°æ®ä¸­åˆ›å»ºæ•°ç»„</strong></p>
<p>é€šè¿‡ç›´æ¥å¯¹Pythonçš„åŸºç¡€æ•°æ®ç±»å‹(å¦‚åˆ—è¡¨ã€å…ƒç»„ç­‰)è¿›è¡Œè½¬æ¢æ¥ç”Ÿæˆndarrayï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="comment"># å°†åˆ—è¡¨è½¬æ¢æˆndarray</span></span><br><span class="line">list1 = [<span class="number">3.5</span>, <span class="number">2.5</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">nd1 = np.array(list1)</span><br><span class="line"><span class="built_in">print</span>(nd1)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(nd1))</span><br><span class="line"><span class="comment"># åµŒå¥—åˆ—è¡¨å¯ä»¥è½¬æ¢æˆå¤šç»´ndarray</span></span><br><span class="line">list2 = [[<span class="number">3.5</span>, <span class="number">2.5</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]]</span><br><span class="line">nd2 = np.array(list2)</span><br><span class="line"><span class="built_in">print</span>(nd2)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(nd2))</span><br><span class="line"><span class="comment"># å°†å…ƒç»„è½¬æ¢æˆndarray</span></span><br><span class="line">list3 = (<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>)</span><br><span class="line">nd3 = np.array(list3)</span><br><span class="line"><span class="built_in">print</span>(nd3)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(nd3))</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºç»“æœ</span></span><br><span class="line">[<span class="number">3.5</span> <span class="number">2.5</span> <span class="number">0.</span>  <span class="number">1.</span>  <span class="number">2.</span> ]</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;numpy.ndarray&#x27;</span>&gt;</span><br><span class="line">[[<span class="number">3.5</span> <span class="number">2.5</span> <span class="number">0.</span>  <span class="number">1.</span>  <span class="number">2.</span> ]</span><br><span class="line"> [<span class="number">1.</span>  <span class="number">2.</span>  <span class="number">3.</span>  <span class="number">4.</span>  <span class="number">5.</span> ]]</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;numpy.ndarray&#x27;</span>&gt;</span><br><span class="line">[<span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span>]</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;numpy.ndarray&#x27;</span>&gt;</span><br></pre></td></tr></table></figure>
<p><strong>ï¼ˆ2ï¼‰åˆ©ç”¨randomæ¨¡å—ç”Ÿæˆæ•°ç»„</strong></p>
<p>åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å¯¹ä¸€äº›å‚æ•°è¿›è¡Œåˆå§‹åŒ–ï¼Œä¸ºäº†æ›´æœ‰æ•ˆåœ°è®­ç»ƒæ¨¡å‹ï¼Œæé«˜æ¨¡å‹çš„æ€§èƒ½ï¼Œæœ‰äº›åˆå§‹åŒ–è¿˜éœ€è¦æ»¡è¶³ä¸€å®šçš„æ¡ä»¶ï¼Œå¦‚æ»¡è¶³æ­£æ€åˆ†å¸ƒæˆ–å‡åŒ€åˆ†å¸ƒç­‰ã€‚np.randomæ¨¡å—å¸¸ç”¨å‡½æ•°ï¼š</p>
<table>
<thead>
<tr class="header">
<th>å‡½æ•°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>np.random.random</td>
<td>ç”Ÿæˆ0åˆ°1ä¹‹é—´çš„éšæœºæ•°</td>
</tr>
<tr class="even">
<td>np.random.uniform</td>
<td>ç”Ÿæˆå‡åŒ€åˆ†å¸ƒçš„éšæœºæ•°</td>
</tr>
<tr class="odd">
<td>np.random.randn</td>
<td>ç”Ÿæˆæ ‡å‡†æ­£æ€çš„éšæœºæ•°</td>
</tr>
<tr class="even">
<td>np.random.randint</td>
<td>ç”Ÿæˆéšæœºçš„æ•´æ•°</td>
</tr>
<tr class="odd">
<td>np.random.normal</td>
<td>ç”Ÿæˆæ­£æ€åˆ†å¸ƒ</td>
</tr>
<tr class="even">
<td>np.random.shuffle</td>
<td>éšæœºæ‰“ä¹±é¡ºåº</td>
</tr>
<tr class="odd">
<td>np.random.seed</td>
<td>è®¾ç½®éšæœºæ•°ç§å­</td>
</tr>
<tr class="even">
<td>np.random.random_sample</td>
<td>ç”Ÿæˆéšæœºçš„æµ®ç‚¹æ•°</td>
</tr>
<tr class="odd">
<td>...</td>
<td>...</td>
</tr>
</tbody>
</table>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">nd = np.random.random([<span class="number">3</span>, <span class="number">3</span>])</span><br><span class="line"><span class="built_in">print</span>(nd)</span><br><span class="line"><span class="built_in">print</span>(nd.shape)</span><br><span class="line">np.random.shuffle(nd)</span><br><span class="line"><span class="built_in">print</span>(nd)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºç»“æœ</span></span><br><span class="line">[[<span class="number">0.96651734</span> <span class="number">0.71544924</span> <span class="number">0.70717421</span>]</span><br><span class="line"> [<span class="number">0.92522016</span> <span class="number">0.99484174</span> <span class="number">0.00550428</span>]</span><br><span class="line"> [<span class="number">0.36218919</span> <span class="number">0.11263693</span> <span class="number">0.1816698</span> ]]</span><br><span class="line">(<span class="number">3</span>, <span class="number">3</span>)</span><br><span class="line">[[<span class="number">0.92522016</span> <span class="number">0.99484174</span> <span class="number">0.00550428</span>]</span><br><span class="line"> [<span class="number">0.96651734</span> <span class="number">0.71544924</span> <span class="number">0.70717421</span>]</span><br><span class="line"> [<span class="number">0.36218919</span> <span class="number">0.11263693</span> <span class="number">0.1816698</span> ]]</span><br></pre></td></tr></table></figure>
<p><strong>ï¼ˆ3ï¼‰åˆ›å»ºç‰¹å®šå½¢çŠ¶çš„å¤šç»´æ•°ç»„</strong></p>
<p>å‚æ•°åˆå§‹åŒ–æ—¶ï¼Œæœ‰æ—¶éœ€è¦ç”Ÿæˆä¸€äº›ç‰¹æ®ŠçŸ©é˜µï¼Œå¦‚å…¨æ˜¯0æˆ–1çš„æ•°ç»„æˆ–çŸ©é˜µã€‚</p>
<table>
<thead>
<tr class="header">
<th>å‡½æ•°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>np.zeros((m,n))</td>
<td>åˆ›å»ºmÃ—nçš„å…ƒç´ å…¨ä¸º0çš„æ•°ç»„</td>
</tr>
<tr class="even">
<td>np.ones((m,n))</td>
<td>åˆ›å»ºmÃ—nçš„å…ƒç´ å…¨ä¸º1çš„æ•°ç»„</td>
</tr>
<tr class="odd">
<td>np.empty((m,n))</td>
<td>åˆ›å»ºmÃ—nçš„ç©ºæ•°ç»„ï¼Œç©ºæ•°æ®ä¸­çš„å€¼å¹¶ä¸ä¸º0ï¼Œè€Œæ˜¯æœªåˆå§‹åŒ–çš„åƒåœ¾å€¼</td>
</tr>
<tr class="even">
<td>np.zeros_like(ndarr)</td>
<td>ä»¥ndarrç›¸åŒç»´åº¦åˆ›å»ºå…ƒç´ å…¨ä¸º0æ•°ç»„</td>
</tr>
<tr class="odd">
<td>np.ones_like(ndarr)</td>
<td>ä»¥ndarrç›¸åŒç»´åº¦åˆ›å»ºå…ƒç´ å…¨ä¸º1æ•°ç»„</td>
</tr>
<tr class="even">
<td>np.empty_like(ndarr)</td>
<td>ä»¥ndarrç›¸åŒç»´åº¦åˆ›å»ºç©ºæ•°ç»„</td>
</tr>
<tr class="odd">
<td>np.eye(m)</td>
<td>è¯¥å‡½æ•°ç”¨äºåˆ›å»ºä¸€ä¸ªmÃ—mçš„çŸ©é˜µï¼Œå¯¹è§’çº¿ä¸º1ï¼Œå…¶ä½™ä¸º0</td>
</tr>
<tr class="even">
<td>np.full((m,n), value)</td>
<td>åˆ›å»ºmÃ—nçš„å…ƒç´ å…¨ä¸ºvalueçš„æ•°ç»„ï¼Œvalueä¸ºæŒ‡å®šå€¼</td>
</tr>
<tr class="odd">
<td>...</td>
<td>...</td>
</tr>
</tbody>
</table>
<p><strong>ï¼ˆ4ï¼‰åˆ©ç”¨arangeã€linspaceå‡½æ•°ç”Ÿæˆæ•°ç»„</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># numpyæ¨¡å—ä¸­çš„arangeã€linspaceå‡½æ•°</span></span><br><span class="line"><span class="comment"># startä¸stopç”¨æ¥æŒ‡å®šèŒƒå›´ï¼Œstepç”¨æ¥è®¾å®šæ­¥é•¿ã€‚åœ¨ç”Ÿæˆä¸€ä¸ªndarrayæ—¶ï¼Œstarté»˜è®¤ä¸º0ï¼Œæ­¥é•¿stepå¯ä¸ºå°æ•°ã€‚Pythonæœ‰ä¸ªå†…ç½®å‡½æ•°rangeï¼Œå…¶åŠŸèƒ½ä¸æ­¤ç±»ä¼¼ã€‚</span></span><br><span class="line">np.arange([start,] stop[,step,], dtype=<span class="literal">None</span>)</span><br><span class="line"><span class="comment"># linspaceå¯ä»¥æ ¹æ®è¾“å…¥çš„æŒ‡å®šæ•°æ®èŒƒå›´ä»¥åŠç­‰ä»½æ•°é‡ï¼Œè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªçº¿æ€§ç­‰åˆ†å‘é‡ï¼Œå…¶ä¸­endpointï¼ˆåŒ…å«ç»ˆç‚¹ï¼‰é»˜è®¤ä¸ºTrueï¼Œç­‰åˆ†æ•°é‡numé»˜è®¤ä¸º50ã€‚å¦‚æœå°†retstepè®¾ç½®ä¸ºTrueï¼Œåˆ™ä¼šè¿”å›ä¸€ä¸ªå¸¦æ­¥é•¿çš„ndarrayã€‚</span></span><br><span class="line">np.linspace(start, stop, num=<span class="number">50</span>, endpoint=<span class="literal">True</span>, retstep=<span class="literal">False</span>, dtype=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>
<h4 id="è·å–å…ƒç´ ">ğŸ‘è·å–å…ƒç´ </h4>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">nd = np.random.random([<span class="number">10</span>])</span><br><span class="line"><span class="built_in">print</span>(nd)</span><br><span class="line"><span class="comment"># è·å–æŒ‡å®šä½ç½®çš„æ•°æ®ï¼Œè·å–ç¬¬4ä¸ªå…ƒç´ </span></span><br><span class="line"><span class="built_in">print</span>(nd[<span class="number">3</span>])</span><br><span class="line"><span class="comment"># æˆªå–ä¸€æ®µæ•°æ®</span></span><br><span class="line"><span class="built_in">print</span>(nd[<span class="number">3</span>:<span class="number">6</span>])</span><br><span class="line"><span class="comment"># æˆªå–å›ºå®šé—´éš”æ•°æ®</span></span><br><span class="line"><span class="built_in">print</span>(nd[<span class="number">1</span>:<span class="number">6</span>:<span class="number">2</span>])</span><br><span class="line"><span class="comment"># å€’åºå–æ•°</span></span><br><span class="line"><span class="built_in">print</span>(nd[::-<span class="number">2</span>])</span><br><span class="line"><span class="comment"># æˆªå–ä¸€ä¸ªå¤šç»´æ•°ç»„çš„ä¸€ä¸ªåŒºåŸŸå†…æ•°æ®</span></span><br><span class="line">nd1 = np.arange(<span class="number">25</span>).reshape([<span class="number">5</span>, <span class="number">5</span>])</span><br><span class="line"><span class="built_in">print</span>(nd1)</span><br><span class="line"><span class="built_in">print</span>(nd1[<span class="number">1</span>:<span class="number">3</span>, <span class="number">1</span>:<span class="number">3</span>])</span><br><span class="line"><span class="comment"># æˆªå–ä¸€ä¸ªå¤šç»´æ•°ç»„ä¸­ï¼Œæ•°å€¼åœ¨ä¸€ä¸ªå€¼åŸŸä¹‹å†…çš„æ•°æ®</span></span><br><span class="line"><span class="built_in">print</span>(nd1[(nd1 &gt; <span class="number">3</span>) &amp; (nd1 &lt; <span class="number">10</span>)])</span><br><span class="line"><span class="comment"># æˆªå–å¤šç»´æ•°ç»„ä¸­ï¼ŒæŒ‡å®šçš„è¡Œ,å¦‚è¯»å–ç¬¬2,3è¡Œ</span></span><br><span class="line"><span class="built_in">print</span>(nd1[[<span class="number">1</span>, <span class="number">2</span>]])  <span class="comment"># æˆ–nd12[1:3,:]</span></span><br><span class="line"><span class="comment"># æˆªå–å¤šç»´æ•°ç»„ä¸­ï¼ŒæŒ‡å®šçš„åˆ—,å¦‚è¯»å–ç¬¬2,3åˆ—</span></span><br><span class="line"><span class="built_in">print</span>(nd1[:, <span class="number">1</span>:<span class="number">3</span>])</span><br></pre></td></tr></table></figure>
<p>è·å–æ•°ç»„ä¸­çš„éƒ¨åˆ†å…ƒç´ é™¤äº†é€šè¿‡æŒ‡å®šç´¢å¼•æ ‡ç­¾æ¥å®ç°å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡ä½¿ç”¨ä¸€äº›å‡½æ•°æ¥å®ç°ï¼Œå¦‚é€šè¿‡random.choiceå‡½æ•°ä»æŒ‡å®šçš„æ ·æœ¬ä¸­éšæœºæŠ½å–æ•°æ®ã€‚</p>
<h4 id="numpyçš„ç®—æœ¯è¿ç®—">ğŸ‘Numpyçš„ç®—æœ¯è¿ç®—</h4>
<p>åœ¨æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ ä¸­ï¼Œæ¶‰åŠå¤§é‡çš„æ•°ç»„æˆ–çŸ©é˜µè¿ç®—ï¼Œæˆ‘ä»¬å°†é‡ç‚¹ä»‹ç»ä¸¤ç§å¸¸ç”¨çš„è¿ç®—ã€‚</p>
<ul>
<li><p>ä¸€ç§æ˜¯å¯¹åº”å…ƒç´ ç›¸ä¹˜ï¼Œåˆç§°ä¸ºé€å…ƒä¹˜æ³•(Element-Wise Product)ï¼Œè¿ç®—ç¬¦ä¸ºnp.multiply()æˆ–*ã€‚</p></li>
<li><p>ä¸€ç§æ˜¯ç‚¹ç§¯æˆ–å†…ç§¯å…ƒç´ ï¼Œè¿ç®—ç¬¦ä¸ºnp.dot()ã€‚</p></li>
</ul>
<p><strong>ï¼ˆ1ï¼‰å¯¹åº”å…ƒç´ ç›¸ä¹˜</strong></p>
<p>å¯¹åº”å…ƒç´ ç›¸ä¹˜(Element-Wise Product)æ˜¯ä¸¤ä¸ªçŸ©é˜µä¸­å¯¹åº”å…ƒç´ ä¹˜ç§¯ã€‚np.multiplyå‡½æ•°ç”¨äºæ•°ç»„æˆ–çŸ©é˜µå¯¹åº”å…ƒç´ ç›¸ä¹˜ï¼Œè¾“å‡ºä¸ç›¸ä¹˜æ•°ç»„æˆ–çŸ©é˜µçš„å¤§å°ä¸€è‡´ï¼Œå…¶æ ¼å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ ¼å¼</span></span><br><span class="line"><span class="comment"># x1ã€x2ä¹‹é—´çš„å¯¹åº”å…ƒç´ ç›¸ä¹˜éµå®ˆå¹¿æ’­è§„åˆ™</span></span><br><span class="line">numpy.multiply(x1, x2, /, out=<span class="literal">None</span>, *, where=<span class="literal">True</span>, casting=<span class="string">&#x27;same_kind&#x27;</span>, order=<span class="string">&#x27;K&#x27;</span>, dtype=<span class="literal">None</span>, subok=<span class="literal">True</span>[, signature, extobj])</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¤ºä¾‹</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">A = np.array([[<span class="number">1</span>, <span class="number">2</span>], [-<span class="number">1</span>, <span class="number">4</span>]])</span><br><span class="line">B = np.array([[<span class="number">2</span>, <span class="number">0</span>], [<span class="number">3</span>, <span class="number">4</span>]])</span><br><span class="line"><span class="built_in">print</span>(A*B)</span><br><span class="line"><span class="built_in">print</span>(np.multiply(A, B))</span><br><span class="line"><span class="comment"># Numpyæ•°ç»„ä¸ä»…å¯ä»¥å’Œæ•°ç»„è¿›è¡Œå¯¹åº”å…ƒç´ ç›¸ä¹˜ï¼Œè¿˜å¯ä»¥å’Œå•ä¸€æ•°å€¼ï¼ˆæˆ–ç§°ä¸ºæ ‡é‡ï¼‰è¿›è¡Œè¿ç®—ã€‚è¿ç®—æ—¶ï¼ŒNumpyæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½å’Œæ ‡é‡è¿›è¡Œè¿ç®—ï¼Œå…¶é—´ä¼šç”¨åˆ°å¹¿æ’­æœºåˆ¶</span></span><br><span class="line"><span class="built_in">print</span>(A*<span class="number">2.0</span>)</span><br><span class="line"><span class="built_in">print</span>(A/<span class="number">2.0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºç»“æœ</span></span><br><span class="line">[[ <span class="number">2</span>  <span class="number">0</span>]</span><br><span class="line"> [-<span class="number">3</span> <span class="number">16</span>]]</span><br><span class="line">[[ <span class="number">2</span>  <span class="number">0</span>]</span><br><span class="line"> [-<span class="number">3</span> <span class="number">16</span>]]</span><br><span class="line">[[ <span class="number">2.</span>  <span class="number">4.</span>]</span><br><span class="line"> [-<span class="number">2.</span>  <span class="number">8.</span>]]</span><br><span class="line">[[ <span class="number">0.5</span>  <span class="number">1.</span> ]</span><br><span class="line"> [-<span class="number">0.5</span>  <span class="number">2.</span> ]]</span><br></pre></td></tr></table></figure>
<p>ç”±æ­¤ï¼Œæ¨è€Œå¹¿ä¹‹ï¼Œæ•°ç»„é€šè¿‡ä¸€äº›æ¿€æ´»å‡½æ•°åï¼Œè¾“å‡ºä¸è¾“å…¥å½¢çŠ¶ä¸€è‡´ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">X = np.random.rand(<span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">softmoid</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> / (<span class="number">1</span> + np.exp(-x))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">relu</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> np.maximum(<span class="number">0</span>, x)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">softmax</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> np.exp(x) / np.<span class="built_in">sum</span>(np.exp(x))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;è¾“å…¥å‚æ•°Xçš„å½¢çŠ¶ï¼š&quot;</span>, X.shape)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æ¿€æ´»å‡½æ•°softmoidè¾“å‡ºå½¢çŠ¶ï¼š&quot;</span>, softmoid(X).shape)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æ¿€æ´»å‡½æ•°reluè¾“å‡ºå½¢çŠ¶ï¼š&quot;</span>, relu(X).shape)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æ¿€æ´»å‡½æ•°softmaxè¾“å‡ºå½¢çŠ¶ï¼š&quot;</span>, softmax(X).shape)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºç»“æœ</span></span><br><span class="line">è¾“å…¥å‚æ•°Xçš„å½¢çŠ¶ï¼š (<span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">æ¿€æ´»å‡½æ•°softmoidè¾“å‡ºå½¢çŠ¶ï¼š (<span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">æ¿€æ´»å‡½æ•°reluè¾“å‡ºå½¢çŠ¶ï¼š (<span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">æ¿€æ´»å‡½æ•°softmaxè¾“å‡ºå½¢çŠ¶ï¼š (<span class="number">2</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<p><strong>ï¼ˆ2ï¼‰ç‚¹ç§¯è¿ç®—</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ ¼å¼</span></span><br><span class="line">numpy.dot(a, b, out=<span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¤ºä¾‹</span></span><br><span class="line"><span class="comment"># çŸ©é˜µX1å’ŒçŸ©é˜µX2è¿›è¡Œç‚¹ç§¯è¿ç®—ï¼Œå…¶ä¸­X1å’ŒX2å¯¹åº”ç»´åº¦ï¼ˆå³X1çš„ç¬¬2ä¸ªç»´åº¦ä¸X2çš„ç¬¬1ä¸ªç»´åº¦ï¼‰çš„å…ƒç´ ä¸ªæ•°å¿…é¡»ä¿æŒä¸€è‡´ã€‚æ­¤å¤–ï¼ŒçŸ©é˜µX3çš„å½¢çŠ¶æ˜¯ç”±çŸ©é˜µX1çš„è¡Œæ•°ä¸çŸ©é˜µX2çš„åˆ—æ•°æ„æˆçš„ã€‚</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">X1 = np.array([[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>]])</span><br><span class="line">X2 = np.array([[<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>], [<span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]])</span><br><span class="line">X3 = np.dot(X1, X2)</span><br><span class="line"><span class="built_in">print</span>(X3)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºç»“æœ</span></span><br><span class="line">[[<span class="number">21</span> <span class="number">24</span> <span class="number">27</span>]</span><br><span class="line"> [<span class="number">47</span> <span class="number">54</span> <span class="number">61</span>]]</span><br></pre></td></tr></table></figure>
<h4 id="æ•°ç»„å˜å½¢">ğŸ‘æ•°ç»„å˜å½¢</h4>
<p>åœ¨æœºå™¨å­¦ä¹ åŠæ·±åº¦å­¦ä¹ çš„ä»»åŠ¡ä¸­ï¼Œé€šå¸¸éœ€è¦å°†å¤„ç†å¥½çš„æ•°æ®ä»¥æ¨¡å‹èƒ½æ¥æ”¶çš„æ ¼å¼è¾“å…¥ç»™æ¨¡å‹ï¼Œç„¶åç”±æ¨¡å‹é€šè¿‡ä¸€ç³»åˆ—çš„è¿ç®—ï¼Œæœ€ç»ˆè¿”å›ä¸€ä¸ªå¤„ç†ç»“æœã€‚ç„¶è€Œï¼Œç”±äºä¸åŒæ¨¡å‹æ‰€æ¥æ”¶çš„è¾“å…¥æ ¼å¼ä¸ä¸€æ ·ï¼Œå¾€å¾€éœ€è¦å…ˆå¯¹å…¶è¿›è¡Œä¸€ç³»åˆ—çš„å˜å½¢å’Œè¿ç®—ï¼Œä»è€Œå°†æ•°æ®å¤„ç†æˆç¬¦åˆæ¨¡å‹è¦æ±‚çš„æ ¼å¼ã€‚åœ¨çŸ©é˜µæˆ–è€…æ•°ç»„çš„è¿ç®—ä¸­ï¼Œç»å¸¸ä¼šé‡åˆ°éœ€è¦æŠŠå¤šä¸ªå‘é‡æˆ–çŸ©é˜µæŒ‰æŸè½´æ–¹å‘åˆå¹¶ï¼Œæˆ–å±•å¹³ï¼ˆå¦‚åœ¨å·ç§¯æˆ–å¾ªç¯ç¥ç»ç½‘ç»œä¸­ï¼Œåœ¨å…¨è¿æ¥å±‚ä¹‹å‰ï¼Œéœ€è¦æŠŠçŸ©é˜µå±•å¹³ï¼‰çš„æƒ…å†µã€‚</p>
<p><strong>ï¼ˆ1ï¼‰æ›´æ”¹æ•°ç»„çš„å½¢çŠ¶</strong></p>
<p>ä¿®æ”¹æŒ‡å®šæ•°ç»„çš„å½¢çŠ¶æ˜¯Numpyä¸­æœ€å¸¸è§çš„æ“ä½œä¹‹ä¸€ï¼Œå¸¸è§å‡½æ•°ï¼š</p>
<table>
<thead>
<tr class="header">
<th>å‡½æ•°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>arr.reshape</td>
<td>é‡æ–°å°†å‘é‡arrç»´åº¦è¿›è¡Œæ”¹å˜ï¼Œä¸ä¿®æ”¹å‘é‡æœ¬èº«</td>
</tr>
<tr class="even">
<td>arr.resize</td>
<td>é‡æ–°å°†å‘é‡arrç»´åº¦è¿›è¡Œæ”¹å˜ï¼Œä¿®æ”¹å‘é‡æœ¬èº«</td>
</tr>
<tr class="odd">
<td>arr.T</td>
<td>å¯¹å‘é‡arrè¿›è¡Œè½¬ç½®</td>
</tr>
<tr class="even">
<td>arr.ravel</td>
<td>å¯¹å‘é‡arrè¿›è¡Œå±•å¹³ï¼Œå³å°†å¤šç»´æ•°ç»„å˜æˆ1ç»´æ•°ç»„ï¼Œä¸ä¼šäº§ç”ŸåŸæ•°ç»„çš„å‰¯æœ¬</td>
</tr>
<tr class="odd">
<td>arr.flatten</td>
<td>å¯¹å‘é‡arrè¿›è¡Œå±•å¹³ï¼Œå³å°†å¤šç»´æ•°ç»„å˜æˆ1ç»´æ•°ç»„ï¼Œè¿”å›åŸæ•°ç»„çš„å‰¯æœ¬</td>
</tr>
<tr class="even">
<td>arr.squeeze</td>
<td>åªèƒ½å¯¹ç»´æ•°ä¸º1çš„ç»´åº¦é™ç»´ã€‚å¯¹å¤šç»´æ•°ç»„ä½¿ç”¨æ—¶ä¸ä¼šæŠ¥é”™ï¼Œä½†æ˜¯ä¸ä¼šäº§ç”Ÿä»»ä½•å½±å“</td>
</tr>
<tr class="odd">
<td>arr.transpose</td>
<td>å¯¹é«˜ç»´çŸ©é˜µè¿›è¡Œè½´å¯¹æ¢</td>
</tr>
</tbody>
</table>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr = np.arange(<span class="number">10</span>)</span><br><span class="line"><span class="built_in">print</span>(arr)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span> * <span class="number">20</span>)</span><br><span class="line"><span class="comment"># (1)reshapeæ”¹å˜å‘é‡çš„ç»´åº¦ï¼ˆä¸ä¿®æ”¹å‘é‡æœ¬èº«ï¼‰ï¼š</span></span><br><span class="line"><span class="comment"># å°†å‘é‡ arr ç»´åº¦å˜æ¢ä¸º2è¡Œ5åˆ—</span></span><br><span class="line"><span class="built_in">print</span>(arr.reshape(<span class="number">2</span>, <span class="number">5</span>))</span><br><span class="line"><span class="comment"># æŒ‡å®šç»´åº¦æ—¶å¯ä»¥åªæŒ‡å®šè¡Œæ•°æˆ–åˆ—æ•°, å…¶ä»–ç”¨-1ä»£æ›¿</span></span><br><span class="line"><span class="built_in">print</span>(arr.reshape(<span class="number">5</span>, -<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(arr.reshape(-<span class="number">1</span>, <span class="number">5</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span> * <span class="number">20</span>)</span><br><span class="line"><span class="comment"># (2)resizeæ”¹å˜å‘é‡çš„ç»´åº¦ï¼ˆä¿®æ”¹å‘é‡æœ¬èº«ï¼‰</span></span><br><span class="line"><span class="comment"># å°†å‘é‡ arr ç»´åº¦å˜æ¢ä¸º2è¡Œ5åˆ—</span></span><br><span class="line">arr.resize(<span class="number">2</span>, <span class="number">5</span>)</span><br><span class="line"><span class="built_in">print</span>(arr)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span> * <span class="number">20</span>)</span><br><span class="line"><span class="comment"># (3)Tå‘é‡è½¬ç½®</span></span><br><span class="line"><span class="comment"># å°†å‘é‡arrè¿›è¡Œè½¬ç½®ä¸º5è¡Œ2åˆ—</span></span><br><span class="line"><span class="built_in">print</span>(arr.T)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span> * <span class="number">20</span>)</span><br><span class="line"><span class="comment"># (4)ravelå‘é‡å±•å¹³</span></span><br><span class="line"><span class="comment"># æŒ‰ç…§åˆ—ä¼˜å…ˆï¼Œå±•å¹³</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æŒ‰ç…§åˆ—ä¼˜å…ˆï¼Œå±•å¹³&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(arr.ravel(<span class="string">&#x27;F&#x27;</span>))</span><br><span class="line"><span class="comment"># æŒ‰ç…§è¡Œä¼˜å…ˆï¼Œå±•å¹³</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æŒ‰ç…§è¡Œä¼˜å…ˆï¼Œå±•å¹³&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(arr.ravel())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span> * <span class="number">20</span>)</span><br><span class="line"><span class="comment"># (5)flattenæŠŠçŸ©é˜µè½¬æ¢ä¸ºå‘é‡ï¼Œè¿™ç§éœ€æ±‚ç»å¸¸å‡ºç°åœ¨å·ç§¯ç½‘ç»œä¸å…¨è¿æ¥å±‚ä¹‹é—´ã€‚</span></span><br><span class="line"><span class="built_in">print</span>(arr.flatten())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span> * <span class="number">20</span>)</span><br><span class="line"><span class="comment"># (6)squeezeè¿™æ˜¯ä¸€ä¸ªä¸»è¦ç”¨æ¥é™ç»´çš„å‡½æ•°ï¼ŒæŠŠçŸ©é˜µä¸­å«1çš„ç»´åº¦å»æ‰ã€‚</span></span><br><span class="line">arr1 = np.arange(<span class="number">3</span>).reshape(<span class="number">3</span>, <span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(arr1.shape)  <span class="comment"># (3,1)</span></span><br><span class="line"><span class="built_in">print</span>(arr1.squeeze().shape)  <span class="comment"># (3,)</span></span><br><span class="line">arr2 = np.arange(<span class="number">6</span>).reshape(<span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(arr2.shape)  <span class="comment"># (3, 1, 2, 1)</span></span><br><span class="line"><span class="built_in">print</span>(arr2.squeeze().shape)  <span class="comment"># (3, 2)</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span> * <span class="number">20</span>)</span><br><span class="line"><span class="comment"># (7)transposeå¯¹é«˜ç»´çŸ©é˜µè¿›è¡Œè½´å¯¹æ¢ï¼Œåœ¨æ·±åº¦å­¦ä¹ ä¸­ç»å¸¸ä½¿ç”¨ï¼Œæ¯”å¦‚æŠŠå›¾ç‰‡ä¸­è¡¨ç¤ºé¢œè‰²é¡ºåºçš„RGBæ”¹ä¸ºGBRã€‚</span></span><br><span class="line">arr3 = np.arange(<span class="number">24</span>).reshape(<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line"><span class="built_in">print</span>(arr3.shape)  <span class="comment"># (2, 3, 4)</span></span><br><span class="line"><span class="built_in">print</span>(arr3.transpose(<span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>).shape)  <span class="comment"># (3, 4, 2)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºç»“æœ</span></span><br><span class="line">[<span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span> <span class="number">8</span> <span class="number">9</span>]</span><br><span class="line">********************</span><br><span class="line">[[<span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span>]</span><br><span class="line"> [<span class="number">5</span> <span class="number">6</span> <span class="number">7</span> <span class="number">8</span> <span class="number">9</span>]]</span><br><span class="line">[[<span class="number">0</span> <span class="number">1</span>]</span><br><span class="line"> [<span class="number">2</span> <span class="number">3</span>]</span><br><span class="line"> [<span class="number">4</span> <span class="number">5</span>]</span><br><span class="line"> [<span class="number">6</span> <span class="number">7</span>]</span><br><span class="line"> [<span class="number">8</span> <span class="number">9</span>]]</span><br><span class="line">[[<span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span>]</span><br><span class="line"> [<span class="number">5</span> <span class="number">6</span> <span class="number">7</span> <span class="number">8</span> <span class="number">9</span>]]</span><br><span class="line">********************</span><br><span class="line">[[<span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span>]</span><br><span class="line"> [<span class="number">5</span> <span class="number">6</span> <span class="number">7</span> <span class="number">8</span> <span class="number">9</span>]]</span><br><span class="line">********************</span><br><span class="line">[[<span class="number">0</span> <span class="number">5</span>]</span><br><span class="line"> [<span class="number">1</span> <span class="number">6</span>]</span><br><span class="line"> [<span class="number">2</span> <span class="number">7</span>]</span><br><span class="line"> [<span class="number">3</span> <span class="number">8</span>]</span><br><span class="line"> [<span class="number">4</span> <span class="number">9</span>]]</span><br><span class="line">********************</span><br><span class="line">æŒ‰ç…§åˆ—ä¼˜å…ˆï¼Œå±•å¹³</span><br><span class="line">[<span class="number">0</span> <span class="number">5</span> <span class="number">1</span> <span class="number">6</span> <span class="number">2</span> <span class="number">7</span> <span class="number">3</span> <span class="number">8</span> <span class="number">4</span> <span class="number">9</span>]</span><br><span class="line">æŒ‰ç…§è¡Œä¼˜å…ˆï¼Œå±•å¹³</span><br><span class="line">[<span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span> <span class="number">8</span> <span class="number">9</span>]</span><br><span class="line">********************</span><br><span class="line">[<span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span> <span class="number">8</span> <span class="number">9</span>]</span><br><span class="line">********************</span><br><span class="line">(<span class="number">3</span>, <span class="number">1</span>)</span><br><span class="line">(<span class="number">3</span>,)</span><br><span class="line">(<span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line">(<span class="number">3</span>, <span class="number">2</span>)</span><br><span class="line">********************</span><br><span class="line">(<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line">(<span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<p><strong>ï¼ˆ2ï¼‰åˆå¹¶æ•°ç»„</strong></p>
<p>åˆå¹¶æ•°ç»„ä¹Ÿæ˜¯æœ€å¸¸è§çš„æ“ä½œä¹‹ä¸€ï¼Œå¸¸è§çš„ç”¨äºæ•°ç»„æˆ–å‘é‡åˆå¹¶çš„æ–¹æ³•ã€‚</p>
<table>
<thead>
<tr class="header">
<th>å‡½æ•°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>np.append</td>
<td>åˆå¹¶ä¸€ç»´æˆ–å¤šç»´æ•°ç»„ï¼Œå†…å­˜å ç”¨å¤§</td>
</tr>
<tr class="even">
<td>np.concatenate</td>
<td>æ²¿æŒ‡å®šè½´è¿æ¥æ•°ç»„æˆ–çŸ©é˜µï¼Œæ²¡æœ‰å†…å­˜é—®é¢˜</td>
</tr>
<tr class="odd">
<td>np.stack</td>
<td>æ²¿æŒ‡å®šè½´å †å æ•°ç»„æˆ–çŸ©é˜µï¼Œæ²¿ç€æ–°çš„è½´åŠ å…¥ä¸€ç³»åˆ—æ•°ç»„</td>
</tr>
<tr class="even">
<td>np.hstack</td>
<td>æŒ‰æ°´å¹³æ–¹å‘ï¼ˆåˆ—é¡ºåºï¼‰å †å æ•°ç»„æ„æˆä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œå †å çš„æ•°ç»„éœ€è¦å…·æœ‰ç›¸åŒçš„ç»´åº¦</td>
</tr>
<tr class="odd">
<td>np.vstack</td>
<td>æŒ‰å‚ç›´æ–¹å‘ï¼ˆè¡Œé¡ºåºï¼‰å †å æ•°ç»„æ„æˆä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œå †å çš„æ•°ç»„éœ€è¦å…·æœ‰ç›¸åŒçš„ç»´åº¦</td>
</tr>
<tr class="even">
<td>np.dstack</td>
<td>æ²¿æ·±åº¦æ–¹å‘å°†æ•°ç»„è¿›è¡Œå †å ã€‚å°†ç›¸åŒå°ºå¯¸çš„æ•°ç»„æ²¿ç€ç¬¬ä¸‰ä¸ªç»´åº¦ï¼ˆæ·±åº¦æ–¹å‘ï¼‰è¿›è¡Œæ°´å¹³å åŠ ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„æ•°ç»„ã€‚</td>
</tr>
<tr class="odd">
<td>np.hsplit</td>
<td>å°†ä¸€ä¸ªæ•°ç»„æ°´å¹³ï¼ˆåˆ—ï¼‰åˆ†å‰²æˆå¤šä¸ªå­æ•°ç»„</td>
</tr>
<tr class="even">
<td>np.vsplit</td>
<td>å°†ä¸€ä¸ªæ•°ç»„å‚ç›´ï¼ˆè¡Œï¼‰åˆ†å‰²æˆå¤šä¸ªå­æ•°ç»„</td>
</tr>
</tbody>
</table>
<blockquote>
<ul>
<li><p>appendã€concatenateä»¥åŠstackéƒ½æœ‰ä¸€ä¸ªaxiså‚æ•°ï¼Œç”¨äºæ§åˆ¶æ•°ç»„çš„åˆå¹¶æ–¹å¼æ˜¯æŒ‰è¡Œè¿˜æ˜¯æŒ‰åˆ—ã€‚</p></li>
<li><p>å¯¹äºappendå’Œconcatenateï¼Œå¾…åˆå¹¶çš„æ•°ç»„å¿…é¡»æœ‰ç›¸åŒçš„è¡Œæ•°æˆ–åˆ—æ•°ï¼ˆæ»¡è¶³ä¸€ä¸ªå³å¯ï¼‰ã€‚</p></li>
<li><p>stackã€hstackã€dstackï¼Œè¦æ±‚å¾…åˆå¹¶çš„æ•°ç»„å¿…é¡»å…·æœ‰ç›¸åŒçš„å½¢çŠ¶(shape)ã€‚</p></li>
<li><p>numpy.hsplit(arr, indices_or_sections)å’Œnumpy.vsplit(arr, indices_or_sections)ï¼šâ‘ arræ˜¯è¦æ‹†åˆ†çš„å¤šç»´æ•°ç»„æˆ–çŸ©é˜µ[ndarray]ï¼›â‘¡indices_or_sections : [int or 1-D array] å¦‚æœindices_or_sectionsæ˜¯ä¸€ä¸ªæ•´æ•°Nï¼Œæ•°ç»„å°†æ²¿è½´çº¿è¢«åˆ†æˆNä¸ªç›¸ç­‰çš„æ•°ç»„ã€‚å¦‚æœindices_or_sectionsæ˜¯ä¸€ä¸ªæ’åºçš„æ•´æ•°çš„ä¸€ç»´æ•°ç»„ï¼Œè¿™äº›æ•´æ•°è¡¨ç¤ºè¯¥æ•°ç»„æ²¿è½´çº¿çš„åˆ†å‰²ä½ç½®ã€‚</p></li>
</ul>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># (1)append</span></span><br><span class="line">a = np.array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">b = np.array([<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>])</span><br><span class="line">c = np.append(a, b)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span> * <span class="number">20</span>)</span><br><span class="line">a1 = np.arange(<span class="number">4</span>).reshape(<span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line">b1 = np.arange(<span class="number">4</span>).reshape(<span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line"><span class="comment"># æŒ‰è¡Œåˆå¹¶</span></span><br><span class="line">c1 = np.append(a1, b1, axis=<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;æŒ‰è¡Œåˆå¹¶åçš„ç»“æœ&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(c1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;åˆå¹¶åæ•°æ®ç»´åº¦&#x27;</span>, c1.shape)</span><br><span class="line"><span class="comment"># æŒ‰åˆ—åˆå¹¶</span></span><br><span class="line">d2 = np.append(a1, b1, axis=<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;æŒ‰åˆ—åˆå¹¶åçš„ç»“æœ&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(d2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;åˆå¹¶åæ•°æ®ç»´åº¦&#x27;</span>, d2.shape)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span> * <span class="number">20</span>)</span><br><span class="line"><span class="comment"># (2)concatenateæ²¿æŒ‡å®šè½´è¿æ¥æ•°ç»„æˆ–çŸ©é˜µ</span></span><br><span class="line">a3 = np.array([[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>]])</span><br><span class="line">b3 = np.array([[<span class="number">5</span>, <span class="number">6</span>]])</span><br><span class="line">c3 = np.concatenate((a3, b3), axis=<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(c3)</span><br><span class="line">d3 = np.concatenate((a3, b3.T), axis=<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(d3)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span> * <span class="number">20</span>)</span><br><span class="line"><span class="comment"># (3)stackæ²¿æŒ‡å®šè½´å †å æ•°ç»„æˆ–çŸ©é˜µ,axis=0/1/2</span></span><br><span class="line">a4 = np.array([[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>]])</span><br><span class="line">b4 = np.array([[<span class="number">5</span>, <span class="number">6</span>], [<span class="number">7</span>, <span class="number">8</span>]])</span><br><span class="line"><span class="built_in">print</span>(np.stack((a4, b4), axis=<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span> * <span class="number">20</span>)</span><br><span class="line"><span class="comment"># (3)vstackå’Œhstack</span></span><br><span class="line">a5 = np.array([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]])</span><br><span class="line">b5 = np.array([[<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]])</span><br><span class="line"><span class="built_in">print</span>(np.vstack((a5, b5)))</span><br><span class="line"><span class="built_in">print</span>(np.hstack((a5, b5)))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span> * <span class="number">20</span>)</span><br><span class="line"><span class="comment"># (4)dstack</span></span><br><span class="line">a6 = np.array([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]])</span><br><span class="line">b6 = np.array([[<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>], [<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>]])</span><br><span class="line"><span class="built_in">print</span>(np.dstack((a6, b6)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºç»“æœ</span></span><br><span class="line">[<span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span>]</span><br><span class="line">********************</span><br><span class="line">æŒ‰è¡Œåˆå¹¶åçš„ç»“æœ</span><br><span class="line">[[<span class="number">0</span> <span class="number">1</span>]</span><br><span class="line"> [<span class="number">2</span> <span class="number">3</span>]</span><br><span class="line"> [<span class="number">0</span> <span class="number">1</span>]</span><br><span class="line"> [<span class="number">2</span> <span class="number">3</span>]]</span><br><span class="line">åˆå¹¶åæ•°æ®ç»´åº¦ (<span class="number">4</span>, <span class="number">2</span>)</span><br><span class="line">æŒ‰åˆ—åˆå¹¶åçš„ç»“æœ</span><br><span class="line">[[<span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">1</span>]</span><br><span class="line"> [<span class="number">2</span> <span class="number">3</span> <span class="number">2</span> <span class="number">3</span>]]</span><br><span class="line">åˆå¹¶åæ•°æ®ç»´åº¦ (<span class="number">2</span>, <span class="number">4</span>)</span><br><span class="line">********************</span><br><span class="line">[[<span class="number">1</span> <span class="number">2</span>]</span><br><span class="line"> [<span class="number">3</span> <span class="number">4</span>]</span><br><span class="line"> [<span class="number">5</span> <span class="number">6</span>]]</span><br><span class="line">[[<span class="number">1</span> <span class="number">2</span> <span class="number">5</span>]</span><br><span class="line"> [<span class="number">3</span> <span class="number">4</span> <span class="number">6</span>]]</span><br><span class="line">********************</span><br><span class="line">[[[<span class="number">1</span> <span class="number">2</span>]</span><br><span class="line">  [<span class="number">5</span> <span class="number">6</span>]]</span><br><span class="line"></span><br><span class="line"> [[<span class="number">3</span> <span class="number">4</span>]</span><br><span class="line">  [<span class="number">7</span> <span class="number">8</span>]]]</span><br><span class="line">********************</span><br><span class="line">[[<span class="number">1</span> <span class="number">2</span> <span class="number">3</span>]</span><br><span class="line"> [<span class="number">4</span> <span class="number">5</span> <span class="number">6</span>]]</span><br><span class="line">[[<span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span>]]</span><br><span class="line">********************</span><br><span class="line">[[[ <span class="number">1</span>  <span class="number">7</span>]</span><br><span class="line">  [ <span class="number">2</span>  <span class="number">8</span>]</span><br><span class="line">  [ <span class="number">3</span>  <span class="number">9</span>]]</span><br><span class="line"></span><br><span class="line"> [[ <span class="number">4</span> <span class="number">10</span>]</span><br><span class="line">  [ <span class="number">5</span> <span class="number">11</span>]</span><br><span class="line">  [ <span class="number">6</span> <span class="number">12</span>]]]</span><br></pre></td></tr></table></figure>
<h4 id="æ‰¹é‡å¤„ç†">ğŸ‘æ‰¹é‡å¤„ç†</h4>
<p>åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œç”±äºæºæ•°æ®éƒ½æ¯”è¾ƒå¤§ï¼Œé€šå¸¸éœ€è¦ç”¨åˆ°æ‰¹å¤„ç†ã€‚å¦‚åˆ©ç”¨æ‰¹é‡æ¥è®¡ç®—æ¢¯åº¦çš„éšæœºæ¢¯åº¦æ³•(SGD)å°±æ˜¯ä¸€ä¸ªå…¸å‹åº”ç”¨ã€‚æ·±åº¦å­¦ä¹ çš„è®¡ç®—ä¸€èˆ¬æ¯”è¾ƒå¤æ‚ï¼Œå¹¶ä¸”æ•°æ®é‡ä¸€èˆ¬æ¯”è¾ƒå¤§ï¼Œå¦‚æœä¸€æ¬¡å¤„ç†æ•´ä¸ªæ•°æ®ï¼Œè¾ƒå¤§æ¦‚ç‡ä¼šå‡ºç°èµ„æºç“¶é¢ˆã€‚ä¸ºäº†æ›´æœ‰æ•ˆåœ°è®¡ç®—ï¼Œä¸€èˆ¬å°†æ•´ä¸ªæ•°æ®é›†åˆ†æ‰¹æ¬¡å¤„ç†ã€‚ä¸å¤„ç†æ•´ä¸ªæ•°æ®é›†ç›¸åçš„å¦ä¸€ä¸ªæç«¯æ˜¯æ¯æ¬¡åªå¤„ç†ä¸€æ¡è®°å½•ï¼Œè¿™ç§æ–¹æ³•ä¹Ÿä¸ç§‘å­¦ï¼Œä¸€æ¬¡å¤„ç†ä¸€æ¡è®°å½•æ— æ³•å……åˆ†å‘æŒ¥GPUã€Numpyçš„å¹³è¡Œå¤„ç†ä¼˜åŠ¿ã€‚å› æ­¤ï¼Œåœ¨å®é™…ä½¿ç”¨ä¸­å¾€å¾€é‡‡ç”¨æ‰¹é‡å¤„ç†(Mini-Batch)çš„æ–¹æ³•ã€‚å¦‚ä½•æŠŠå¤§æ•°æ®æ‹†åˆ†æˆå¤šä¸ªæ‰¹æ¬¡å‘¢ï¼Ÿå¯é‡‡ç”¨å¦‚ä¸‹æ­¥éª¤ï¼š</p>
<ol type="1">
<li>æ•°æ®é›†</li>
<li>éšæœºæ‰“ä¹±æ•°æ®ï¼šshuffle()</li>
<li>å®šä¹‰æ‰¹å¤§å°ï¼šbatch_size</li>
<li>æ‰¹å¤„ç†æ•°æ®é›†</li>
</ol>
<h4 id="é€šç”¨å‡½æ•°">ğŸ‘é€šç”¨å‡½æ•°</h4>
<p>ufuncæ˜¯universal functionçš„ç¼©å†™ï¼Œå®ƒæ˜¯ä¸€ç§èƒ½å¯¹æ•°ç»„çš„æ¯ä¸ªå…ƒç´ è¿›è¡Œæ“ä½œçš„å‡½æ•°ã€‚è®¸å¤šufuncå‡½æ•°éƒ½æ˜¯ç”¨Cè¯­è¨€çº§åˆ«å®ç°çš„ï¼Œå› æ­¤å®ƒä»¬çš„è®¡ç®—é€Ÿåº¦éå¸¸å¿«ã€‚æ­¤å¤–ï¼Œå®ƒä»¬æ¯”mathæ¨¡å—ä¸­çš„å‡½æ•°æ›´çµæ´»ã€‚mathæ¨¡å—çš„è¾“å…¥ä¸€èˆ¬æ˜¯æ ‡é‡ï¼Œä½†Numpyä¸­çš„å‡½æ•°å¯ä»¥æ˜¯å‘é‡æˆ–çŸ©é˜µï¼Œè€Œåˆ©ç”¨å‘é‡æˆ–çŸ©é˜µå¯ä»¥é¿å…ä½¿ç”¨å¾ªç¯è¯­å¥ï¼Œè¿™ç‚¹åœ¨æœºå™¨å­¦ä¹ ã€æ·±åº¦å­¦ä¹ ä¸­éå¸¸é‡è¦ã€‚Numpyä¸­çš„å‡ ä¸ªå¸¸ç”¨é€šç”¨å‡½æ•°ï¼š</p>
<table>
<thead>
<tr class="header">
<th>å‡½æ•°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>sqrt</td>
<td>è®¡ç®—åºåˆ—åŒ–æ•°æ®çš„å¹³æ–¹æ ¹</td>
</tr>
<tr class="even">
<td>sinã€cos</td>
<td>ä¸‰è§’å‡½æ•°</td>
</tr>
<tr class="odd">
<td>abs</td>
<td>è®¡ç®—åºåˆ—åŒ–æ•°æ®çš„ç»å¯¹å€¼</td>
</tr>
<tr class="even">
<td>dot</td>
<td>çŸ©é˜µè¿ç®—</td>
</tr>
<tr class="odd">
<td>logã€log10ã€1og2</td>
<td>å¯¹æ•°è¿ç®—</td>
</tr>
<tr class="even">
<td>exp</td>
<td>æŒ‡æ•°è¿ç®—</td>
</tr>
<tr class="odd">
<td>cumsumã€cumproduct</td>
<td>ç´¯è®¡æ±‚å’Œã€æ±‚ç§¯</td>
</tr>
<tr class="even">
<td>sum</td>
<td>å¯¹ä¸€ä¸ªåºåˆ—åŒ–æ•°æ®è¿›è¡Œæ±‚å’Œ</td>
</tr>
<tr class="odd">
<td>mean</td>
<td>è®¡ç®—å‡å€¼</td>
</tr>
<tr class="even">
<td>median</td>
<td>è®¡ç®—ä¸­ä½æ•°</td>
</tr>
<tr class="odd">
<td>std</td>
<td>è®¡ç®—æ ‡å‡†å·®</td>
</tr>
<tr class="even">
<td>var</td>
<td>è®¡ç®—æ–¹å·®</td>
</tr>
<tr class="odd">
<td>corrcoef</td>
<td>è®¡ç®—ç›¸å…³ç³»æ•°</td>
</tr>
</tbody>
</table>
<h4 id="å¹¿æ’­æœºåˆ¶">ğŸ‘å¹¿æ’­æœºåˆ¶</h4>
<p>Numpyçš„Universal functionsä¸­è¦æ±‚è¾“å…¥çš„æ•°ç»„shapeæ˜¯ä¸€è‡´çš„ï¼Œå½“æ•°ç»„çš„shapeä¸ç›¸ç­‰æ—¶ï¼Œåˆ™ä¼šä½¿ç”¨å¹¿æ’­æœºåˆ¶ã€‚ä¸è¿‡ï¼Œè°ƒæ•´æ•°ç»„ä½¿å¾—shapeä¸€æ ·ï¼Œéœ€è¦æ»¡è¶³ä¸€å®šçš„è§„åˆ™ï¼Œå¦åˆ™å°†å‡ºé”™ã€‚è¿™äº›è§„åˆ™å¯å½’çº³ä¸ºä»¥ä¸‹4æ¡ã€‚</p>
<ul>
<li>è®©æ‰€æœ‰è¾“å…¥æ•°ç»„éƒ½å‘å…¶ä¸­shapeæœ€é•¿çš„æ•°ç»„çœ‹é½ï¼Œä¸è¶³çš„éƒ¨åˆ†åˆ™é€šè¿‡åœ¨å‰é¢åŠ 1è¡¥é½ï¼›</li>
<li>è¾“å‡ºæ•°ç»„çš„shapeæ˜¯è¾“å…¥æ•°ç»„shapeçš„å„ä¸ªè½´ä¸Šçš„æœ€å¤§å€¼ï¼›</li>
<li>å¦‚æœè¾“å…¥æ•°ç»„çš„æŸä¸ªè½´å’Œè¾“å‡ºæ•°ç»„çš„å¯¹åº”è½´çš„é•¿åº¦ç›¸åŒæˆ–è€…æŸä¸ªè½´çš„é•¿åº¦ä¸º1æ—¶ï¼Œè¿™ä¸ªæ•°ç»„èƒ½è¢«ç”¨æ¥è®¡ç®—ï¼Œå¦åˆ™å‡ºé”™ï¼›</li>
<li>å½“è¾“å…¥æ•°ç»„çš„æŸä¸ªè½´çš„é•¿åº¦ä¸º1æ—¶ï¼Œæ²¿ç€æ­¤è½´è¿ç®—æ—¶éƒ½ç”¨(æˆ–å¤åˆ¶)æ­¤è½´ä¸Šçš„ç¬¬ä¸€ç»„å€¼ã€‚</li>
</ul>
<blockquote>
<p>ä¾‹å­ï¼šA+Bï¼Œå…¶ä¸­Aä¸º4Ã—1çŸ©é˜µï¼ŒBä¸ºä¸€ç»´å‘é‡ï¼ˆ3,ï¼‰ã€‚è¦ç›¸åŠ ï¼Œéœ€è¦åšå¦‚ä¸‹å¤„ç†ï¼š</p>
<ol type="1">
<li>æ ¹æ®è§„åˆ™1ï¼ŒBéœ€è¦å‘çœ‹é½ï¼ŒæŠŠBå˜ä¸ºï¼ˆ1, 3ï¼‰</li>
<li>æ ¹æ®è§„åˆ™2ï¼Œè¾“å‡ºçš„ç»“æœä¸ºå„ä¸ªè½´ä¸Šçš„æœ€å¤§å€¼ï¼Œå³è¾“å‡ºç»“æœåº”è¯¥ä¸ºï¼ˆ4, 3ï¼‰çŸ©é˜µï¼Œé‚£ä¹ˆAå¦‚ä½•ç”±ï¼ˆ4, 1ï¼‰å˜ä¸ºï¼ˆ4, 3ï¼‰çŸ©é˜µï¼ŸBåˆå¦‚ä½•ç”±ï¼ˆ1, 3ï¼‰å˜ä¸ºï¼ˆ4, 3ï¼‰çŸ©é˜µï¼Ÿ</li>
<li>æ ¹æ®è§„åˆ™4ï¼Œç”¨æ­¤è½´ä¸Šçš„ç¬¬ä¸€ç»„å€¼(è¦ä¸»è¦åŒºåˆ†æ˜¯å“ªä¸ªè½´)ï¼Œè¿›è¡Œå¤åˆ¶(ä½†åœ¨å®é™…å¤„ç†ä¸­ä¸æ˜¯çœŸæ­£å¤åˆ¶ï¼Œå¦åˆ™å¤ªè€—å†…å­˜ï¼Œè€Œæ˜¯é‡‡ç”¨å…¶ä»–å¯¹è±¡å¦‚ogridå¯¹è±¡ï¼Œè¿›è¡Œç½‘æ ¼å¤„ç†)å³å¯ã€‚</li>
</ol>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">A = np.arange(<span class="number">0</span>, <span class="number">40</span>,<span class="number">10</span>).reshape(<span class="number">4</span>, <span class="number">1</span>)</span><br><span class="line">B = np.arange(<span class="number">0</span>, <span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;AçŸ©é˜µçš„å½¢çŠ¶:&#123;&#125;,BçŸ©é˜µçš„å½¢çŠ¶:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(A.shape,B.shape))</span><br><span class="line">C = A+B</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;CçŸ©é˜µçš„å½¢çŠ¶:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(C.shape))</span><br><span class="line"><span class="built_in">print</span>(C)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºç»“æœ</span></span><br><span class="line">AçŸ©é˜µçš„å½¢çŠ¶:(<span class="number">4</span>, <span class="number">1</span>),BçŸ©é˜µçš„å½¢çŠ¶:(<span class="number">3</span>,)</span><br><span class="line">CçŸ©é˜µçš„å½¢çŠ¶:(<span class="number">4</span>, <span class="number">3</span>)</span><br><span class="line">[[ <span class="number">0</span>  <span class="number">1</span>  <span class="number">2</span>]</span><br><span class="line"> [<span class="number">10</span> <span class="number">11</span> <span class="number">12</span>]</span><br><span class="line"> [<span class="number">20</span> <span class="number">21</span> <span class="number">22</span>]</span><br><span class="line"> [<span class="number">30</span> <span class="number">31</span> <span class="number">32</span>]]</span><br></pre></td></tr></table></figure>
<h3 id="pytorchåŸºç¡€-1">ğŸ‘€PyTorchåŸºç¡€</h3>
<p>PyTorchæ˜¯å»ºç«‹åœ¨Torchåº“ä¹‹ä¸Šçš„PythonåŒ…ï¼Œæ—¨åœ¨åŠ é€Ÿæ·±åº¦å­¦ä¹ åº”ç”¨ã€‚å®ƒæä¾›ä¸€ç§ç±»ä¼¼Numpyçš„æŠ½è±¡æ–¹æ³•æ¥è¡¨å¾å¼ é‡(æˆ–å¤šç»´æ•°ç»„)ï¼Œå¯ä»¥åˆ©ç”¨GPUåŠ é€Ÿè®­ç»ƒã€‚PyTorché‡‡ç”¨äº†åŠ¨æ€è®¡ç®—å›¾(Dynamic Computational Graph)ç»“æ„ï¼Œä¸”åŸºäºtapeçš„Autogradç³»ç»Ÿçš„æ·±åº¦ç¥ç»ç½‘ç»œã€‚å¾ˆå¤šæ¡†æ¶ï¼Œæ¯”å¦‚TensorFlow(TensorFlow2.0ä¹ŸåŠ å…¥åŠ¨æ€ç½‘ç»œçš„æ”¯æŒ)ã€Caffeã€CNTKã€Theanoç­‰é‡‡ç”¨é™æ€è®¡ç®—å›¾ã€‚PyTorché€šè¿‡ä¸€ç§ç§°ä¸ºåå‘æ¨¡å¼è‡ªåŠ¨å¾®åˆ†çš„æŠ€æœ¯ï¼Œå¯ä»¥é›¶å»¶è¿Ÿæˆ–é›¶æˆæœ¬åœ°ä»»æ„æ”¹å˜ä½ çš„ç½‘ç»œçš„è¡Œä¸ºã€‚Torchæ˜¯PyTorchä¸­çš„ä¸€ä¸ªé‡è¦åŒ…ï¼Œå®ƒåŒ…å«äº†å¤šç»´å¼ é‡çš„æ•°æ®ç»“æ„ä»¥åŠåŸºäºå…¶ä¸Šçš„å¤šç§æ•°å­¦æ“ä½œã€‚PyTorchç”±4ä¸ªä¸»è¦çš„åŒ…ç»„æˆï¼š</p>
<ul>
<li>torchï¼šç±»ä¼¼Numpyçš„é€šç”¨æ•°ç»„åº“ï¼Œå°†å¼ é‡ç±»å‹è½¬æ¢ä¸ºtorch.cuda.TensorFloatï¼Œå¹¶åœ¨GPUä¸Šè®¡ç®—ã€‚</li>
<li>torch.autogradï¼šç”¨äºæ„å»ºè®¡ç®—å›¾å½¢å¹¶è‡ªåŠ¨è·å–æ¢¯åº¦çš„åŒ…ã€‚</li>
<li>torch.nnï¼šå…·æœ‰å…±äº«å±‚å’ŒæŸå¤±å‡½æ•°çš„ç¥ç»ç½‘ç»œåº“ã€‚</li>
<li>torch.optimï¼šå…·æœ‰é€šç”¨ä¼˜åŒ–ç®—æ³•(å¦‚SGDã€Adamç­‰)çš„ä¼˜åŒ–åŒ…ã€‚</li>
</ul>
<h4 id="tensoræ¦‚è¿°">ğŸ‘Tensoræ¦‚è¿°</h4>
<p>PyTorchçš„Tensorï¼Œå®ƒå¯ä»¥æ˜¯é›¶ç»´(åˆç§°ä¸ºæ ‡é‡æˆ–ä¸€ä¸ªæ•°)ã€ä¸€ç»´ã€äºŒç»´åŠå¤šç»´çš„æ•°ç»„ã€‚Tensorè‡ªç§°ä¸ºç¥ç»ç½‘ç»œç•Œçš„Numpyï¼Œå®ƒä¸Numpyç›¸ä¼¼ï¼ŒäºŒè€…å¯ä»¥å…±äº«å†…å­˜ï¼Œä¸”ä¹‹é—´çš„è½¬æ¢éå¸¸æ–¹ä¾¿é«˜æ•ˆã€‚å®ƒä»¬æœ€å¤§çš„åŒºåˆ«å°±æ˜¯Numpyä¼šæŠŠndarrayæ”¾åœ¨CPUä¸­è¿›è¡ŒåŠ é€Ÿè¿ç®—ï¼Œè€Œç”±Torchäº§ç”Ÿçš„Tensorä¼šæ”¾åœ¨GPUä¸­è¿›è¡ŒåŠ é€Ÿè¿ç®—(å‡è®¾å½“å‰ç¯å¢ƒæœ‰GPU)ã€‚å¯¹Tensorçš„æ“ä½œå¾ˆå¤šï¼Œä»æ¥å£çš„è§’åº¦æ¥åˆ’åˆ†ï¼Œå¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼š</p>
<ul>
<li><p>torch.functionï¼Œå¦‚torch.sumã€torch.addç­‰ï¼›</p></li>
<li><p>tensor.functionï¼Œå¦‚tensor.viewã€tensor.addç­‰ã€‚</p></li>
</ul>
<p>è¿™äº›æ“ä½œå¯¹å¤§éƒ¨åˆ†Tensoréƒ½æ˜¯ç­‰ä»·çš„ï¼Œå¦‚torch.add(x,y)ä¸x.add(y)ç­‰ä»·ã€‚åœ¨å®é™…ä½¿ç”¨æ—¶ï¼Œå¯ä»¥æ ¹æ®ä¸ªäººçˆ±å¥½é€‰æ‹©ã€‚å¦‚æœä»ä¿®æ”¹æ–¹å¼çš„è§’åº¦æ¥åˆ’åˆ†ï¼Œå¯ä»¥åˆ†ä¸ºä»¥ä¸‹ä¸¤ç±»ï¼š</p>
<ul>
<li><p>ä¸ä¿®æ”¹è‡ªèº«æ•°æ®ï¼Œå¦‚x.add(y)ï¼Œxçš„æ•°æ®ä¸å˜ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„Tensorã€‚</p></li>
<li><p>ä¿®æ”¹è‡ªèº«æ•°æ®ï¼Œå¦‚x.add_(y)ï¼ˆè¿è¡Œç¬¦å¸¦ä¸‹åˆ’çº¿åç¼€ï¼‰ï¼Œè¿ç®—ç»“æœå­˜åœ¨xä¸­ï¼Œxè¢«ä¿®æ”¹ã€‚</p></li>
</ul>
<h4 id="åˆ›å»ºtensor">ğŸ‘åˆ›å»ºTensor</h4>
<p>åˆ›å»ºTensorçš„æ–¹æ³•æœ‰å¾ˆå¤šï¼Œå¯ä»¥ä»åˆ—è¡¨æˆ–ndarrayç­‰ç±»å‹è¿›è¡Œæ„å»ºï¼Œä¹Ÿå¯æ ¹æ®æŒ‡å®šçš„å½¢çŠ¶æ„å»ºã€‚å¸¸è§çš„åˆ›å»ºTensorçš„æ–¹æ³•ï¼š</p>
<table>
<thead>
<tr class="header">
<th>å‡½æ•°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Tensor()</td>
<td>ç›´æ¥ä»å‚æ•°æ„é€ ä¸€ä¸ªå¼ é‡ï¼Œæ”¯æŒListã€Numpyæ•°ç»„</td>
</tr>
<tr class="even">
<td>eye(row, column)</td>
<td>åˆ›å»ºæŒ‡å®šè¡Œæ•°ã€åˆ—æ•°çš„äºŒç»´å•ä½Tensor</td>
</tr>
<tr class="odd">
<td>linspace(start, end, steps)</td>
<td>ä»startåˆ°endï¼Œå‡åŒ€åˆ‡åˆ†æˆstepsä»½</td>
</tr>
<tr class="even">
<td>logspace(start, end, steps)</td>
<td>ä»10^startï¼Œåˆ°10^endï¼Œå‡åŒ€åˆ‡åˆ†æˆstepsä»½</td>
</tr>
<tr class="odd">
<td>rand/randn(*size)</td>
<td>ç”Ÿæˆ[0, 1)å‡åŒ€åˆ†å¸ƒ/æ ‡å‡†æ­£æ€åˆ†å¸ƒæ•°æ®</td>
</tr>
<tr class="even">
<td>ones(*size)</td>
<td>è¿”å›æŒ‡å®šshapeçš„å¼ é‡ï¼Œå…ƒç´ åˆå§‹ä¸º1</td>
</tr>
<tr class="odd">
<td>zeros(*size)</td>
<td>è¿”å›æŒ‡å®šshapeçš„å¼ é‡ï¼Œå…ƒç´ åˆå§‹ä¸º0</td>
</tr>
<tr class="even">
<td>ones_like(T)</td>
<td>è¿”å›ä¸Tçš„shapeç›¸åŒçš„å¼ é‡ï¼Œä¸”å…ƒç´ åˆå§‹ä¸º1</td>
</tr>
<tr class="odd">
<td>zeros_like(T)</td>
<td>è¿”å›ä¸Tçš„shapeç›¸åŒçš„å¼ é‡ï¼Œä¸”å…ƒç´ åˆå§‹ä¸º0</td>
</tr>
<tr class="even">
<td>arange(start, end, step)</td>
<td>åœ¨åŒºé—´[start, end)ä¸Šä»¥é—´éš”stepç”Ÿæˆä¸€ä¸ªåºåˆ—å¼ é‡</td>
</tr>
<tr class="odd">
<td>from_Numpy(ndarray)</td>
<td>ä»ndarrayåˆ›å»ºä¸€ä¸ªTensor</td>
</tr>
</tbody>
</table>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ¹æ®listæ•°æ®ç”ŸæˆTensor</span></span><br><span class="line">a = torch.Tensor([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>])</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># æ ¹æ®æŒ‡å®šå½¢çŠ¶ç”ŸæˆTensorï¼Œéšæœºåˆå§‹åŒ–</span></span><br><span class="line">b = torch.Tensor(<span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># æ ¹æ®ç»™å®šçš„Tensorçš„å½¢çŠ¶</span></span><br><span class="line">c = torch.Tensor([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]])</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="comment"># æŸ¥çœ‹Tensorçš„å½¢çŠ¶</span></span><br><span class="line"><span class="built_in">print</span>(c.size())</span><br><span class="line"><span class="comment"># shapeä¸size()ç­‰ä»·æ–¹å¼</span></span><br><span class="line"><span class="built_in">print</span>(c.shape)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># æ ¹æ®å·²æœ‰å½¢çŠ¶åˆ›å»ºTensorï¼Œéšæœºåˆå§‹åŒ–</span></span><br><span class="line">d = torch.Tensor(c.size())</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line"><span class="comment"># ç”Ÿæˆä¸€ä¸ªå•ä½çŸ©é˜µ</span></span><br><span class="line">torch.eye(<span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line"><span class="comment"># è‡ªåŠ¨ç”Ÿæˆå…¨æ˜¯0çš„çŸ©é˜µ</span></span><br><span class="line">torch.zeros(<span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="comment"># æ ¹æ®è§„åˆ™ç”Ÿæˆæ•°æ®</span></span><br><span class="line">torch.linspace(<span class="number">1</span>, <span class="number">10</span>, <span class="number">4</span>)</span><br><span class="line"><span class="comment"># ç”Ÿæˆæ»¡è¶³å‡åŒ€åˆ†å¸ƒéšæœºæ•°</span></span><br><span class="line">torch.rand(<span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="comment"># ç”Ÿæˆæ»¡è¶³æ ‡å‡†åˆ†å¸ƒéšæœºæ•°</span></span><br><span class="line">torch.randn(<span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="comment"># è¿”å›æ‰€ç»™æ•°æ®å½¢çŠ¶ç›¸åŒï¼Œå€¼å…¨ä¸º0çš„å¼ é‡</span></span><br><span class="line">torch.zeros_like(torch.rand(<span class="number">2</span>, <span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºç»“æœ</span></span><br><span class="line">tensor([<span class="number">1.</span>, <span class="number">2.</span>, <span class="number">3.</span>, <span class="number">4.</span>, <span class="number">5.</span>, <span class="number">6.</span>])</span><br><span class="line">********************</span><br><span class="line">tensor([[<span class="number">7.2564e+24</span>, <span class="number">1.7418e-42</span>, <span class="number">0.0000e+00</span>],</span><br><span class="line">        [<span class="number">0.0000e+00</span>, <span class="number">0.0000e+00</span>, <span class="number">0.0000e+00</span>]])</span><br><span class="line">********************</span><br><span class="line">tensor([[<span class="number">1.</span>, <span class="number">2.</span>, <span class="number">3.</span>],</span><br><span class="line">        [<span class="number">4.</span>, <span class="number">5.</span>, <span class="number">6.</span>]])</span><br><span class="line">torch.Size([<span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">torch.Size([<span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">********************</span><br><span class="line">tensor([[<span class="number">7.2567e+24</span>, <span class="number">1.7418e-42</span>, <span class="number">0.0000e+00</span>],</span><br><span class="line">        [<span class="number">0.0000e+00</span>, <span class="number">0.0000e+00</span>, <span class="number">0.0000e+00</span>]])</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æ³¨æ„torch.Tensorä¸torch.tensorçš„å‡ ç‚¹åŒºåˆ«ï¼š</p>
<p>1ï¼‰torch.Tensoræ˜¯torch.emptyå’Œtorch.tensorä¹‹é—´çš„ä¸€ç§æ··åˆï¼Œä½†å½“ä¼ å…¥æ•°æ®æ—¶ï¼Œtorch.Tensorä½¿ç”¨å…¨å±€é»˜è®¤dtype(FloatTensor)ï¼Œè€Œtorch.tensoræ˜¯ä»æ•°æ®ä¸­æ¨æ–­æ•°æ®ç±»å‹ã€‚</p>
<p>2ï¼‰torch.tensor(1)è¿”å›ä¸€ä¸ªå›ºå®šå€¼1ï¼Œè€Œtorch.Tensor(1)è¿”å›ä¸€ä¸ªå¤§å°ä¸º1çš„å¼ é‡ï¼Œå®ƒæ˜¯<strong>éšæœºåˆå§‹åŒ–</strong>çš„å€¼ã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line">t1 = torch.Tensor(<span class="number">3</span>)</span><br><span class="line">t2 = torch.Tensor(<span class="number">1</span>)</span><br><span class="line">t3 = torch.tensor(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;t1çš„å€¼&#123;&#125;,t1çš„æ•°æ®ç±»å‹&#123;&#125;&quot;</span>.<span class="built_in">format</span>(t1, t1.<span class="built_in">type</span>()))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;t2çš„å€¼&#123;&#125;,t2çš„æ•°æ®ç±»å‹&#123;&#125;&quot;</span>.<span class="built_in">format</span>(t2, t2.<span class="built_in">type</span>()))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;t3çš„å€¼&#123;&#125;,t3çš„æ•°æ®ç±»å‹&#123;&#125;&quot;</span>.<span class="built_in">format</span>(t3, t3.<span class="built_in">type</span>()))</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºç»“æœ1</span></span><br><span class="line">t1çš„å€¼tensor([<span class="number">7.0406e+13</span>, <span class="number">1.1561e-42</span>, <span class="number">0.0000e+00</span>]),t1çš„æ•°æ®ç±»å‹torch.FloatTensor</span><br><span class="line">t2çš„å€¼tensor([<span class="number">0.</span>]),t2çš„æ•°æ®ç±»å‹torch.FloatTensor</span><br><span class="line">t3çš„å€¼<span class="number">1</span>,t3çš„æ•°æ®ç±»å‹torch.LongTensor</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºç»“æœ2</span></span><br><span class="line">t1çš„å€¼tensor([<span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>]),t1çš„æ•°æ®ç±»å‹torch.FloatTensor</span><br><span class="line">t2çš„å€¼tensor([<span class="number">3.4713e-18</span>]),t2çš„æ•°æ®ç±»å‹torch.FloatTensor</span><br><span class="line">t3çš„å€¼<span class="number">1</span>,t3çš„æ•°æ®ç±»å‹torch.LongTensor</span><br></pre></td></tr></table></figure>
<h4 id="ä¿®æ”¹tensorå½¢çŠ¶">ğŸ‘ä¿®æ”¹Tensorå½¢çŠ¶</h4>
<p>åœ¨å¤„ç†æ•°æ®ã€æ„å»ºç½‘ç»œå±‚ç­‰è¿‡ç¨‹ä¸­ï¼Œéœ€è¦äº†è§£Tensorçš„å½¢çŠ¶ã€ä¿®æ”¹Tensorçš„å½¢çŠ¶ã€‚ä¸ä¿®æ”¹Numpyçš„å½¢çŠ¶ç±»ä¼¼ï¼Œä¿®æ”¹Tenorçš„å½¢çŠ¶ä¹Ÿæœ‰å¾ˆå¤šç±»ä¼¼å‡½æ•°ï¼š</p>
<table>
<colgroup>
<col style="width: 16%" />
<col style="width: 83%" />
</colgroup>
<thead>
<tr class="header">
<th>å‡½æ•°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>size()</td>
<td>è¿”å›å¼ é‡çš„shapeå±æ€§å€¼ï¼Œä¸å±æ€§shape(0.4ç‰ˆæ–°å¢)ç­‰ä»·</td>
</tr>
<tr class="even">
<td>numel(input)</td>
<td>è®¡ç®—Tensorçš„å…ƒç´ ä¸ªæ•°</td>
</tr>
<tr class="odd">
<td>view(*shape)</td>
<td>ä¿®æ”¹Tensorçš„shapeï¼Œä¸reshape(0.4ç‰ˆæ–°å¢)ç±»ä¼¼ï¼Œä½†viewè¿”å›çš„å¯¹è±¡ä¸æºTensorå…±äº«å†…å­˜ï¼Œä¿®æ”¹ä¸€ä¸ªï¼Œå¦ä¸€ä¸ªåŒæ—¶ä¿®æ”¹ã€‚reshapeå°†ç”Ÿæˆæ–°çš„Tensorï¼Œè€Œä¸”ä¸è¦æ±‚æºTensoræ˜¯è¿ç»­çš„ã€‚view(-1)å±•å¹³æ•°ç»„</td>
</tr>
<tr class="even">
<td>resize</td>
<td>ç±»ä¼¼äºviewï¼Œä½†åœ¨sizeè¶…å‡ºæ—¶ä¼šé‡æ–°åˆ†é…å†…å­˜ç©ºé—´</td>
</tr>
<tr class="odd">
<td>item</td>
<td>è‹¥Tensorä¸º<strong>å•(ä¸€ä¸ª)å…ƒç´ </strong>ï¼Œåˆ™è¿”å›Pythonçš„æ ‡é‡</td>
</tr>
<tr class="even">
<td>unsqueeze</td>
<td>æ‰©å±•ç»´åº¦ï¼Œåœ¨æ’å…¥ç»´åº¦çš„ç´¢å¼•ä½ç½®å¢åŠ ç»´åº¦"1",è¿™é‡Œçš„"1"ä»…ä»…èµ·åˆ°æ‰©å±•ç»´åº¦çš„ä½œç”¨</td>
</tr>
<tr class="odd">
<td>squeeze</td>
<td>é™ä½ç»´åº¦ï¼Œåœ¨å‹ç¼©ç»´åº¦çš„ç´¢å¼•ä½ç½®å‡å°‘ç»´åº¦"1"ï¼Œå³å°†è¾“å…¥å¼ é‡å½¢çŠ¶æŒ‡å®šä½ç½®ä¸­çš„"1"å»é™¤å¹¶è¿”å›</td>
</tr>
</tbody>
</table>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆä¸€ä¸ªå½¢çŠ¶ä¸º2x3çš„çŸ©é˜µ</span></span><br><span class="line">x = torch.randn(<span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="comment"># æŸ¥çœ‹çŸ©é˜µçš„å½¢çŠ¶</span></span><br><span class="line"><span class="built_in">print</span>(x.size())</span><br><span class="line"><span class="comment"># æŸ¥çœ‹xçš„ç»´åº¦</span></span><br><span class="line"><span class="built_in">print</span>(x.dim())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># æŠŠxå˜ä¸º3x2çš„çŸ©é˜µ</span></span><br><span class="line"><span class="built_in">print</span>(x.view(<span class="number">3</span>, <span class="number">2</span>))</span><br><span class="line"><span class="comment"># æŠŠxå±•å¹³ä¸º1ç»´å‘é‡</span></span><br><span class="line">y = x.view(-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(y.shape)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># æ·»åŠ ä¸€ä¸ªç»´åº¦</span></span><br><span class="line">z = torch.unsqueeze(y, <span class="number">0</span>)</span><br><span class="line"><span class="comment"># æŸ¥çœ‹zçš„å½¢çŠ¶</span></span><br><span class="line"><span class="built_in">print</span>(z.size())</span><br><span class="line"><span class="comment"># è®¡ç®—Zçš„å…ƒç´ ä¸ªæ•°</span></span><br><span class="line"><span class="built_in">print</span>(z.numel())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># item()çš„ç”¨æ³•</span></span><br><span class="line">a = torch.tensor([<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(a.item())</span><br><span class="line">b = torch.tensor([<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>])</span><br><span class="line"><span class="built_in">print</span>(b.tolist())</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºç»“æœ</span></span><br><span class="line">torch.Size([<span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line"><span class="number">2</span></span><br><span class="line">********************</span><br><span class="line">tensor([[-<span class="number">0.4888</span>,  <span class="number">1.4943</span>],</span><br><span class="line">        [-<span class="number">1.6593</span>, -<span class="number">0.6757</span>],</span><br><span class="line">        [-<span class="number">1.9228</span>, -<span class="number">1.0863</span>]])</span><br><span class="line">torch.Size([<span class="number">6</span>])</span><br><span class="line">********************</span><br><span class="line">torch.Size([<span class="number">1</span>, <span class="number">6</span>])</span><br><span class="line"><span class="number">6</span></span><br><span class="line">********************</span><br><span class="line"><span class="number">1</span></span><br><span class="line">[<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br></pre></td></tr></table></figure>
<blockquote>
<p>torch.viewä¸torch.reshpaeçš„å¼‚åŒ</p>
<p>1ï¼‰reshape()å¯ç”±torch.reshape()ï¼Œä¹Ÿå¯ç”±torch.Tensor.reshape()è°ƒç”¨ã€‚ä½†view()åªå¯ç”±torch.Tensor.view()æ¥è°ƒç”¨ã€‚</p>
<p>2ï¼‰å¯¹äºä¸€ä¸ªå°†è¦è¢«viewçš„Tensorï¼Œæ–°çš„sizeå¿…é¡»ä¸åŸæ¥çš„sizeä¸strideå…¼å®¹ã€‚å¦åˆ™ï¼Œåœ¨viewä¹‹å‰å¿…é¡»è°ƒç”¨contiguous()æ–¹æ³•ã€‚</p>
<p>3ï¼‰è¿”å›ä¸inputæ•°æ®é‡ç›¸åŒï¼Œä½†å½¢çŠ¶ä¸åŒçš„Tensorã€‚è‹¥æ»¡è¶³viewçš„æ¡ä»¶ï¼Œåˆ™ä¸ä¼šcopyï¼Œè‹¥ä¸æ»¡è¶³ï¼Œåˆ™ä¼šcopyã€‚</p>
<p>4ï¼‰å¦‚æœåªæ˜¯é‡å¡‘å¼ é‡ï¼Œè¯·ä½¿ç”¨torch.reshapeã€‚å¦‚æœè¿˜å…³æ³¨å†…å­˜ä½¿ç”¨æƒ…å†µå¹¶å¸Œæœ›ç¡®ä¿ä¸¤ä¸ªå¼ é‡å…±äº«ç›¸åŒçš„æ•°æ®ï¼Œè¯·ä½¿ç”¨torch.viewã€‚</p>
</blockquote>
<h4 id="ç´¢å¼•æ“ä½œ">ğŸ‘ç´¢å¼•æ“ä½œ</h4>
<p>Tensorçš„ç´¢å¼•æ“ä½œä¸Numpyç±»ä¼¼ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ç´¢å¼•ç»“æœä¸æºæ•°æ®å…±äº«å†…å­˜ã€‚ä»Tensorè·å–å…ƒç´ é™¤äº†å¯ä»¥é€šè¿‡ç´¢å¼•ï¼Œä¹Ÿå¯ä»¥å€ŸåŠ©ä¸€äº›å‡½æ•°ï¼Œå¸¸ç”¨çš„é€‰æ‹©å‡½æ•°å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr class="header">
<th>å‡½æ•°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>index_select(input,, dim, index)</td>
<td>åœ¨æŒ‡å®šç»´åº¦ä¸Šé€‰æ‹©è¡Œå’Œåˆ—</td>
</tr>
<tr class="even">
<td>nonzero(input)</td>
<td>è·å–é0å…ƒç´ çš„ä¸‹æ ‡</td>
</tr>
<tr class="odd">
<td>masked_select(input, mask)</td>
<td>ä½¿ç”¨äºŒå…ƒå€¼è¿›è¡Œé€‰æ‹©</td>
</tr>
<tr class="even">
<td>gather(input, dim, index)</td>
<td>åœ¨æŒ‡å®šç»´åº¦ä¸Šé€‰æ‹©æ•°æ®ï¼Œè¾“å‡ºå½¢çŠ¶ä¸index(ç±»å‹æ˜¯LongTensor)ä¸€è‡´</td>
</tr>
<tr class="odd">
<td>scatter__(dim, index, src)</td>
<td>ä¸ºgatherçš„åæ“ä½œï¼Œæ ¹æ®æŒ‡å®šç´¢å¼•è¡¥å……æ•°æ®</td>
</tr>
</tbody>
</table>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®ä¸€ä¸ªéšæœºç§å­</span></span><br><span class="line">torch.manual_seed(<span class="number">100</span>)</span><br><span class="line"><span class="comment"># ç”Ÿæˆä¸€ä¸ªå½¢çŠ¶ä¸º2x3çš„çŸ©é˜µ</span></span><br><span class="line">x = torch.randn(<span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line"><span class="comment"># æ ¹æ®ç´¢å¼•è·å–ç¬¬1è¡Œï¼Œæ‰€æœ‰æ•°æ®</span></span><br><span class="line"><span class="built_in">print</span>(x[<span class="number">0</span>, :])</span><br><span class="line"><span class="comment"># è·å–æœ€åä¸€åˆ—æ•°æ®</span></span><br><span class="line"><span class="built_in">print</span>(x[:, -<span class="number">1</span>])</span><br><span class="line"><span class="comment"># ç”Ÿæˆæ˜¯å¦å¤§äº0çš„Byterå¼ é‡</span></span><br><span class="line">mask = x &gt; <span class="number">0</span></span><br><span class="line"><span class="built_in">print</span>(mask)</span><br><span class="line"><span class="comment"># è·å–å¤§äº0çš„å€¼</span></span><br><span class="line"><span class="built_in">print</span>(torch.masked_select(x, mask))</span><br><span class="line"><span class="comment"># è·å–é0ä¸‹æ ‡,å³è¡Œï¼Œåˆ—ç´¢å¼•</span></span><br><span class="line"><span class="built_in">print</span>(torch.nonzero(mask))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># è·å–æŒ‡å®šç´¢å¼•å¯¹åº”çš„å€¼</span></span><br><span class="line">index1 = torch.LongTensor([[<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>]])</span><br><span class="line"><span class="built_in">print</span>(torch.gather(x, <span class="number">0</span>, index1))</span><br><span class="line">index2 = torch.LongTensor([[<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>], [<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>]])</span><br><span class="line">a = torch.gather(x, <span class="number">1</span>, index2)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="comment"># æŠŠaçš„å€¼è¿”å›åˆ°ä¸€ä¸ª2x3çš„0çŸ©é˜µä¸­</span></span><br><span class="line">z = torch.zeros(<span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">z.scatter_(<span class="number">1</span>, index2, a)</span><br><span class="line"><span class="built_in">print</span>(z)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºç»“æœ</span></span><br><span class="line">tensor([[ <span class="number">0.3607</span>, -<span class="number">0.2859</span>, -<span class="number">0.3938</span>],</span><br><span class="line">        [ <span class="number">0.2429</span>, -<span class="number">1.3833</span>, -<span class="number">2.3134</span>]])</span><br><span class="line">tensor([ <span class="number">0.3607</span>, -<span class="number">0.2859</span>, -<span class="number">0.3938</span>])</span><br><span class="line">tensor([-<span class="number">0.3938</span>, -<span class="number">2.3134</span>])</span><br><span class="line">tensor([[ <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>],</span><br><span class="line">        [ <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>]])</span><br><span class="line">tensor([<span class="number">0.3607</span>, <span class="number">0.2429</span>])</span><br><span class="line">tensor([[<span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">1</span>, <span class="number">0</span>]])</span><br><span class="line">********************</span><br><span class="line">tensor([[ <span class="number">0.3607</span>, -<span class="number">1.3833</span>, -<span class="number">2.3134</span>]])</span><br><span class="line">tensor([[ <span class="number">0.3607</span>, -<span class="number">0.2859</span>, -<span class="number">0.2859</span>],</span><br><span class="line">        [-<span class="number">1.3833</span>, -<span class="number">1.3833</span>, -<span class="number">1.3833</span>]])</span><br><span class="line">tensor([[ <span class="number">0.3607</span>, -<span class="number">0.2859</span>,  <span class="number">0.0000</span>],</span><br><span class="line">        [ <span class="number">0.0000</span>, -<span class="number">1.3833</span>,  <span class="number">0.0000</span>]])</span><br></pre></td></tr></table></figure>
<h4 id="å¹¿æ’­æœºåˆ¶-1">ğŸ‘å¹¿æ’­æœºåˆ¶</h4>
<p>PyTorchä¹Ÿæ”¯æŒå¹¿æ’­æœºåˆ¶ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">A = np.arange(<span class="number">0</span>, <span class="number">40</span>, <span class="number">10</span>).reshape(<span class="number">4</span>, <span class="number">1</span>)</span><br><span class="line">B = np.arange(<span class="number">0</span>, <span class="number">3</span>)</span><br><span class="line"><span class="comment"># æŠŠndarrayè½¬æ¢ä¸ºTensor</span></span><br><span class="line">A1 = torch.from_numpy(A)  <span class="comment"># å½¢çŠ¶ä¸º4x1</span></span><br><span class="line">B1 = torch.from_numpy(B)  <span class="comment"># å½¢çŠ¶ä¸º3</span></span><br><span class="line"><span class="comment"># Tensorè‡ªåŠ¨å®ç°å¹¿æ’­</span></span><br><span class="line">C = A1 + B1</span><br><span class="line"><span class="built_in">print</span>(C)</span><br><span class="line"><span class="comment"># æˆ‘ä»¬å¯ä»¥æ ¹æ®å¹¿æ’­æœºåˆ¶ï¼Œæ‰‹å·¥è¿›è¡Œé…ç½®</span></span><br><span class="line"><span class="comment"># æ ¹æ®è§„åˆ™1ï¼ŒB1éœ€è¦å‘A1çœ‹é½ï¼ŒæŠŠBå˜ä¸ºï¼ˆ1,3ï¼‰</span></span><br><span class="line">B2 = B1.unsqueeze(<span class="number">0</span>)  <span class="comment"># B2çš„å½¢çŠ¶ä¸º1x3</span></span><br><span class="line"><span class="comment"># ä½¿ç”¨expandå‡½æ•°é‡å¤æ•°ç»„ï¼Œåˆ†åˆ«çš„4x3çš„çŸ©é˜µ</span></span><br><span class="line">A2 = A1.expand(<span class="number">4</span>, <span class="number">3</span>)</span><br><span class="line">B3 = B2.expand(<span class="number">4</span>, <span class="number">3</span>)</span><br><span class="line"><span class="comment"># ç„¶åè¿›è¡Œç›¸åŠ ,C1ä¸Cç»“æœä¸€è‡´</span></span><br><span class="line">C1 = A2 + B3</span><br><span class="line"><span class="built_in">print</span>(C1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºç»“æœ</span></span><br><span class="line">tensor([[ <span class="number">0</span>,  <span class="number">1</span>,  <span class="number">2</span>],</span><br><span class="line">        [<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>],</span><br><span class="line">        [<span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>],</span><br><span class="line">        [<span class="number">30</span>, <span class="number">31</span>, <span class="number">32</span>]], dtype=torch.int32)</span><br><span class="line">tensor([[ <span class="number">0</span>,  <span class="number">1</span>,  <span class="number">2</span>],</span><br><span class="line">        [<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>],</span><br><span class="line">        [<span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>],</span><br><span class="line">        [<span class="number">30</span>, <span class="number">31</span>, <span class="number">32</span>]], dtype=torch.int32)</span><br></pre></td></tr></table></figure>
<h4 id="é€å…ƒç´ æ“ä½œ">ğŸ‘é€å…ƒç´ æ“ä½œ</h4>
<p>ä¸Numpyä¸€æ ·ï¼ŒTensorä¹Ÿæœ‰é€å…ƒç´ æ“ä½œ(Element-Wise)ï¼Œä¸”æ“ä½œå†…å®¹ç›¸ä¼¼ï¼Œä½†ä½¿ç”¨å‡½æ•°å¯èƒ½ä¸å°½ç›¸åŒã€‚å¤§éƒ¨åˆ†æ•°å­¦è¿ç®—éƒ½å±äºé€å…ƒç´ æ“ä½œï¼Œå…¶è¾“å…¥ä¸è¾“å‡ºçš„å½¢çŠ¶ç›¸åŒã€‚è¿™äº›æ“ä½œå‡ä¼šåˆ›å»ºæ–°çš„Tensorï¼Œå¦‚æœéœ€è¦å°±åœ°æ“ä½œï¼Œå¯ä»¥ä½¿ç”¨è¿™äº›æ–¹æ³•çš„ä¸‹åˆ’çº¿ç‰ˆæœ¬ï¼Œä¾‹å¦‚abs_ã€‚å¸¸è§çš„å‡½æ•°å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr class="header">
<th>å‡½æ•°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>abs/add</td>
<td>ç»å¯¹å€¼/åŠ æ³•</td>
</tr>
<tr class="even">
<td>addcdiv(t, v, t1, t2)</td>
<td>t1ä¸t2çš„æŒ‰å…ƒç´ é™¤åï¼Œä¹˜våŠ tï¼›ï¼ˆå¯èƒ½å¼¹å‡º"UserWarning"ï¼‰</td>
</tr>
<tr class="odd">
<td>addcmul(t, v, t1, t2)</td>
<td>t1ä¸t2çš„æŒ‰å…ƒç´ ä¹˜åï¼Œä¹˜våŠ tï¼›ï¼ˆå¯èƒ½å¼¹å‡º"UserWarning"ï¼‰</td>
</tr>
<tr class="even">
<td>ceil/floor</td>
<td>å‘ä¸Šå–æ•´/å‘ä¸‹å–æ•´</td>
</tr>
<tr class="odd">
<td>clamp(t, min, max)</td>
<td>å°†å¼ é‡å…ƒç´ é™åˆ¶åœ¨æŒ‡å®šåŒºé—´</td>
</tr>
<tr class="even">
<td>exp/log/pow</td>
<td>æŒ‡æ•°/å¯¹æ•°/å¹‚</td>
</tr>
<tr class="odd">
<td>mul(æˆ–*)/neg</td>
<td>é€å…ƒç´ ä¹˜æ³•/å–å</td>
</tr>
<tr class="even">
<td>sigmoid/tanh/softmax</td>
<td>æ¿€æ´»å‡½æ•°</td>
</tr>
<tr class="odd">
<td>sign/sqrt</td>
<td>å–è¾“å…¥å¼ é‡å…ƒç´ çš„ç¬¦å·/å¼€æ ¹å·</td>
</tr>
</tbody>
</table>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"></span><br><span class="line">t = torch.randn(<span class="number">1</span>, <span class="number">3</span>)</span><br><span class="line">t1 = torch.randn(<span class="number">3</span>, <span class="number">1</span>)</span><br><span class="line">t2 = torch.randn(<span class="number">1</span>, <span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(t)</span><br><span class="line"><span class="built_in">print</span>(t1)</span><br><span class="line"><span class="built_in">print</span>(t2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="built_in">print</span>(torch.addcdiv(t, <span class="number">0.1</span>, t1, t2))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># è®¡ç®—sigmoid</span></span><br><span class="line"><span class="built_in">print</span>(torch.sigmoid(t))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># å°†té™åˆ¶åœ¨[0,1]ä¹‹é—´</span></span><br><span class="line"><span class="built_in">print</span>(torch.clamp(t, <span class="number">0</span>, <span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># t+2è¿›è¡Œå°±åœ°è¿ç®—</span></span><br><span class="line">t.add_(<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(t)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºç»“æœ</span></span><br><span class="line">tensor([[ <span class="number">2.4080</span>,  <span class="number">0.6269</span>, -<span class="number">0.0157</span>]])</span><br><span class="line">tensor([[-<span class="number">0.3307</span>],</span><br><span class="line">        [-<span class="number">0.6533</span>],</span><br><span class="line">        [ <span class="number">0.7257</span>]])</span><br><span class="line">tensor([[ <span class="number">0.6907</span>, -<span class="number">0.8531</span>, -<span class="number">0.8397</span>]])</span><br><span class="line">********************</span><br><span class="line">tensor([[ <span class="number">2.3601</span>,  <span class="number">0.6656</span>,  <span class="number">0.0237</span>],</span><br><span class="line">        [ <span class="number">2.3134</span>,  <span class="number">0.7035</span>,  <span class="number">0.0621</span>],</span><br><span class="line">        [ <span class="number">2.5131</span>,  <span class="number">0.5418</span>, -<span class="number">0.1021</span>]])</span><br><span class="line">********************</span><br><span class="line">tensor([[<span class="number">0.9174</span>, <span class="number">0.6518</span>, <span class="number">0.4961</span>]])</span><br><span class="line">********************</span><br><span class="line">tensor([[<span class="number">1.0000</span>, <span class="number">0.6269</span>, <span class="number">0.0000</span>]])</span><br><span class="line">********************</span><br><span class="line">tensor([[<span class="number">4.4080</span>, <span class="number">2.6269</span>, <span class="number">1.9843</span>]])</span><br></pre></td></tr></table></figure>
<h4 id="å½’å¹¶æ“ä½œ">ğŸ‘å½’å¹¶æ“ä½œ</h4>
<p>å½’å¹¶æ“ä½œï¼Œå°±æ˜¯å¯¹è¾“å…¥è¿›è¡Œå½’å¹¶æˆ–åˆè®¡ç­‰æ“ä½œï¼Œè¿™ç±»æ“ä½œçš„è¾“å…¥è¾“å‡ºå½¢çŠ¶ä¸€èˆ¬å¹¶ä¸ç›¸åŒï¼Œè€Œä¸”å¾€å¾€æ˜¯è¾“å…¥å¤§äºè¾“å‡ºå½¢çŠ¶ã€‚å½’å¹¶æ“ä½œå¯ä»¥å¯¹æ•´ä¸ªTensorï¼Œä¹Ÿå¯ä»¥æ²¿ç€æŸä¸ªç»´åº¦è¿›è¡Œå½’å¹¶ã€‚å¸¸è§çš„å‡½æ•°å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr class="header">
<th>å‡½æ•°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>cumprod(t, axis)</td>
<td>åœ¨æŒ‡å®šç»´åº¦å¯¹tè¿›è¡Œç´¯ç§¯</td>
</tr>
<tr class="even">
<td>cumsum</td>
<td>åœ¨æŒ‡å®šç»´åº¦å¯¹tè¿›è¡Œç´¯åŠ </td>
</tr>
<tr class="odd">
<td>dist(a, b, p=2)</td>
<td>è¿”å›a, bä¹‹é—´çš„pé˜¶èŒƒæ•°</td>
</tr>
<tr class="even">
<td>mean/median</td>
<td>å‡å€¼/ä¸­ä½æ•°</td>
</tr>
<tr class="odd">
<td>std/var</td>
<td>æ ‡å‡†å·®/æ–¹å·®</td>
</tr>
<tr class="even">
<td>norm(t, p=2)</td>
<td>è¿”å›tçš„pé˜¶èŒƒæ•°</td>
</tr>
<tr class="odd">
<td>prod(t)/sum(t)</td>
<td>è¿”å›tæ‰€æœ‰å…ƒç´ çš„ç§¯/å’Œ</td>
</tr>
</tbody>
</table>
<blockquote>
<p>å½’å¹¶æ“ä½œä¸€èˆ¬æ¶‰åŠä¸€ä¸ªdimå‚æ•°ï¼ŒæŒ‡å®šæ²¿å“ªä¸ªç»´è¿›è¡Œå½’å¹¶ã€‚å¦ä¸€ä¸ªå‚æ•°æ˜¯keepdimï¼Œè¯´æ˜è¾“å‡ºç»“æœä¸­æ˜¯å¦ä¿ç•™ç»´åº¦1ï¼Œç¼ºçœæƒ…å†µæ˜¯Falseï¼Œå³ä¸ä¿ç•™ã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆä¸€ä¸ªå«6ä¸ªæ•°çš„å‘é‡</span></span><br><span class="line">a = torch.linspace(<span class="number">0</span>, <span class="number">10</span>, <span class="number">6</span>)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># ä½¿ç”¨viewæ–¹æ³•ï¼ŒæŠŠaå˜ä¸º2x3çŸ©é˜µ</span></span><br><span class="line">a = a.view((<span class="number">2</span>, <span class="number">3</span>))</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># æ²¿yè½´æ–¹å‘ç´¯åŠ ï¼Œå³dim=0</span></span><br><span class="line">b = a.<span class="built_in">sum</span>(dim=<span class="number">0</span>)  <span class="comment"># bçš„å½¢çŠ¶ä¸º[3]</span></span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"><span class="built_in">print</span>(b.shape)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># æ²¿yè½´æ–¹å‘ç´¯åŠ ï¼Œå³dim=0,å¹¶ä¿ç•™å«1çš„ç»´åº¦</span></span><br><span class="line">b = a.<span class="built_in">sum</span>(dim=<span class="number">0</span>, keepdim=<span class="literal">True</span>)  <span class="comment"># bçš„å½¢çŠ¶ä¸º[1,3]</span></span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"><span class="built_in">print</span>(b.shape)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºç»“æœ</span></span><br><span class="line">tensor([ <span class="number">0.</span>,  <span class="number">2.</span>,  <span class="number">4.</span>,  <span class="number">6.</span>,  <span class="number">8.</span>, <span class="number">10.</span>])</span><br><span class="line">********************</span><br><span class="line">tensor([[ <span class="number">0.</span>,  <span class="number">2.</span>,  <span class="number">4.</span>],</span><br><span class="line">        [ <span class="number">6.</span>,  <span class="number">8.</span>, <span class="number">10.</span>]])</span><br><span class="line">********************</span><br><span class="line">tensor([ <span class="number">6.</span>, <span class="number">10.</span>, <span class="number">14.</span>])</span><br><span class="line">torch.Size([<span class="number">3</span>])</span><br><span class="line">********************</span><br><span class="line">tensor([[ <span class="number">6.</span>, <span class="number">10.</span>, <span class="number">14.</span>]])</span><br><span class="line">torch.Size([<span class="number">1</span>, <span class="number">3</span>])</span><br></pre></td></tr></table></figure>
<h4 id="æ¯”è¾ƒæ“ä½œ">ğŸ‘æ¯”è¾ƒæ“ä½œ</h4>
<p>æ¯”è¾ƒæ“ä½œä¸€èˆ¬æ˜¯è¿›è¡Œé€å…ƒç´ æ¯”è¾ƒï¼Œæœ‰äº›æ˜¯æŒ‰æŒ‡å®šæ–¹å‘æ¯”è¾ƒã€‚å¸¸è§çš„å‡½æ•°å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr class="header">
<th>å‡½æ•°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>eq</td>
<td>æ¯”è¾ƒTensoræ˜¯å¦ç›¸ç­‰(<strong>é€å…ƒç´ æ¯”è¾ƒ</strong>)ï¼Œæ”¯æŒbroadcast</td>
</tr>
<tr class="even">
<td>equal</td>
<td>æ¯”è¾ƒTensoræ˜¯å¦æœ‰ç›¸åŒçš„shapeä¸å€¼(<strong>å¼ é‡æ¯”è¾ƒ</strong>)</td>
</tr>
<tr class="odd">
<td>ge/le/gt/lt</td>
<td>å¤§äºç­‰äº/å°äºç­‰äº/å¤§äº/å°äº</td>
</tr>
<tr class="even">
<td>max/min(t, axis)</td>
<td>è¿”å›æœ€å€¼ï¼Œè‹¥æŒ‡å®šaxisï¼Œåˆ™é¢å¤–è¿”å›ä¸‹æ ‡</td>
</tr>
<tr class="odd">
<td>topk(t, k, axis)</td>
<td>åœ¨æŒ‡å®šçš„axisç»´ä¸Šå–æœ€é«˜çš„Kä¸ªå€¼</td>
</tr>
</tbody>
</table>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"></span><br><span class="line">x = torch.linspace(<span class="number">0</span>, <span class="number">10</span>, <span class="number">6</span>).view(<span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># æ±‚æ‰€æœ‰å…ƒç´ çš„æœ€å¤§å€¼</span></span><br><span class="line"><span class="built_in">print</span>(torch.<span class="built_in">max</span>(x))  <span class="comment"># ç»“æœä¸º10</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># æ±‚yè½´æ–¹å‘çš„æœ€å¤§å€¼</span></span><br><span class="line"><span class="built_in">print</span>(torch.<span class="built_in">max</span>(x, dim=<span class="number">0</span>))  <span class="comment"># ç»“æœä¸º[6, 8, 10]</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># æ±‚æœ€å¤§çš„2ä¸ªå…ƒç´ </span></span><br><span class="line"><span class="comment"># ç»“æœä¸º[6, 8, 10],å¯¹åº”ç´¢å¼•ä¸ºtensor([[1, 1, 1]</span></span><br><span class="line"><span class="built_in">print</span>(torch.topk(x, <span class="number">1</span>, dim=<span class="number">0</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºç»“æœ</span></span><br><span class="line">tensor([[ <span class="number">0.</span>,  <span class="number">2.</span>,  <span class="number">4.</span>],</span><br><span class="line">        [ <span class="number">6.</span>,  <span class="number">8.</span>, <span class="number">10.</span>]])</span><br><span class="line">********************</span><br><span class="line">tensor(<span class="number">10.</span>)</span><br><span class="line">********************</span><br><span class="line">torch.return_types.<span class="built_in">max</span>(</span><br><span class="line">values=tensor([ <span class="number">6.</span>,  <span class="number">8.</span>, <span class="number">10.</span>]),</span><br><span class="line">indices=tensor([<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>]))</span><br><span class="line">********************</span><br><span class="line">torch.return_types.topk(</span><br><span class="line">values=tensor([[ <span class="number">6.</span>,  <span class="number">8.</span>, <span class="number">10.</span>]]),</span><br><span class="line">indices=tensor([[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>]]))</span><br></pre></td></tr></table></figure>
<h4 id="çŸ©é˜µæ“ä½œ">ğŸ‘çŸ©é˜µæ“ä½œ</h4>
<p>æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ ä¸­å­˜åœ¨å¤§é‡çš„çŸ©é˜µè¿ç®—ï¼Œå¸¸ç”¨çš„ç®—æ³•æœ‰ä¸¤ç§ï¼šä¸€ç§æ˜¯é€å…ƒç´ ä¹˜æ³•ï¼Œå¦å¤–ä¸€ç§æ˜¯ç‚¹ç§¯ä¹˜æ³•ã€‚å¸¸è§çš„å‡½æ•°å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr class="header">
<th>å‡½æ•°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>dot(t1, t2)</td>
<td>è®¡ç®—å¼ é‡ï¼ˆ1Dï¼‰çš„å†…ç§¯æˆ–ç‚¹ç§¯</td>
</tr>
<tr class="even">
<td>mm(mat1, mat2)/bmm(batch1, batch2)</td>
<td>è®¡ç®—çŸ©é˜µä¹˜æ³•/å«batchçš„3DçŸ©é˜µä¹˜æ³•</td>
</tr>
<tr class="odd">
<td>mv(t1, v1)</td>
<td>è®¡ç®—çŸ©é˜µä¸å‘é‡ä¹˜æ³•</td>
</tr>
<tr class="even">
<td>t</td>
<td>è½¬ç½®</td>
</tr>
<tr class="odd">
<td>svd(t)</td>
<td>è®¡ç®—tçš„SVDåˆ†è§£</td>
</tr>
</tbody>
</table>
<blockquote>
<ul>
<li><p>Torchçš„dotä¸Numpyçš„dotæœ‰ç‚¹ä¸åŒï¼ŒTorchä¸­çš„dotæ˜¯å¯¹ä¸¤ä¸ªä¸º1Då¼ é‡è¿›è¡Œç‚¹ç§¯è¿ç®—ï¼ŒNumpyä¸­çš„dotæ— æ­¤é™åˆ¶ã€‚</p></li>
<li><p>mmæ˜¯å¯¹2Dçš„çŸ©é˜µè¿›è¡Œç‚¹ç§¯ï¼Œbmmå¯¹å«batchçš„3Dè¿›è¡Œç‚¹ç§¯è¿ç®—ã€‚</p></li>
<li><p>è½¬ç½®è¿ç®—ä¼šå¯¼è‡´å­˜å‚¨ç©ºé—´ä¸è¿ç»­ï¼Œéœ€è¦è°ƒç”¨contiguousæ–¹æ³•è½¬ä¸ºè¿ç»­ã€‚</p></li>
</ul>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"></span><br><span class="line">a = torch.tensor([<span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">b = torch.tensor([<span class="number">3</span>, <span class="number">4</span>])</span><br><span class="line"><span class="built_in">print</span>(torch.dot(a, b))    <span class="comment"># è¿è¡Œç»“æœä¸º18</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line">x = torch.randint(<span class="number">10</span>, (<span class="number">2</span>, <span class="number">3</span>))</span><br><span class="line">y = torch.randint(<span class="number">6</span>, (<span class="number">3</span>, <span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span>(torch.mm(x, y))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line">x = torch.randint(<span class="number">10</span>, (<span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>))</span><br><span class="line">y = torch.randint(<span class="number">6</span>, (<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span>(torch.bmm(x, y))</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºç»“æœ</span></span><br><span class="line">tensor(<span class="number">18</span>)</span><br><span class="line">********************</span><br><span class="line">tensor([[<span class="number">47</span>, <span class="number">20</span>, <span class="number">20</span>, <span class="number">39</span>],</span><br><span class="line">        [<span class="number">55</span>, <span class="number">22</span>, <span class="number">35</span>, <span class="number">27</span>]])</span><br><span class="line">********************</span><br><span class="line">tensor([[[ <span class="number">57</span>,  <span class="number">45</span>,  <span class="number">40</span>,  <span class="number">60</span>],</span><br><span class="line">         [ <span class="number">47</span>,  <span class="number">10</span>,  <span class="number">24</span>,  <span class="number">43</span>]],</span><br><span class="line"></span><br><span class="line">        [[ <span class="number">54</span>, <span class="number">106</span>,  <span class="number">36</span>, <span class="number">104</span>],</span><br><span class="line">         [ <span class="number">34</span>,  <span class="number">42</span>,   <span class="number">4</span>,  <span class="number">50</span>]]])</span><br></pre></td></tr></table></figure>
<h4 id="pytorchä¸numpyæ¯”è¾ƒ">ğŸ‘PyTorchä¸Numpyæ¯”è¾ƒ</h4>
<p>PyTorchä¸Numpyæœ‰å¾ˆå¤šç±»ä¼¼çš„åœ°æ–¹ï¼Œå¹¶ä¸”æœ‰å¾ˆå¤šç›¸åŒçš„æ“ä½œå‡½æ•°åç§°ï¼Œæˆ–è™½ç„¶å‡½æ•°åç§°ä¸åŒä½†å«ä¹‰ç›¸åŒï¼›å½“ç„¶ä¹Ÿæœ‰ä¸€äº›è™½ç„¶å‡½æ•°åç§°ç›¸åŒï¼Œä½†å«ä¹‰ä¸å°½ç›¸åŒã€‚</p>
<table>
<colgroup>
<col style="width: 12%" />
<col style="width: 40%" />
<col style="width: 47%" />
</colgroup>
<thead>
<tr class="header">
<th>æ“ä½œç±»åˆ«</th>
<th>Numpy</th>
<th>PyTorch</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>æ•°æ®ç±»å‹</td>
<td>np.ndarray</td>
<td>torch.Tensor</td>
</tr>
<tr class="even">
<td></td>
<td>np.float32</td>
<td>torch.float32; torch.float</td>
</tr>
<tr class="odd">
<td></td>
<td>np.float64</td>
<td>torch.float64; torch.double</td>
</tr>
<tr class="even">
<td></td>
<td>np.int64</td>
<td>torch.int64; torch.long</td>
</tr>
<tr class="odd">
<td>å·²æœ‰æ•°æ®æ„å»º</td>
<td>np.array([1.3, 1.4], dtype=np.float32)</td>
<td>torch.tensor([1.3, 1.4], dtype=torch.float32)</td>
</tr>
<tr class="even">
<td></td>
<td>x.copy()</td>
<td>x.clone()</td>
</tr>
<tr class="odd">
<td></td>
<td>np.concatenate</td>
<td>torch.cat</td>
</tr>
<tr class="even">
<td>çº¿æ€§ä»£æ•°</td>
<td>np.dot</td>
<td>torch.mm</td>
</tr>
<tr class="odd">
<td>å±æ€§</td>
<td>x.ndim</td>
<td>x.dim()</td>
</tr>
<tr class="even">
<td></td>
<td>x.size</td>
<td>x.nelement()</td>
</tr>
<tr class="odd">
<td>å½¢çŠ¶æ“ä½œ</td>
<td>x.reshape</td>
<td>x.reshape; x.view</td>
</tr>
<tr class="even">
<td></td>
<td>x.flatten</td>
<td>x.view(-1)</td>
</tr>
<tr class="odd">
<td>ç±»å‹è½¬æ¢</td>
<td>np.floor(x)</td>
<td>torch.floor(x); x.floor()</td>
</tr>
<tr class="even">
<td>æ¯”è¾ƒ</td>
<td>np.less</td>
<td>x.lt</td>
</tr>
<tr class="odd">
<td></td>
<td>np.less_equal/np.greater</td>
<td>x.le/x.gt</td>
</tr>
<tr class="even">
<td></td>
<td>np.greater_equal/np.equal/np.not_equal</td>
<td>x.ge/x.eq/x.ne</td>
</tr>
<tr class="odd">
<td>éšæœºç§å­</td>
<td>np.random.seed</td>
<td>torch.manual.seed</td>
</tr>
</tbody>
</table>
<h3 id="tensorä¸autograd">ğŸ‘€Tensorä¸Autograd</h3>
<blockquote>
<p>ç¥ç»ç½‘ç»œä¸€ä¸ªé‡è¦å†…å®¹å°±æ˜¯è¿›è¡Œå‚æ•°å­¦ä¹ ï¼Œè€Œå‚æ•°å­¦ä¹ ç¦»ä¸å¼€æ±‚å¯¼ï¼Œé‚£ä¹ˆPyTorchæ˜¯å¦‚ä½•è¿›è¡Œæ±‚å¯¼çš„å‘¢ï¼Ÿ</p>
</blockquote>
<p>ç°åœ¨å¤§éƒ¨åˆ†æ·±åº¦å­¦ä¹ æ¶æ„éƒ½æœ‰è‡ªåŠ¨æ±‚å¯¼çš„åŠŸèƒ½ï¼ŒPyTorchä¹Ÿä¸ä¾‹å¤–ï¼Œtorch.autogradåŒ…å°±æ˜¯ç”¨æ¥è‡ªåŠ¨æ±‚å¯¼çš„ã€‚AutogradåŒ…ä¸ºå¼ é‡ä¸Šæ‰€æœ‰çš„æ“ä½œæä¾›äº†è‡ªåŠ¨æ±‚å¯¼åŠŸèƒ½ï¼Œè€Œtorch.Tensorå’Œtorch.Functionä¸ºAutogradçš„ä¸¤ä¸ªæ ¸å¿ƒç±»ï¼Œå®ƒä»¬ç›¸äº’è¿æ¥å¹¶ç”Ÿæˆä¸€ä¸ªæœ‰å‘éå¾ªç¯å›¾ã€‚ä¸ºå®ç°å¯¹Tensorè‡ªåŠ¨æ±‚å¯¼ï¼Œéœ€è€ƒè™‘å¦‚ä¸‹äº‹é¡¹ï¼š</p>
<ul>
<li><p>åˆ›å»ºå¶å­èŠ‚ç‚¹(Leaf Node)çš„Tensorï¼Œä½¿ç”¨requires_gradå‚æ•°æŒ‡å®šæ˜¯å¦è®°å½•å¯¹å…¶çš„æ“ä½œï¼Œä»¥ä¾¿ä¹‹ååˆ©ç”¨backward()æ–¹æ³•è¿›è¡Œæ¢¯åº¦æ±‚è§£ã€‚requires_gradå‚æ•°çš„ç¼ºçœå€¼ä¸ºFalseï¼Œå¦‚æœè¦å¯¹å…¶æ±‚å¯¼éœ€è®¾ç½®ä¸ºTrueï¼Œç„¶åä¸ä¹‹æœ‰ä¾èµ–å…³ç³»çš„èŠ‚ç‚¹ä¼šè‡ªåŠ¨å˜ä¸ºTrueã€‚</p></li>
<li><p>å¯åˆ©ç”¨requires_grad_()æ–¹æ³•ä¿®æ”¹Tensorçš„requires_gradå±æ€§ã€‚å¯ä»¥è°ƒç”¨.detach()æˆ–with torch.no_grad()ï¼Œå°†ä¸å†è®¡ç®—å¼ é‡çš„æ¢¯åº¦ï¼Œè·Ÿè¸ªå¼ é‡çš„å†å²è®°å½•ã€‚è¿™ç‚¹åœ¨è¯„ä¼°æ¨¡å‹ã€æµ‹è¯•æ¨¡å‹é˜¶æ®µä¸­å¸¸å¸¸ç”¨åˆ°ã€‚</p></li>
<li><p>é€šè¿‡è¿ç®—åˆ›å»ºçš„Tensorï¼ˆå³éå¶å­èŠ‚ç‚¹ï¼‰ï¼Œä¼šè‡ªåŠ¨è¢«èµ‹äºˆgrad_fnå±æ€§ï¼Œè¯¥å±æ€§è¡¨ç¤ºæ¢¯åº¦å‡½æ•°ã€‚å¶å­èŠ‚ç‚¹çš„grad_fnä¸ºNoneã€‚</p></li>
<li><p>æœ€åå¾—åˆ°çš„Tensoræ‰§è¡Œbackward()å‡½æ•°ï¼Œæ­¤æ—¶è‡ªåŠ¨è®¡ç®—å„å˜é‡çš„æ¢¯åº¦ï¼Œå¹¶å°†ç´¯åŠ ç»“æœä¿å­˜åˆ°gradå±æ€§ä¸­ã€‚è®¡ç®—å®Œæˆåï¼Œéå¶å­èŠ‚ç‚¹çš„æ¢¯åº¦è‡ªåŠ¨é‡Šæ”¾ã€‚</p></li>
<li><p>backward()å‡½æ•°æ¥æ”¶å‚æ•°ï¼Œè¯¥å‚æ•°åº”å’Œè°ƒç”¨backward()å‡½æ•°çš„Tensorçš„ç»´åº¦ç›¸åŒï¼Œæˆ–è€…æ˜¯å¯broadcastçš„ç»´åº¦ã€‚å¦‚æœæ±‚å¯¼çš„Tensorä¸ºæ ‡é‡ï¼ˆå³ä¸€ä¸ªæ•°å­—ï¼‰ï¼Œåˆ™backwardä¸­çš„å‚æ•°å¯çœç•¥ã€‚</p></li>
<li><p>åå‘ä¼ æ’­çš„ä¸­é—´ç¼“å­˜ä¼šè¢«æ¸…ç©ºï¼Œå¦‚æœéœ€è¿›è¡Œå¤šæ¬¡åå‘ä¼ æ’­ï¼Œéœ€æŒ‡å®šbackwardä¸­çš„å‚æ•°retain_graph=Trueã€‚å¤šæ¬¡åå‘ä¼ æ’­æ—¶ï¼Œæ¢¯åº¦æ˜¯ç´¯åŠ çš„ã€‚</p></li>
<li><p>éå¶å­èŠ‚ç‚¹çš„æ¢¯åº¦backwardè°ƒç”¨åå³è¢«æ¸…ç©ºã€‚</p></li>
<li><p>å¯ä»¥é€šè¿‡ç”¨torch.no_grad()åŒ…è£¹ä»£ç å—çš„å½¢å¼æ¥é˜»æ­¢autogradå»è·Ÿè¸ªé‚£äº›æ ‡è®°ä¸º.requesgrad=Trueçš„å¼ é‡çš„å†å²è®°å½•ã€‚è¿™æ­¥åœ¨æµ‹è¯•é˜¶æ®µç»å¸¸ä½¿ç”¨ã€‚</p></li>
</ul>
<blockquote>
<p><strong>æ ‡é‡åå‘ä¼ æ’­</strong>ï¼šå½“ç›®æ ‡å¼ é‡ä¸ºæ ‡é‡æ—¶ï¼Œå¯ä»¥è°ƒç”¨backward()æ–¹æ³•ä¸”æ— é¡»ä¼ å…¥å‚æ•°ã€‚ç›®æ ‡å¼ é‡ä¸€èˆ¬éƒ½æ˜¯æ ‡é‡ï¼Œå¦‚æˆ‘ä»¬ç»å¸¸ä½¿ç”¨çš„æŸå¤±å€¼Lossï¼Œä¸€èˆ¬éƒ½æ˜¯ä¸€ä¸ªæ ‡é‡ã€‚</p>
<p><strong>éæ ‡é‡åå‘ä¼ æ’­</strong>ï¼šPyTorchè§„å®šï¼Œä¸è®©å¼ é‡(Tensor)å¯¹å¼ é‡æ±‚å¯¼ï¼Œåªå…è®¸æ ‡é‡å¯¹å¼ é‡æ±‚å¯¼ã€‚å› æ­¤ï¼Œå¦‚æœç›®æ ‡å¼ é‡å¯¹ä¸€ä¸ªéæ ‡é‡è°ƒç”¨backward()ï¼Œåˆ™éœ€è¦ä¼ å…¥gradientå‚æ•°ï¼Œè¯¥å‚æ•°ä¹Ÿæ˜¯å¼ é‡ï¼Œè€Œä¸”éœ€è¦ä¸è°ƒç”¨backward()çš„å¼ é‡å½¢çŠ¶ç›¸åŒã€‚ä¼ å…¥è¿™ä¸ªå‚æ•°å°±æ˜¯ä¸ºäº†æŠŠå¼ é‡å¯¹å¼ é‡çš„æ±‚å¯¼è½¬æ¢ä¸ºæ ‡é‡å¯¹å¼ é‡çš„æ±‚å¯¼ã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ ‡é‡åå‘ä¼ æ’­</span></span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰è¾“å…¥å¼ é‡x</span></span><br><span class="line">x = torch.Tensor([<span class="number">2</span>])</span><br><span class="line"><span class="comment"># åˆå§‹åŒ–æƒé‡å‚æ•°W,åç§»é‡bã€å¹¶è®¾ç½®require_gradå±æ€§ä¸ºTrueï¼Œä¸ºè‡ªåŠ¨æ±‚å¯¼</span></span><br><span class="line">w = torch.randn(<span class="number">1</span>, requires_grad=<span class="literal">True</span>)</span><br><span class="line">b = torch.randn(<span class="number">1</span>, requires_grad=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># å®ç°å‰å‘ä¼ æ’­</span></span><br><span class="line">y = torch.mul(w, x)  <span class="comment"># ç­‰ä»·äºw*x</span></span><br><span class="line">z = torch.add(y, b)  <span class="comment"># ç­‰ä»·äºy+b</span></span><br><span class="line"><span class="comment"># æŸ¥çœ‹x,wï¼Œbé¡µå­èŠ‚ç‚¹çš„requite_gradå±æ€§</span></span><br><span class="line"><span class="comment"># x,w,bçš„require_gradå±æ€§åˆ†åˆ«ä¸ºï¼šFalse,True,True</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;x, w, bçš„require_gradå±æ€§åˆ†åˆ«ä¸ºï¼š&#123;&#125;,&#123;&#125;,&#123;&#125;&quot;</span>.<span class="built_in">format</span>(x.requires_grad, w.requires_grad, b.requires_grad))</span><br><span class="line"><span class="comment"># æŸ¥çœ‹éå¶å­èŠ‚ç‚¹çš„requres_gradå±æ€§</span></span><br><span class="line"><span class="comment"># å› ä¸wï¼Œbæœ‰ä¾èµ–å…³ç³»ï¼Œæ•…yï¼Œzçš„requires_gradå±æ€§ä¹Ÿæ˜¯ï¼šTrue,True</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;y, zçš„requires_gradå±æ€§åˆ†åˆ«ä¸ºï¼š&#123;&#125;,&#123;&#125;&quot;</span>.<span class="built_in">format</span>(y.requires_grad, z.requires_grad))</span><br><span class="line"><span class="comment"># æŸ¥çœ‹å„èŠ‚ç‚¹æ˜¯å¦ä¸ºå¶å­èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment"># xï¼Œwï¼Œbï¼Œyï¼Œzçš„æ˜¯å¦ä¸ºå¶å­èŠ‚ç‚¹ï¼šTrue,True,True,False,False</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;x, w, b, y, zçš„æ˜¯å¦ä¸ºå¶å­èŠ‚ç‚¹ï¼š&#123;&#125;,&#123;&#125;,&#123;&#125;,&#123;&#125;,&#123;&#125;&quot;</span>.<span class="built_in">format</span>(x.is_leaf, w.is_leaf, b.is_leaf, y.is_leaf, z.is_leaf))</span><br><span class="line"><span class="comment"># æŸ¥çœ‹å¶å­èŠ‚ç‚¹çš„grad_fnå±æ€§</span></span><br><span class="line"><span class="comment"># å› xï¼Œwï¼Œbä¸ºç”¨æˆ·åˆ›å»ºçš„ï¼Œä¸ºé€šè¿‡å…¶ä»–å¼ é‡è®¡ç®—å¾—åˆ°ï¼Œæ•…xï¼Œwï¼Œbçš„grad_fnå±æ€§ï¼šNone,None,None</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;x, w, bçš„grad_fnå±æ€§ï¼š&#123;&#125;,&#123;&#125;,&#123;&#125;&quot;</span>.<span class="built_in">format</span>(x.grad_fn, w.grad_fn, b.grad_fn))</span><br><span class="line"><span class="comment"># æŸ¥çœ‹éå¶å­èŠ‚ç‚¹çš„grad_fnå±æ€§</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;y, zçš„æ˜¯å¦ä¸ºå¶å­èŠ‚ç‚¹ï¼š&#123;&#125;,&#123;&#125;&quot;</span>.<span class="built_in">format</span>(y.grad_fn, z.grad_fn))</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºç»“æœ</span></span><br><span class="line">x, w, bçš„require_gradå±æ€§åˆ†åˆ«ä¸ºï¼š<span class="literal">False</span>,<span class="literal">True</span>,<span class="literal">True</span></span><br><span class="line">y, zçš„requires_gradå±æ€§åˆ†åˆ«ä¸ºï¼š<span class="literal">True</span>,<span class="literal">True</span></span><br><span class="line">x, w, b, y, zçš„æ˜¯å¦ä¸ºå¶å­èŠ‚ç‚¹ï¼š<span class="literal">True</span>,<span class="literal">True</span>,<span class="literal">True</span>,<span class="literal">False</span>,<span class="literal">False</span></span><br><span class="line">x, w, bçš„grad_fnå±æ€§ï¼š<span class="literal">None</span>,<span class="literal">None</span>,<span class="literal">None</span></span><br><span class="line">y, zçš„æ˜¯å¦ä¸ºå¶å­èŠ‚ç‚¹ï¼š&lt;MulBackward0 <span class="built_in">object</span> at <span class="number">0x000001DCB56E94C0</span>&gt;,&lt;AddBackward0 <span class="built_in">object</span> at <span class="number">0x000001DCB56E92B0</span>&gt;</span><br></pre></td></tr></table></figure>
<h2 id="pytorchç¥ç»ç½‘ç»œå·¥å…·ç®±">â›„PyTorchç¥ç»ç½‘ç»œå·¥å…·ç®±</h2>
<p>PyTorchçš„ç¥ç»ç½‘ç»œå·¥å…·ç®±ï¼Œå¯ä»¥æå¤§ç®€åŒ–æˆ‘ä»¬æ„å»ºæ¨¡å‹çš„ä»»åŠ¡ï¼Œè®¾è®¡ä¸€ä¸ªç¥ç»ç½‘ç»œå°±åƒæ­ç§¯æœ¨ä¸€æ ·ã€‚ç¥ç»ç½‘ç»œæ ¸å¿ƒç»„ä»¶ä¸»è¦åŒ…æ‹¬ï¼š</p>
<ul>
<li><p>å±‚ï¼šç¥ç»ç½‘ç»œçš„åŸºæœ¬ç»“æ„ï¼Œå°†è¾“å…¥å¼ é‡è½¬æ¢ä¸ºè¾“å‡ºå¼ é‡ã€‚</p></li>
<li><p>æ¨¡å‹ï¼šå±‚æ„æˆçš„ç½‘ç»œã€‚</p></li>
<li><p>æŸå¤±å‡½æ•°ï¼šå‚æ•°å­¦ä¹ çš„ç›®æ ‡å‡½æ•°ï¼Œé€šè¿‡æœ€å°åŒ–æŸå¤±å‡½æ•°æ¥å­¦ä¹ å„ç§å‚æ•°ã€‚</p></li>
<li><p>ä¼˜åŒ–å™¨ï¼šå¦‚ä½•ä½¿æŸå¤±å‡½æ•°æœ€å°ï¼Œè¿™å°±æ¶‰åŠä¼˜åŒ–å™¨ã€‚</p></li>
</ul>
<p>å¤šä¸ªå±‚é“¾æ¥åœ¨ä¸€èµ·æ„æˆä¸€ä¸ªæ¨¡å‹æˆ–ç½‘ç»œï¼Œè¾“å…¥æ•°æ®é€šè¿‡è¿™ä¸ªæ¨¡å‹è½¬æ¢ä¸ºé¢„æµ‹å€¼ï¼Œç„¶åæŸå¤±å‡½æ•°æŠŠé¢„æµ‹å€¼ä¸çœŸå®å€¼è¿›è¡Œæ¯”è¾ƒï¼Œå¾—åˆ°æŸå¤±å€¼ï¼ˆæŸå¤±å€¼å¯ä»¥æ˜¯è·ç¦»ã€æ¦‚ç‡å€¼ç­‰ï¼‰ï¼Œè¯¥æŸå¤±å€¼ç”¨äºè¡¡é‡é¢„æµ‹å€¼ä¸ç›®æ ‡ç»“æœçš„åŒ¹é…æˆ–ç›¸ä¼¼ç¨‹åº¦ï¼Œä¼˜åŒ–å™¨åˆ©ç”¨æŸå¤±å€¼æ›´æ–°æƒé‡å‚æ•°ï¼Œä»è€Œä½¿æŸå¤±å€¼è¶Šæ¥è¶Šå°ã€‚è¿™æ˜¯ä¸€ä¸ªå¾ªç¯è¿‡ç¨‹ï¼Œå½“æŸå¤±å€¼è¾¾åˆ°ä¸€ä¸ªé˜€å€¼æˆ–å¾ªç¯æ¬¡æ•°åˆ°è¾¾æŒ‡å®šæ¬¡æ•°ï¼Œå¾ªç¯ç»“æŸã€‚PyTorchæ„å»ºç¥ç»ç½‘ç»œä½¿ç”¨çš„ä¸»è¦å·¥å…·ï¼ˆæˆ–ç±»ï¼‰åŠç›¸äº’å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pkJs2pq"><img src="/img/loading1.gif" data-original="https://s21.ax1x.com/2024/06/04/pkJs2pq.jpg" alt="pkJs2pq.jpg" /></a></p>
<p>æ„å»ºç½‘ç»œå±‚å¯ä»¥åŸºäºModuleç±»æˆ–å‡½æ•°(nn.functional)ã€‚nnä¸­çš„å¤§å¤šæ•°å±‚(Layer)åœ¨functionalä¸­éƒ½æœ‰ä¸ä¹‹å¯¹åº”çš„å‡½æ•°ã€‚nn.functionalä¸­å‡½æ•°ä¸nn.Moduleä¸­çš„Layerçš„ä¸»è¦åŒºåˆ«æ˜¯åè€…ç»§æ‰¿Moduleç±»ï¼Œä¼šè‡ªåŠ¨æå–å¯å­¦ä¹ çš„å‚æ•°ã€‚è€Œnn.functionalæ›´åƒæ˜¯çº¯å‡½æ•°ã€‚ä¸¤è€…åŠŸèƒ½ç›¸åŒï¼Œä¸”æ€§èƒ½ä¹Ÿæ²¡æœ‰å¾ˆå¤§åŒºåˆ«ï¼Œé‚£ä¹ˆå¦‚ä½•é€‰æ‹©å‘¢ï¼Ÿåƒå·ç§¯å±‚ã€å…¨è¿æ¥å±‚ã€Dropoutå±‚ç­‰å› å«æœ‰å¯å­¦ä¹ å‚æ•°ï¼Œä¸€èˆ¬ä½¿ç”¨nn.Moduleï¼Œè€Œæ¿€æ´»å‡½æ•°ã€æ± åŒ–å±‚ä¸å«å¯å­¦ä¹ å‚æ•°ï¼Œå¯ä»¥ä½¿ç”¨nn.functionalä¸­å¯¹åº”çš„å‡½æ•°ã€‚</p>
<blockquote>
<ul>
<li><strong>æ„å»ºç½‘ç»œ</strong>ï¼šä½¿ç”¨sequentialæ„å»ºç½‘ç»œï¼ŒSequential()å‡½æ•°çš„åŠŸèƒ½æ˜¯å°†ç½‘ç»œçš„å±‚ç»„åˆåˆ°ä¸€èµ·ã€‚</li>
<li><strong>å‰å‘ä¼ æ’­</strong>ï¼šâ‘ forward()å‡½æ•°çš„ä»»åŠ¡æ˜¯æŠŠè¾“å…¥å±‚ã€ç½‘ç»œå±‚ã€è¾“å‡ºå±‚é“¾æ¥èµ·æ¥ï¼Œå®ç°ä¿¡æ¯çš„å‰å‘ä¼ å¯¼ï¼Œè¯¥å‡½æ•°çš„å‚æ•°ä¸€èˆ¬ä¸ºè¾“å…¥æ•°æ®ï¼Œè¿”å›å€¼ä¸ºè¾“å‡ºæ•°æ®ã€‚â‘¡åœ¨forwardå‡½æ•°ä¸­ï¼Œæœ‰äº›å±‚æ¥è‡ªnn.Moduleï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨nn.functionalå®šä¹‰ã€‚æ¥è‡ªnn.Moduleçš„éœ€è¦å®ä¾‹åŒ–ï¼Œè€Œä½¿ç”¨nn.functionalå®šä¹‰çš„å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚</li>
<li><strong>åå‘ä¼ æ’­</strong>ï¼šâ‘ æ‰‹å·¥å®ç°åå‘ä¼ æ’­ï¼Œæ¯”è¾ƒè´¹æ—¶ï¼›â‘¡PyTorchæä¾›äº†è‡ªåŠ¨åå‘ä¼ æ’­çš„åŠŸèƒ½ï¼Œç›´æ¥è®©æŸå¤±å‡½æ•°è°ƒç”¨backward()å³å¯ã€‚</li>
<li><strong>è®­ç»ƒæ¨¡å‹</strong>ï¼šâ‘ è®­ç»ƒæ¨¡å‹æ—¶éœ€è¦ä½¿æ¨¡å‹å¤„äºè®­ç»ƒæ¨¡å¼ï¼Œå³è°ƒç”¨model.train()ï¼Œä¼šæŠŠæ‰€æœ‰çš„moduleè®¾ç½®ä¸ºè®­ç»ƒæ¨¡å¼ã€‚å¦‚æœæ˜¯æµ‹è¯•æˆ–éªŒè¯é˜¶æ®µï¼Œéœ€è¦ä½¿æ¨¡å‹å¤„äºéªŒè¯é˜¶æ®µï¼Œå³è°ƒç”¨model.eval()ï¼Œä¼šæŠŠæ‰€æœ‰çš„trainingå±æ€§è®¾ç½®ä¸ºFalseã€‚â‘¡ç¼ºçœæƒ…å†µä¸‹æ¢¯åº¦æ˜¯ç´¯åŠ çš„ï¼Œéœ€è¦è°ƒç”¨optimizer.zero_grad()æŠŠæ¢¯åº¦åˆå§‹åŒ–æˆ–æ¸…é›¶ã€‚â‘¢è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæ­£å‘ä¼ æ’­ç”Ÿæˆç½‘ç»œçš„è¾“å‡ºï¼Œè®¡ç®—è¾“å‡ºå’Œå®é™…å€¼ä¹‹é—´çš„æŸå¤±å€¼ï¼Œè°ƒç”¨loss.backward()è‡ªåŠ¨ç”Ÿæˆæ¢¯åº¦ï¼Œç„¶åä½¿ç”¨optimizer.step()æ‰§è¡Œä¼˜åŒ–å™¨ï¼ŒæŠŠæ¢¯åº¦ä¼ æ’­å›æ¯ä¸ªç½‘ç»œã€‚â‘£å¦‚æœå¸Œæœ›ç”¨GPUè®­ç»ƒï¼Œéœ€è¦æŠŠæ¨¡å‹ã€è®­ç»ƒæ•°æ®ã€æµ‹è¯•æ•°æ®å‘é€åˆ°GPUä¸Šï¼Œå³è°ƒç”¨.to(device)ã€‚å¦‚æœéœ€è¦ä½¿ç”¨å¤šGPUè¿›è¡Œå¤„ç†ï¼Œå¯ä½¿æ¨¡å‹æˆ–ç›¸å…³æ•°æ®å¼•ç”¨nn.DataParallelã€‚</li>
</ul>
</blockquote>
<h3 id="nn.module">ğŸ‘€nn.Module</h3>
<p>nn.Moduleæ˜¯nnçš„ä¸€ä¸ªæ ¸å¿ƒæ•°æ®ç»“æ„ï¼Œå®ƒå¯ä»¥æ˜¯ç¥ç»ç½‘ç»œçš„æŸä¸ªå±‚(Layer)ï¼Œä¹Ÿå¯ä»¥æ˜¯åŒ…å«å¤šå±‚çš„ç¥ç»ç½‘ç»œã€‚åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œæœ€å¸¸è§çš„åšæ³•æ˜¯ç»§æ‰¿nn.Moduleï¼Œç”Ÿæˆè‡ªå·±çš„ç½‘ç»œ/å±‚ã€‚nnä¸­å·²å®ç°äº†ç»å¤§å¤šæ•°å±‚ï¼ŒåŒ…æ‹¬å…¨è¿æ¥å±‚ã€æŸå¤±å±‚ã€æ¿€æ´»å±‚ã€å·ç§¯å±‚ã€å¾ªç¯å±‚ç­‰ï¼Œè¿™äº›å±‚éƒ½æ˜¯nn.Moduleçš„å­ç±»ï¼Œèƒ½å¤Ÿè‡ªåŠ¨æ£€æµ‹åˆ°è‡ªå·±çš„Parameterï¼Œå¹¶å°†å…¶ä½œä¸ºå­¦ä¹ å‚æ•°ï¼Œä¸”é’ˆå¯¹GPUè¿è¡Œè¿›è¡Œäº†cuDNNä¼˜åŒ–ã€‚</p>
<h3 id="nn.functional">ğŸ‘€nn.functional</h3>
<p>nnä¸­çš„å±‚ï¼Œä¸€ç±»æ˜¯ç»§æ‰¿äº†nn.Moduleï¼Œå…¶å‘½åä¸€èˆ¬ä¸ºnn.Xxx(ç¬¬ä¸€ä¸ªæ˜¯å¤§å†™)ï¼Œå¦‚nn.Linearã€nn.Conv2dã€nn.CrossEntropyLossç­‰ã€‚å¦ä¸€ç±»æ˜¯nn.functionalä¸­çš„å‡½æ•°ï¼Œå…¶åç§°ä¸€èˆ¬ä¸ºnn.funtional.xxxï¼Œå¦‚nn.funtional.linearã€nn.funtional.conv2dã€nn.funtional.cross_entropyç­‰ã€‚ä»åŠŸèƒ½æ¥è¯´ä¸¤è€…ç›¸å½“ï¼ŒåŸºäºnn.Moudleèƒ½å®ç°çš„å±‚ï¼Œä½¿ç”¨nn.funtionalä¹Ÿå¯å®ç°ï¼Œåä¹‹äº¦ç„¶ï¼Œè€Œä¸”æ€§èƒ½æ–¹é¢ä¸¤è€…ä¹Ÿæ²¡æœ‰å¤ªå¤§å·®å¼‚ã€‚ä¸è¿‡åœ¨å…·ä½“ä½¿ç”¨æ—¶ï¼Œä¸¤è€…è¿˜æ˜¯æœ‰åŒºåˆ«ï¼Œä¸»è¦åŒºåˆ«å¦‚ä¸‹ï¼š</p>
<ul>
<li><p>nn.Xxxç»§æ‰¿äºnn.Moduleï¼Œnn.Xxxéœ€è¦å…ˆå®ä¾‹åŒ–å¹¶ä¼ å…¥å‚æ•°ï¼Œç„¶åä»¥å‡½æ•°è°ƒç”¨çš„æ–¹å¼è°ƒç”¨å®ä¾‹åŒ–çš„å¯¹è±¡å¹¶ä¼ å…¥è¾“å…¥æ•°æ®ã€‚å®ƒèƒ½å¤Ÿå¾ˆå¥½åœ°ä¸nn.Sequentialç»“åˆä½¿ç”¨ï¼Œè€Œnn.functional.xxxæ— æ³•ä¸nn.Sequentialç»“åˆä½¿ç”¨ã€‚</p></li>
<li><p>nn.Xxxä¸éœ€è¦è‡ªå·±å®šä¹‰å’Œç®¡ç†weightã€biaså‚æ•°ï¼›è€Œnn.functional.xxxéœ€è¦è‡ªå·±å®šä¹‰weightã€biaså‚æ•°ï¼Œæ¯æ¬¡è°ƒç”¨çš„æ—¶å€™éƒ½éœ€è¦æ‰‹åŠ¨ä¼ å…¥weightã€biasç­‰å‚æ•°ï¼Œä¸åˆ©äºä»£ç å¤ç”¨ã€‚</p></li>
<li><p>Dropoutæ“ä½œåœ¨è®­ç»ƒå’Œæµ‹è¯•é˜¶æ®µæ˜¯æœ‰åŒºåˆ«çš„ï¼Œä½¿ç”¨nn.Xxxæ–¹å¼å®šä¹‰Dropoutï¼Œåœ¨è°ƒç”¨model.eval()ä¹‹åï¼Œè‡ªåŠ¨å®ç°çŠ¶æ€çš„è½¬æ¢ï¼Œè€Œä½¿ç”¨nn.functional.xxxå´æ— æ­¤åŠŸèƒ½ã€‚</p></li>
</ul>
<p>æ€»çš„æ¥è¯´ï¼Œä¸¤ç§åŠŸèƒ½éƒ½æ˜¯ç›¸åŒçš„ï¼Œä½†PyTorchå®˜æ–¹æ¨èï¼šå…·æœ‰å­¦ä¹ å‚æ•°çš„(ä¾‹å¦‚Conv2dã€Linearã€Batch_normç­‰)é‡‡ç”¨nn.Xxxæ–¹å¼ã€‚æ²¡æœ‰å­¦ä¹ å‚æ•°çš„(ä¾‹å¦‚maxpoolã€loss funcã€activation funcç­‰)æ ¹æ®ä¸ªäººé€‰æ‹©ä½¿ç”¨nn.Xxxæˆ–è€…nn.functional.xxxæ–¹å¼ã€‚</p>
<h3 id="ä¼˜åŒ–å™¨">ğŸ‘€ä¼˜åŒ–å™¨</h3>
<p><strong>ï¼ˆ1ï¼‰ä¼˜åŒ–å™¨ä¸€èˆ¬æ­¥éª¤</strong></p>
<p>PyTorchå¸¸ç”¨çš„ä¼˜åŒ–æ–¹æ³•éƒ½å°è£…åœ¨torch.optimé‡Œé¢ï¼Œå…¶è®¾è®¡å¾ˆçµæ´»ï¼Œå¯ä»¥æ‰©å±•ä¸ºè‡ªå®šä¹‰çš„ä¼˜åŒ–æ–¹æ³•ã€‚æ‰€æœ‰çš„ä¼˜åŒ–æ–¹æ³•éƒ½æ˜¯ç»§æ‰¿äº†åŸºç±»optim.Optimizerï¼Œå¹¶å®ç°äº†è‡ªå·±çš„ä¼˜åŒ–æ­¥éª¤ã€‚æœ€å¸¸ç”¨çš„ä¼˜åŒ–ç®—æ³•å°±æ˜¯æ¢¯åº¦ä¸‹é™æ³•åŠå…¶å„ç§å˜ç§ï¼Œè¿™ç±»ä¼˜åŒ–ç®—æ³•é€šè¿‡ä½¿ç”¨å‚æ•°çš„æ¢¯åº¦å€¼æ›´æ–°å‚æ•°ã€‚ä½¿ç”¨ä¼˜åŒ–å™¨çš„ä¸€èˆ¬æ­¥éª¤ä¸ºï¼š</p>
<ul>
<li><p><strong>å»ºç«‹ä¼˜åŒ–å™¨å®ä¾‹</strong>ï¼šå¯¼å…¥optimæ¨¡å—ï¼Œå®ä¾‹åŒ–SGDï¼ˆä»¥éšæœºæ¢¯åº¦ä¸‹é™æ³•ä¸ºä¾‹ï¼‰ä¼˜åŒ–å™¨ã€‚</p></li>
<li><p><strong>å‘å‰ä¼ æ’­</strong>ï¼šæŠŠè¾“å…¥æ•°æ®ä¼ å…¥ç¥ç»ç½‘ç»œNetå®ä¾‹åŒ–å¯¹è±¡modelä¸­ï¼Œè‡ªåŠ¨æ‰§è¡Œforwardå‡½æ•°ï¼Œå¾—åˆ°outè¾“å‡ºå€¼ï¼ˆout = model(img)ï¼‰ï¼Œç„¶åç”¨outä¸æ ‡è®°labelè®¡ç®—æŸå¤±å€¼lossã€‚loss = criterion(out, label)</p></li>
<li><p><strong>æ¸…ç©ºæ¢¯åº¦</strong>ï¼šç¼ºçœæƒ…å†µæ¢¯åº¦æ˜¯ç´¯åŠ çš„ï¼Œåœ¨æ¢¯åº¦åå‘ä¼ æ’­å‰ï¼Œå…ˆéœ€æŠŠæ¢¯åº¦æ¸…é›¶ã€‚optimizer.zero_grad()</p></li>
<li><p><strong>åå‘ä¼ æ’­</strong>ï¼šåŸºäºæŸå¤±å€¼ï¼ŒæŠŠæ¢¯åº¦è¿›è¡Œåå‘ä¼ æ’­ã€‚loss.backward()</p></li>
<li><p><strong>æ›´æ–°å‚æ•°</strong>ï¼šåŸºäºå½“å‰æ¢¯åº¦ï¼ˆå­˜å‚¨åœ¨å‚æ•°çš„.gradå±æ€§ä¸­ï¼‰æ›´æ–°å‚æ•°ã€‚optimizer.step()</p></li>
</ul>
<blockquote>
<p>å…¶ä¸­å‘å‰ä¼ æ’­ã€æ¸…ç©ºæ¢¯åº¦ã€åå‘ä¼ æ’­ã€æ›´æ–°å‚æ•°æ˜¯åœ¨è®­ç»ƒæ¨¡å‹çš„forå¾ªç¯ä¸­ã€‚</p>
</blockquote>
<p>åŠ¨æ€ä¿®æ”¹å­¦ä¹ ç‡å‚æ•°ï¼šå¯ä»¥é€šè¿‡ä¿®æ”¹å‚æ•°optimizer.params_groupsæˆ–æ–°å»ºoptimizerã€‚æ–°å»ºoptimizeræ¯”è¾ƒç®€å•ï¼Œoptimizerååˆ†è½»é‡çº§ï¼Œæ‰€ä»¥å¼€é”€å¾ˆå°ã€‚ä½†æ˜¯æ–°çš„ä¼˜åŒ–å™¨ä¼šåˆå§‹åŒ–åŠ¨é‡ç­‰çŠ¶æ€ä¿¡æ¯ï¼Œè¿™å¯¹äºä½¿ç”¨åŠ¨é‡çš„ä¼˜åŒ–å™¨ï¼ˆmomentumå‚æ•°çš„sgdï¼‰å¯èƒ½ä¼šé€ æˆæ”¶æ•›ä¸­çš„éœ‡è¡ã€‚</p>
<blockquote>
<p>optimizer.param_groupsï¼šé•¿åº¦1çš„listï¼›</p>
<p>optimizer.param_groups[0]ï¼šé•¿åº¦ä¸º6çš„å­—å…¸ï¼ŒåŒ…æ‹¬æƒé‡å‚æ•°ã€lrã€momentumç­‰å‚æ•°ã€‚</p>
</blockquote>
<p><strong>ï¼ˆ2ï¼‰ä¼˜åŒ–å™¨ç§ç±»</strong></p>
<p>ä¼˜åŒ–å™¨çš„æ–¹æ³•ä¸»è¦å¯ä»¥åˆ†ä¸ºä¸¤å¤§ç±»ï¼Œä¸€å¤§ç±»æ–¹æ³•æ˜¯SGDåŠå…¶æ”¹è¿›ï¼ˆåŠ Momentumï¼‰ï¼Œå¦å¤–ä¸€å¤§ç±»æ˜¯é€å‚æ•°é€‚åº”å­¦ä¹ ç‡æ–¹æ³•ï¼ŒåŒ…æ‹¬AdaGradã€RMSPropã€Adamç­‰ã€‚<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_36589234/article/details/89330342">å‚è€ƒé“¾æ¥â‘ </a>ã€<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_62965652/article/details/136969277">å‚è€ƒé“¾æ¥â‘¡</a>ã€<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42109740/article/details/105401197">å‚è€ƒé“¾æ¥â‘¢</a></p>
<ul>
<li><p>SGD(Stochastic Gradient Descent, éšæœºæ¢¯åº¦ä¸‹é™)</p></li>
<li><p>SGD+MomentumåŠ¨é‡æ³•</p></li>
<li><p>NAG(Nesterov Accelerated Gradient)</p></li>
<li><p>Adagradè‡ªé€‚åº”å­¦ä¹ ç‡ä¼˜åŒ–ç®—æ³•</p></li>
<li><p>RMSPropè‡ªé€‚åº”å­¦ä¹ ç‡ä¼˜åŒ–ç®—æ³•</p></li>
<li><p>Adamè‡ªé€‚åº”å­¦ä¹ ç‡ä¼˜åŒ–ç®—æ³•ï¼Œæœ¬è´¨ä¸Šæ˜¯å°†åŠ¨é‡(Momentum)å’ŒRMSpropä¸¤ç§æ€æƒ³ç»“åˆåˆ°ä¸€ç§ç®—æ³•ä¸­</p></li>
</ul>
<h2 id="pytorchæ•°æ®å¤„ç†å·¥å…·ç®±">â›„PyTorchæ•°æ®å¤„ç†å·¥å…·ç®±</h2>
<h3 id="utils.dataå’Œtorchvision">ğŸ‘€utils.dataå’ŒTorchvision</h3>
<p>æ•°æ®ä¸‹è½½å’Œé¢„å¤„ç†æ˜¯æœºå™¨å­¦ä¹ ã€æ·±åº¦å­¦ä¹ å®é™…é¡¹ç›®ä¸­è€—æ—¶åˆé‡è¦çš„ä»»åŠ¡ï¼Œå°¤å…¶æ˜¯æ•°æ®é¢„å¤„ç†ï¼Œå…³ç³»åˆ°æ•°æ®è´¨é‡å’Œæ¨¡å‹æ€§èƒ½ï¼Œè¦å æ®é¡¹ç›®çš„å¤§éƒ¨åˆ†æ—¶é—´ã€‚PyTorchä¸ºæ­¤æä¾›äº†ä¸“é—¨çš„æ•°æ®ä¸‹è½½ã€æ•°æ®å¤„ç†åŒ…ï¼Œä½¿ç”¨è¿™äº›åŒ…å¯æå¤§åœ°æé«˜å¼€å‘æ•ˆç‡åŠæ•°æ®è´¨é‡ã€‚PyTorchæ¶‰åŠæ•°æ®å¤„ç†ï¼ˆæ•°æ®è£…è½½ã€æ•°æ®é¢„å¤„ç†ã€æ•°æ®å¢å¼ºç­‰ï¼‰çš„ä¸»è¦å·¥å…·åŒ…åŠç›¸äº’å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pkt5JlF"><img src="/img/loading1.gif" data-original="https://s21.ax1x.com/2024/06/08/pkt5JlF.jpg" alt="pkt5JlF.jpg" /></a></p>
<p>torch.utils.dataå·¥å…·åŒ…ï¼Œå®ƒåŒ…æ‹¬ä»¥ä¸‹4ä¸ªç±»ã€‚</p>
<ul>
<li><p>Datasetï¼šæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå…¶ä»–æ•°æ®é›†éœ€è¦ç»§æ‰¿è¿™ä¸ªç±»ï¼Œå¹¶ä¸”è¦†å†™å…¶ä¸­çš„ä¸¤ä¸ªæ–¹æ³•(getitemã€len)ã€‚</p></li>
<li><p>DataLoaderï¼šå®šä¹‰ä¸€ä¸ªæ–°çš„è¿­ä»£å™¨ï¼Œå®ç°æ‰¹é‡(batch)è¯»å–ï¼Œæ‰“ä¹±æ•°æ®(shuffle)å¹¶æä¾›å¹¶è¡ŒåŠ é€Ÿç­‰åŠŸèƒ½ã€‚</p></li>
<li><p>random_splitï¼šæŠŠæ•°æ®é›†éšæœºæ‹†åˆ†ä¸ºç»™å®šé•¿åº¦çš„éé‡å çš„æ–°æ•°æ®é›†ã€‚</p></li>
<li><p>*samplerï¼šå¤šç§é‡‡æ ·å‡½æ•°ã€‚</p></li>
</ul>
<p>Torchvisionæ˜¯PyTorchçš„ä¸€ä¸ªè§†è§‰å¤„ç†å·¥å…·åŒ…ï¼Œç‹¬ç«‹äºPyTorchã€‚å®ƒåŒ…æ‹¬4ä¸ªç±»ï¼Œä¸»è¦åŠŸèƒ½å¦‚ä¸‹(<a target="_blank" rel="noopener" href="https://blog.csdn.net/xw555666/article/details/136068651">å‚è€ƒåšå®¢â‘ </a>)ï¼š</p>
<ul>
<li><p>datasetsï¼šæä¾›å¸¸ç”¨çš„æ•°æ®é›†åŠ è½½ï¼Œè®¾è®¡ä¸Šéƒ½æ˜¯ç»§æ‰¿è‡ªtorch.utils.data.Datasetï¼Œä¸»è¦åŒ…æ‹¬MMISTã€CIFAR10/100ã€Fashion-MNISTã€ImageNetã€STL10å’ŒCOCOç­‰ã€‚</p></li>
<li><p>modelsï¼šæä¾›æ·±åº¦å­¦ä¹ ä¸­å„ç§ç»å…¸çš„ç½‘ç»œç»“æ„ä»¥åŠè®­ç»ƒå¥½çš„æ¨¡å‹ï¼ˆå¦‚æœé€‰æ‹©pretrained=Trueï¼‰ï¼ŒåŒ…æ‹¬AlexNetã€VGGç³»åˆ—ã€ResNetç³»åˆ—ã€Inceptionç³»åˆ—ç­‰ã€‚</p></li>
<li><p>transformsï¼šå¸¸ç”¨çš„æ•°æ®é¢„å¤„ç†æ“ä½œï¼Œä¸»è¦åŒ…æ‹¬å¯¹TensoråŠPIL Imageå¯¹è±¡çš„æ“ä½œã€‚</p></li>
<li><p>utilsï¼šå«ä¸¤ä¸ªå‡½æ•°ï¼Œä¸€ä¸ªæ˜¯make_gridï¼Œå®ƒèƒ½å°†å¤šå¼ å›¾ç‰‡æ‹¼æ¥åœ¨ä¸€ä¸ªç½‘æ ¼ä¸­ï¼›å¦ä¸€ä¸ªæ˜¯save_imgï¼Œå®ƒèƒ½å°†Tensorä¿å­˜æˆå›¾ç‰‡ã€‚</p></li>
</ul>
<h3 id="tensorboardxå¯è§†åŒ–å·¥å…·">ğŸ‘€tensorboardXå¯è§†åŒ–å·¥å…·</h3>
<p>Tensorboardæ˜¯Google TensorFlowçš„å¯è§†åŒ–å·¥å…·ï¼Œå®ƒå¯ä»¥è®°å½•è®­ç»ƒæ•°æ®ã€è¯„ä¼°æ•°æ®ã€ç½‘ç»œç»“æ„ã€å›¾åƒç­‰ï¼Œå¹¶ä¸”å¯ä»¥åœ¨webä¸Šå±•ç¤ºï¼Œå¯¹äºè§‚å¯Ÿç¥ç»ç½‘ç»œè®­ç»ƒçš„è¿‡ç¨‹éå¸¸æœ‰å¸®åŠ©ã€‚PyTorchå¯ä»¥é‡‡ç”¨tensorboard_loggerã€visdomç­‰å¯è§†åŒ–å·¥å…·ï¼Œä½†è¿™äº›æ–¹æ³•æ¯”è¾ƒå¤æ‚æˆ–ä¸å¤Ÿå‹å¥½ã€‚ä¸ºè§£å†³è¯¥é—®é¢˜ï¼Œäººä»¬æ¨å‡ºäº†å¯ç”¨äºPyTorchå¯è§†åŒ–çš„æ–°çš„æ›´å¼ºå¤§çš„å·¥å…·â€”â€”tensorboardXã€‚tensorboardXåŠŸèƒ½å¾ˆå¼ºå¤§ï¼Œæ”¯æŒscalarã€imageã€figureã€histogramã€audioã€textã€graphã€onnx_graphã€embeddingã€pr_curve and videosummariesç­‰å¯è§†åŒ–æ–¹å¼ã€‚<a target="_blank" rel="noopener" href="https://blog.csdn.net/bigbennyguo/article/details/87956434">å‚è€ƒåšå®¢â‘ </a>ã€<a target="_blank" rel="noopener" href="https://blog.csdn.net/HowieXue/article/details/105412155">å‚è€ƒåšå®¢â‘¡</a></p>
<p>ï¼ˆ1ï¼‰å¯¼å…¥tensorboardXï¼Œå®ä¾‹åŒ–SummaryWriterç±»ï¼ŒæŒ‡æ˜è®°å½•æ—¥å¿—è·¯å¾„ç­‰ä¿¡æ¯</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> tensorboardX <span class="keyword">import</span> SummaryWriter</span><br><span class="line"><span class="comment"># å®ä¾‹åŒ–SummaryWriterï¼Œå¹¶æŒ‡æ˜æ—¥å¿—å­˜æ”¾è·¯å¾„ã€‚åœ¨å½“å‰ç›®å½•æ²¡æœ‰logsç›®å½•å°†è‡ªåŠ¨åˆ›å»ºã€‚</span></span><br><span class="line">writer = SummaryWriter(log_dir=<span class="string">&#x27;logs&#x27;</span>)</span><br><span class="line"><span class="comment"># è°ƒç”¨å®ä¾‹</span></span><br><span class="line">writer.add_xxx()</span><br><span class="line"><span class="comment"># å…³é—­writer</span></span><br><span class="line">writer.close()</span><br></pre></td></tr></table></figure>
<p>ï¼ˆ2ï¼‰è°ƒç”¨ç›¸åº”çš„APIæ¥å£</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">writer.add_xxx(tag-name, <span class="built_in">object</span>, iteration-number)</span><br><span class="line"><span class="comment"># å³add_xxx(æ ‡ç­¾ï¼Œè®°å½•çš„å¯¹è±¡ï¼Œè¿­ä»£æ¬¡æ•°)</span></span><br></pre></td></tr></table></figure>
<p>ï¼ˆ3ï¼‰å¯åŠ¨tensorboardæœåŠ¡</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">tensorboard --logdir=logs --port <span class="number">6006</span></span><br><span class="line"><span class="comment"># å¦‚æœæ˜¯Windowsç¯å¢ƒï¼Œè¦æ³¨æ„è·¯å¾„è§£æï¼Œå¦‚</span></span><br><span class="line"><span class="comment"># tensorboard --logdir=r&#x27;D:\myboard\test\logs&#x27; --port 6006</span></span><br></pre></td></tr></table></figure>
<p>ï¼ˆ4ï¼‰webå±•ç¤º</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">http://æœåŠ¡å™¨IPæˆ–åç§°:<span class="number">6006</span> <span class="comment"># å¦‚æœæ˜¯æœ¬æœºï¼ŒæœåŠ¡å™¨åç§°å¯ä»¥ä½¿ç”¨localhost</span></span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://heartlovelife.github.io">Xiaotangsmiles</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://heartlovelife.github.io/2024/06/10/DL-PyTorch-Basic/">https://heartlovelife.github.io/2024/06/10/DL-PyTorch-Basic/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://heartlovelife.github.io" target="_blank">æ±Ÿæ¹–æ˜¯ä½ ç”»ä¸­äº¦æ˜¯ä½ </a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/PyTorch/">PyTorch</a></div><div class="post_share"><div class="social-share" data-image="https://s2.loli.net/2024/06/10/KdBQXSmlCgFOWR1.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/gh/overtrue/share.js@master/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> æ‰“èµ</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/loading1.gif" data-original="/img/wechat.jpg" alt="wechat(å¾®ä¿¡)"/></a><div class="post-qr-code-desc">wechat(å¾®ä¿¡)</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/loading1.gif" data-original="/img/alipay.jpg" alt="alipay(æ”¯ä»˜å®)"/></a><div class="post-qr-code-desc">alipay(æ”¯ä»˜å®)</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/08/25/Python-GUI-Design/"><img class="prev-cover" src="/img/loading1.gif" data-original="https://s2.loli.net/2024/08/25/u7qX6PLeFUzxHvV.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">GUIç¼–ç¨‹ä¹‹PyQt5å…¥é—¨è¯¦è§£ï¼ˆ01ï¼‰</div></div></a></div><div class="next-post pull-right"><a href="/2024/01/20/RS-LST-Method/"><img class="next-cover" src="/img/loading1.gif" data-original="https://s2.loli.net/2024/05/05/SHmUYgArEMzfLph.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">è¾å°„ä¼ è¾“åŸºç¡€ç†è®ºè¯¦è§£ä¸LSTåæ¼”æ–¹æ³•</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/loading1.gif" data-original="/img/touxiang.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Xiaotangsmiles</div><div class="author-info__description">æˆ‘ä»¬æ€»ä»¥ä¸ºæ¥æ—¥æ–¹é•¿ï¼Œå´å¿˜äº†ä¸–äº‹æ— å¸¸</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">27</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">27</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">11</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/HeartLoveLife"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/HeartLoveLife" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://blog.csdn.net/twg666" target="_blank" title="CSDN"><i class="fa fa-book-open"></i></a><a class="social-icon" href="tencent://AddContact/?fromId=45&amp;fromSubId=1&amp;subcmd=all&amp;uin=491037927&amp;website=www.oicqzone.com" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="mailto:xiaotangsmiles@163.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">æˆ‘æœ‰æˆ‘è‡ªå·±çš„å¤ªé˜³ã€æœˆäº®å’Œæ˜Ÿæ˜Ÿï¼Œæˆ‘æœ‰ä¸€ä¸ªå®Œå…¨å±äºæˆ‘è‡ªå·±çš„å°ä¸–ç•Œã€‚</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">â›„å‰è¨€</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pytorch%E5%9F%BA%E7%A1%80"><span class="toc-number">2.</span> <span class="toc-text">â›„PyTorchåŸºç¡€</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#numpy%E5%9F%BA%E7%A1%80"><span class="toc-number">2.1.</span> <span class="toc-text">ğŸ‘€NumpyåŸºç¡€</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#numpy%E6%95%B0%E7%BB%84"><span class="toc-number">2.1.1.</span> <span class="toc-text">ğŸ‘Numpyæ•°ç»„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%85%83%E7%B4%A0"><span class="toc-number">2.1.2.</span> <span class="toc-text">ğŸ‘è·å–å…ƒç´ </span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#numpy%E7%9A%84%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97"><span class="toc-number">2.1.3.</span> <span class="toc-text">ğŸ‘Numpyçš„ç®—æœ¯è¿ç®—</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E7%BB%84%E5%8F%98%E5%BD%A2"><span class="toc-number">2.1.4.</span> <span class="toc-text">ğŸ‘æ•°ç»„å˜å½¢</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%B9%E9%87%8F%E5%A4%84%E7%90%86"><span class="toc-number">2.1.5.</span> <span class="toc-text">ğŸ‘æ‰¹é‡å¤„ç†</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E7%94%A8%E5%87%BD%E6%95%B0"><span class="toc-number">2.1.6.</span> <span class="toc-text">ğŸ‘é€šç”¨å‡½æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B9%BF%E6%92%AD%E6%9C%BA%E5%88%B6"><span class="toc-number">2.1.7.</span> <span class="toc-text">ğŸ‘å¹¿æ’­æœºåˆ¶</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pytorch%E5%9F%BA%E7%A1%80-1"><span class="toc-number">2.2.</span> <span class="toc-text">ğŸ‘€PyTorchåŸºç¡€</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#tensor%E6%A6%82%E8%BF%B0"><span class="toc-number">2.2.1.</span> <span class="toc-text">ğŸ‘Tensoræ¦‚è¿°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAtensor"><span class="toc-number">2.2.2.</span> <span class="toc-text">ğŸ‘åˆ›å»ºTensor</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9tensor%E5%BD%A2%E7%8A%B6"><span class="toc-number">2.2.3.</span> <span class="toc-text">ğŸ‘ä¿®æ”¹Tensorå½¢çŠ¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E6%93%8D%E4%BD%9C"><span class="toc-number">2.2.4.</span> <span class="toc-text">ğŸ‘ç´¢å¼•æ“ä½œ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B9%BF%E6%92%AD%E6%9C%BA%E5%88%B6-1"><span class="toc-number">2.2.5.</span> <span class="toc-text">ğŸ‘å¹¿æ’­æœºåˆ¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%90%E5%85%83%E7%B4%A0%E6%93%8D%E4%BD%9C"><span class="toc-number">2.2.6.</span> <span class="toc-text">ğŸ‘é€å…ƒç´ æ“ä½œ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BD%92%E5%B9%B6%E6%93%8D%E4%BD%9C"><span class="toc-number">2.2.7.</span> <span class="toc-text">ğŸ‘å½’å¹¶æ“ä½œ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AF%94%E8%BE%83%E6%93%8D%E4%BD%9C"><span class="toc-number">2.2.8.</span> <span class="toc-text">ğŸ‘æ¯”è¾ƒæ“ä½œ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9F%A9%E9%98%B5%E6%93%8D%E4%BD%9C"><span class="toc-number">2.2.9.</span> <span class="toc-text">ğŸ‘çŸ©é˜µæ“ä½œ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#pytorch%E4%B8%8Enumpy%E6%AF%94%E8%BE%83"><span class="toc-number">2.2.10.</span> <span class="toc-text">ğŸ‘PyTorchä¸Numpyæ¯”è¾ƒ</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tensor%E4%B8%8Eautograd"><span class="toc-number">2.3.</span> <span class="toc-text">ğŸ‘€Tensorä¸Autograd</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pytorch%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E5%B7%A5%E5%85%B7%E7%AE%B1"><span class="toc-number">3.</span> <span class="toc-text">â›„PyTorchç¥ç»ç½‘ç»œå·¥å…·ç®±</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#nn.module"><span class="toc-number">3.1.</span> <span class="toc-text">ğŸ‘€nn.Module</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#nn.functional"><span class="toc-number">3.2.</span> <span class="toc-text">ğŸ‘€nn.functional</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E5%8C%96%E5%99%A8"><span class="toc-number">3.3.</span> <span class="toc-text">ğŸ‘€ä¼˜åŒ–å™¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pytorch%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7%E7%AE%B1"><span class="toc-number">4.</span> <span class="toc-text">â›„PyTorchæ•°æ®å¤„ç†å·¥å…·ç®±</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#utils.data%E5%92%8Ctorchvision"><span class="toc-number">4.1.</span> <span class="toc-text">ğŸ‘€utils.dataå’ŒTorchvision</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tensorboardx%E5%8F%AF%E8%A7%86%E5%8C%96%E5%B7%A5%E5%85%B7"><span class="toc-number">4.2.</span> <span class="toc-text">ğŸ‘€tensorboardXå¯è§†åŒ–å·¥å…·</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/11/16/RS-CSink-Method/" title="ç¢³æ±‡ä¼°ç®—æ–¹æ³•æ¦‚è¿°åŠåŸºäºRSçš„ç¢³æ±‡ä¼°ç®—æ¨¡å‹è¯¦è¿°ã€20241116ã€‘"><img src="/img/loading1.gif" data-original="https://s2.loli.net/2024/11/16/2lwpstimg6HCTod.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ç¢³æ±‡ä¼°ç®—æ–¹æ³•æ¦‚è¿°åŠåŸºäºRSçš„ç¢³æ±‡ä¼°ç®—æ¨¡å‹è¯¦è¿°ã€20241116ã€‘"/></a><div class="content"><a class="title" href="/2024/11/16/RS-CSink-Method/" title="ç¢³æ±‡ä¼°ç®—æ–¹æ³•æ¦‚è¿°åŠåŸºäºRSçš„ç¢³æ±‡ä¼°ç®—æ¨¡å‹è¯¦è¿°ã€20241116ã€‘">ç¢³æ±‡ä¼°ç®—æ–¹æ³•æ¦‚è¿°åŠåŸºäºRSçš„ç¢³æ±‡ä¼°ç®—æ¨¡å‹è¯¦è¿°ã€20241116ã€‘</a><time datetime="2024-11-16T12:20:20.000Z" title="å‘è¡¨äº 2024-11-16 20:20:20">2024-11-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/10/28/Py6S-Model-Use/" title="å¸¸è§å¤§æ°”æ ¡æ­£æ¨¡å‹åŠ6Sæ¨¡å‹å®‰è£…éƒ¨ç½²ã€20241028ã€‘"><img src="/img/loading1.gif" data-original="https://s2.loli.net/2024/10/28/mOhXvaL3YTEdMo9.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="å¸¸è§å¤§æ°”æ ¡æ­£æ¨¡å‹åŠ6Sæ¨¡å‹å®‰è£…éƒ¨ç½²ã€20241028ã€‘"/></a><div class="content"><a class="title" href="/2024/10/28/Py6S-Model-Use/" title="å¸¸è§å¤§æ°”æ ¡æ­£æ¨¡å‹åŠ6Sæ¨¡å‹å®‰è£…éƒ¨ç½²ã€20241028ã€‘">å¸¸è§å¤§æ°”æ ¡æ­£æ¨¡å‹åŠ6Sæ¨¡å‹å®‰è£…éƒ¨ç½²ã€20241028ã€‘</a><time datetime="2024-10-28T12:13:14.000Z" title="å‘è¡¨äº 2024-10-28 20:13:14">2024-10-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/09/23/Matlab-GUI-Design/" title="GUIç¼–ç¨‹ä¹‹MATLABå…¥é—¨è¯¦è§£ï¼ˆ01ï¼‰"><img src="/img/loading1.gif" data-original="https://s2.loli.net/2024/08/25/u7qX6PLeFUzxHvV.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="GUIç¼–ç¨‹ä¹‹MATLABå…¥é—¨è¯¦è§£ï¼ˆ01ï¼‰"/></a><div class="content"><a class="title" href="/2024/09/23/Matlab-GUI-Design/" title="GUIç¼–ç¨‹ä¹‹MATLABå…¥é—¨è¯¦è§£ï¼ˆ01ï¼‰">GUIç¼–ç¨‹ä¹‹MATLABå…¥é—¨è¯¦è§£ï¼ˆ01ï¼‰</a><time datetime="2024-09-23T14:22:08.000Z" title="å‘è¡¨äº 2024-09-23 22:22:08">2024-09-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/09/15/RS-data-dowmload/" title="MODIS/Landsat/Sentinelä¸‹è½½æ•™ç¨‹è¯¦è§£ã€å¸¸ç”¨ç½‘ç«™åŠæ–¹æ³•æšä¸¾ã€‘"><img src="/img/loading1.gif" data-original="https://s2.loli.net/2024/09/15/xhwoIklLQq2mFp8.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MODIS/Landsat/Sentinelä¸‹è½½æ•™ç¨‹è¯¦è§£ã€å¸¸ç”¨ç½‘ç«™åŠæ–¹æ³•æšä¸¾ã€‘"/></a><div class="content"><a class="title" href="/2024/09/15/RS-data-dowmload/" title="MODIS/Landsat/Sentinelä¸‹è½½æ•™ç¨‹è¯¦è§£ã€å¸¸ç”¨ç½‘ç«™åŠæ–¹æ³•æšä¸¾ã€‘">MODIS/Landsat/Sentinelä¸‹è½½æ•™ç¨‹è¯¦è§£ã€å¸¸ç”¨ç½‘ç«™åŠæ–¹æ³•æšä¸¾ã€‘</a><time datetime="2024-09-15T03:24:52.000Z" title="å‘è¡¨äº 2024-09-15 11:24:52">2024-09-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/08/25/Python-GUI-Design/" title="GUIç¼–ç¨‹ä¹‹PyQt5å…¥é—¨è¯¦è§£ï¼ˆ01ï¼‰"><img src="/img/loading1.gif" data-original="https://s2.loli.net/2024/08/25/u7qX6PLeFUzxHvV.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="GUIç¼–ç¨‹ä¹‹PyQt5å…¥é—¨è¯¦è§£ï¼ˆ01ï¼‰"/></a><div class="content"><a class="title" href="/2024/08/25/Python-GUI-Design/" title="GUIç¼–ç¨‹ä¹‹PyQt5å…¥é—¨è¯¦è§£ï¼ˆ01ï¼‰">GUIç¼–ç¨‹ä¹‹PyQt5å…¥é—¨è¯¦è§£ï¼ˆ01ï¼‰</a><time datetime="2024-08-25T12:36:36.000Z" title="å‘è¡¨äº 2024-08-25 20:36:36">2024-08-25</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2024 By Xiaotangsmiles</div><div class="framework-info"><span>åœ°å€ </span><a href="https://heartlovelife.github.io">HeartLoveLife</a><span class="footer-separator">|</span><span>é‚®ç®± </span><a href="javascript:void(0);">xiaotangsmiles@163.com</a></div><div class="footer_custom_text">Hi, welcome to my <a href="https://heartlovelife.github.io/">blog</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  æ•°æ®åº“åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div>
        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(r){r.imageLazyLoadSetting.processImages=t;var e=r.imageLazyLoadSetting.isSPA,n=r.imageLazyLoadSetting.preloadRatio||1,c=a();function a(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(){e&&(c=a());for(var t,o=0;o<c.length;o++)0<=(t=(t=c[o]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(r.innerHeight*n||document.documentElement.clientHeight*n)&&function(){var t,e,n,a,i=c[o];e=function(){c=c.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(n=new Image,a=t.getAttribute("data-original"),n.onload=function(){t.src=a,t.removeAttribute("data-original"),e&&e()},t.src!==a&&(n.src=a))}()}function i(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",i),r.addEventListener("resize",i),r.addEventListener("orientationchange",i)}(this);</script></body></html>