<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Python之Pandas详解 | 江湖是你画中亦是你</title><meta name="keywords" content="科学计算,数据分析,Pandas"><meta name="author" content="Xiaotangsmiles"><meta name="copyright" content="Xiaotangsmiles"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Pandas是Python语言的一个扩展程序库，用于数据分析。 Pandas是一个开放源码、BSD许可的库，提供高性能、易于使用的数据结构和数据分析工具。 Pandas名字衍生自术语 &quot;panel data&quot;（面板数据）和 &quot;Python data analysis&quot;（Python数据分析）。 Pandas一个强大的分析结构化数据的工具集，基础是NumPy（提供高性能的矩阵运算）。 Pan">
<meta property="og:type" content="article">
<meta property="og:title" content="Python之Pandas详解">
<meta property="og:url" content="https://heartlovelife.github.io/2023/03/07/Python-Pandas/index.html">
<meta property="og:site_name" content="江湖是你画中亦是你">
<meta property="og:description" content="Pandas是Python语言的一个扩展程序库，用于数据分析。 Pandas是一个开放源码、BSD许可的库，提供高性能、易于使用的数据结构和数据分析工具。 Pandas名字衍生自术语 &quot;panel data&quot;（面板数据）和 &quot;Python data analysis&quot;（Python数据分析）。 Pandas一个强大的分析结构化数据的工具集，基础是NumPy（提供高性能的矩阵运算）。 Pan">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2023/02/19/BiQTEHaJbYwIvhd.jpg">
<meta property="article:published_time" content="2023-03-07T13:43:43.000Z">
<meta property="article:modified_time" content="2024-06-10T07:45:02.371Z">
<meta property="article:author" content="Xiaotangsmiles">
<meta property="article:tag" content="科学计算">
<meta property="article:tag" content="数据分析">
<meta property="article:tag" content="Pandas">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2023/02/19/BiQTEHaJbYwIvhd.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://heartlovelife.github.io/2023/03/07/Python-Pandas/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":250},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Python之Pandas详解',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-06-10 15:45:02'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/loading1.gif" data-original="/img/touxiang.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">27</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">27</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><span> 博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/photos/"><span> 相册</span></a></li><li><a class="site-page child" href="/music/"><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><span> 影视</span></a></li><li><a class="site-page child" href="/shuoshuo/"><span> 分享</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://s2.loli.net/2023/02/19/BiQTEHaJbYwIvhd.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">江湖是你画中亦是你</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><span> 博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/photos/"><span> 相册</span></a></li><li><a class="site-page child" href="/music/"><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><span> 影视</span></a></li><li><a class="site-page child" href="/shuoshuo/"><span> 分享</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><span> 关于笔者</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Python之Pandas详解</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-03-07T13:43:43.000Z" title="发表于 2023-03-07 21:43:43">2023-03-07</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-06-10T07:45:02.371Z" title="更新于 2024-06-10 15:45:02">2024-06-10</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Python/">Python</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">19.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>81分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Python之Pandas详解"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p><strong><code>Pandas</code>是<code>Python</code>语言的一个扩展程序库，用于数据分析。</strong></p>
<p><code>Pandas</code>是一个开放源码、<code>BSD</code>许可的库，提供高性能、易于使用的数据结构和数据分析工具。</p>
<p><code>Pandas</code>名字衍生自术语 "<code>panel data</code>"（面板数据）和 "<code>Python data analysis</code>"（<code>Python</code>数据分析）。</p>
<p><code>Pandas</code>一个强大的分析结构化数据的工具集，基础是<code>NumPy</code>（提供高性能的矩阵运算）。</p>
<p><code>Pandas</code>可以从各种文件格式比如<code>CSV</code>、<code>JSON</code>、<code>SQL</code>、<code>Microsoft Excel</code> 导入数据。</p>
<p><code>Pandas</code>可以对各种数据进行运算操作，比如归并、再成形、选择，还有数据清洗和数据加工特征。</p>
<p><code>Pandas</code>广泛应用在学术、金融、统计学等各个数据分析领域。</p>
<p><code>Pandas</code>主要包括以下几个特点：</p>
<ul>
<li>它提供了一个简单、高效、带有默认标签（也可以自定义标签）的<code>DataFrame</code>对象。</li>
<li>能够快速从不同格式的文件中加载数据（比如 <code>Excel</code>、<code>CSV</code> 、<code>SQL</code>文件），然后转换为可处理的对象；</li>
<li>能够按数据的行、列标签进行分组，并对分组后的对象执行聚合和转换操作；</li>
<li>能够很方便地实现数据归一化操作和缺失值处理；</li>
<li>能够很方便地对<code>DataFrame</code>的数据列进行增加、修改或者删除的操作；</li>
<li>能够处理不同格式的数据集，比如矩阵数据、异构数据表、时间序列等；</li>
<li>提供了多种处理数据集的方式，比如构建子集、切片、过滤、分组以及重新排序等。</li>
</ul>
<h2 id="pandas数据结构">⛄Pandas数据结构</h2>
<p><code>Pandas</code>的主要数据结构是<code>Series</code>（一维数据）与<code>DataFrame</code>（二维数据），这两种数据结构足以处理金融、统计、社会科学、工程等领域里的大多数典型用例。</p>
<p><strong>Series</strong>是一种类似于一维数组的对象，它由一组数据（各种<code>Numpy</code>数据类型）以及一组与之相关的数据标签（即索引）组成。</p>
<p><strong>DataFrame</strong>是一个表格型的数据结构，它含有一组有序的列，每列可以是不同的值类型（数值、字符串、布尔型值）。<code>DataFrame</code>既有行索引也有列索引，它可以被看做由<code>Series</code>组成的字典（共同用一个索引）。</p>
<h2 id="pandas-series">⛄Pandas Series</h2>
<p><code>Pandas Series</code>类似表格中的一个列（<code>column</code>），类似于一维数组，由一组数据值（<code>value</code>）和一组标签组成，其中标签与数据值之间是一一对应的关系。<code>Series</code>可以保存任何数据类型，比如整数、字符串、浮点数、<code>Python</code>对象等，它的标签默认为整数，从0开始依次递增。</p>
<h3 id="创建series对象">👀创建Series对象</h3>
<p><code>Series</code>由索引（<code>index</code>）和列组成，函数如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pandas.Series(data, index, dtype, name, copy)</span><br><span class="line">参数说明：</span><br><span class="line">    data：一组数据(ndarray类型)。</span><br><span class="line">    index：数据索引标签，如果不指定，默认从<span class="number">0</span>开始。</span><br><span class="line">    dtype：数据类型，默认会自己判断。</span><br><span class="line">    name：设置名称。</span><br><span class="line">    copy：拷贝数据，默认为<span class="literal">False</span>。</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">myvar = pd.Series(a)</span><br><span class="line"><span class="built_in">print</span>(myvar)</span><br><span class="line"><span class="built_in">print</span>(myvar[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果：第一列为索引，第二列为数据</span></span><br><span class="line"><span class="comment"># 如果没有指定索引，索引值就从0开始，我们可以根据索引值读取数据：</span></span><br><span class="line"><span class="number">0</span>    <span class="number">1</span></span><br><span class="line"><span class="number">1</span>    <span class="number">2</span></span><br><span class="line"><span class="number">2</span>    <span class="number">3</span></span><br><span class="line">dtype: int64</span><br><span class="line"><span class="number">2</span></span><br></pre></td></tr></table></figure>
<p>我们也可以使用数组、字典、标量值或者<code>Python</code>对象来创建<code>Series</code>对象。</p>
<p>（1）创建一个空<code>Series</code>对象</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="comment">#输出数据为空</span></span><br><span class="line">s = pd.Series()</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">Series([], dtype: float64)</span><br></pre></td></tr></table></figure>
<p>（2）<code>ndarray</code>创建<code>Series</code>对象</p>
<p><code>ndarray</code>是<code>NumPy</code>中的数组类型，当<code>data</code>是<code>ndarry</code>时，传递的索引必须具有与数组相同的长度。如果没有指定索引（隐式索引)，索引值就从0开始（索引值将使用是<code>range(n)</code> 生成，其中n代表数组长度）；我们可以根据索引值读取数据。可以指定索引值（显式索引），如下实例。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定索引值</span></span><br><span class="line">a = np.array([<span class="string">&quot;Google&quot;</span>, <span class="string">&quot;Runoob&quot;</span>, <span class="string">&quot;Wiki&quot;</span>])</span><br><span class="line">myvar = pd.Series(a, index = [<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>, <span class="string">&quot;z&quot;</span>])</span><br><span class="line"><span class="built_in">print</span>(myvar)</span><br><span class="line"><span class="built_in">print</span>(myvar[<span class="string">&quot;y&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">#输出结果</span></span><br><span class="line">x    Google</span><br><span class="line">y    Runoob</span><br><span class="line">z      Wiki</span><br><span class="line">dtype: <span class="built_in">object</span></span><br><span class="line">Runoob</span><br></pre></td></tr></table></figure>
<p>（3）<code>dict</code>创建<code>Series</code>对象</p>
<p>我们也可以使用<code>key/value</code>对象，类似字典来创建<code>Series</code>：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用字典创建Series</span></span><br><span class="line"><span class="comment"># 没有传递索引，字典的key变成了索引值。</span></span><br><span class="line">sites = &#123;<span class="number">1</span>: <span class="string">&quot;Google&quot;</span>, <span class="number">2</span>: <span class="string">&quot;Runoob&quot;</span>, <span class="number">3</span>: <span class="string">&quot;Wiki&quot;</span>&#125;</span><br><span class="line">myvar1 = pd.Series(sites)</span><br><span class="line"><span class="built_in">print</span>(myvar1)</span><br><span class="line"><span class="comment"># 如果我们只需要字典中的一部分数据，只需要指定需要数据的索引即可，如下实例：</span></span><br><span class="line">myvar2 = pd.Series(sites, index = [<span class="number">1</span>,<span class="number">2</span>])</span><br><span class="line"><span class="built_in">print</span>(myvar2)</span><br><span class="line"><span class="comment"># 当传递的索引值无法找到与其对应的值时，使用NaN（非数字）填充。</span></span><br><span class="line">myvar3 = pd.Series(sites, index = [<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">4</span>])</span><br><span class="line"><span class="built_in">print</span>(myvar3)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line"><span class="number">1</span>    Google</span><br><span class="line"><span class="number">2</span>    Runoob</span><br><span class="line"><span class="number">3</span>      Wiki</span><br><span class="line">dtype: <span class="built_in">object</span></span><br><span class="line"><span class="number">1</span>    Google</span><br><span class="line"><span class="number">2</span>    Runoob</span><br><span class="line">dtype: <span class="built_in">object</span></span><br><span class="line"><span class="number">1</span>    Google</span><br><span class="line"><span class="number">3</span>      Wiki</span><br><span class="line"><span class="number">2</span>    Runoob</span><br><span class="line"><span class="number">4</span>       NaN</span><br><span class="line">dtype: <span class="built_in">object</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>当传递的索引值无法找到与其对应的值时，使用<code>NaN</code>（非数字）填充。</p>
</blockquote>
<p>（4）标量创建<code>Series</code>对象</p>
<p>如果<code>data</code>是标量值，则必须提供索引，示例如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">s = pd.Series(<span class="number">5</span>, index = [<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line"><span class="number">0</span>    <span class="number">5</span></span><br><span class="line"><span class="number">1</span>    <span class="number">5</span></span><br><span class="line"><span class="number">2</span>    <span class="number">5</span></span><br><span class="line"><span class="number">3</span>    <span class="number">5</span></span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<blockquote>
<p>标量值按照<code>index</code>的数量进行重复，并与其一一对应。</p>
</blockquote>
<p>设置<code>Series</code>名称参数：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">sites = &#123;<span class="number">1</span>: <span class="string">&quot;Google&quot;</span>, <span class="number">2</span>: <span class="string">&quot;Runoob&quot;</span>, <span class="number">3</span>: <span class="string">&quot;Wiki&quot;</span>&#125;</span><br><span class="line">myvar = pd.Series(sites, index = [<span class="number">1</span>, <span class="number">2</span>], name=<span class="string">&quot;RUNOOB-Series-TEST&quot;</span> )</span><br><span class="line"><span class="built_in">print</span>(myvar)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line"><span class="number">1</span>    Google</span><br><span class="line"><span class="number">2</span>    Runoob</span><br><span class="line">Name: RUNOOB-Series-TEST, dtype: <span class="built_in">object</span></span><br></pre></td></tr></table></figure>
<h3 id="访问series数据">👀访问Series数据</h3>
<p>（1）位置索引访问</p>
<p>这种访问方式与<code>ndarray</code>和<code>list</code>相同，使用元素自身的下标进行访问。我们知道数组的索引计数从0开始，这表示第一个元素存储在第0个索引位置上，以此类推，就可以获得<code>Series</code>序列中的每个元素。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">s = pd.Series([<span class="number">5</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>],index = [<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(s[<span class="number">0</span>])  	<span class="comment"># 位置下标</span></span><br><span class="line"><span class="built_in">print</span>(s[<span class="string">&#x27;a&#x27;</span>]) 	<span class="comment"># 标签下标</span></span><br><span class="line"><span class="comment"># 通过切片的方式访问Series序列中的数据</span></span><br><span class="line"><span class="built_in">print</span>(s[:<span class="number">3</span>])</span><br><span class="line"><span class="comment"># 获取最后三个元素</span></span><br><span class="line"><span class="built_in">print</span>(s[-<span class="number">3</span>:])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line">a    <span class="number">5</span></span><br><span class="line">b    <span class="number">2</span></span><br><span class="line">c    <span class="number">3</span></span><br><span class="line">dtype: int64</span><br><span class="line">c    <span class="number">3</span></span><br><span class="line">d    <span class="number">4</span></span><br><span class="line">e    <span class="number">5</span></span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<p>（2）索引标签访问</p>
<p><code>Series</code>类似于固定大小的<code>dict</code>，把<code>index</code>中的索引标签当做<code>key</code>，而把<code>Series</code>序列中的元素值当做<code>value</code>，然后通过<code>index</code>索引标签来访问或者修改元素值。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="comment"># 使用索标签访问单个元素值</span></span><br><span class="line">s = pd.Series([<span class="number">16</span>,<span class="number">17</span>,<span class="number">18</span>,<span class="number">19</span>,<span class="number">20</span>],index = [<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(s[<span class="string">&#x27;a&#x27;</span>])</span><br><span class="line"><span class="comment"># 使用索引标签访问多个元素值</span></span><br><span class="line"><span class="built_in">print</span>(s[[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>]])</span><br><span class="line"><span class="comment"># 如果使用了index中不包含的标签，则会触发异常</span></span><br><span class="line"><span class="built_in">print</span>(s[<span class="string">&#x27;f&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line"><span class="number">16</span></span><br><span class="line">a    <span class="number">16</span></span><br><span class="line">c    <span class="number">18</span></span><br><span class="line">d    <span class="number">19</span></span><br><span class="line">dtype: int64</span><br><span class="line">......</span><br><span class="line">KeyError: <span class="string">&#x27;f&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="series常用属性">👀Series常用属性</h3>
<p><code>Series</code>的常用属性和方法：</p>
<table>
<thead>
<tr class="header">
<th>名称</th>
<th>属性</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>axes</code></td>
<td>以列表的形式返回所有行索引标签</td>
</tr>
<tr class="even">
<td><code>dtype</code></td>
<td>返回对象的数据类型</td>
</tr>
<tr class="odd">
<td><code>empty</code></td>
<td>返回一个空的<code>Series</code>对象</td>
</tr>
<tr class="even">
<td><code>ndim</code></td>
<td>返回输入数据的维数</td>
</tr>
<tr class="odd">
<td><code>size</code></td>
<td>返回输入数据的元素数量</td>
</tr>
<tr class="even">
<td><code>values</code></td>
<td>以<code>ndarray</code>的形式返回<code>Series</code>对象</td>
</tr>
<tr class="odd">
<td><code>index</code></td>
<td>返回一个<code>RangeIndex</code>对象，用来描述索引的取值范围</td>
</tr>
</tbody>
</table>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">s = pd.Series(np.random.randn(<span class="number">6</span>))</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># axes属性</span></span><br><span class="line"><span class="built_in">print</span>(s.axes)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># dtype属性</span></span><br><span class="line"><span class="built_in">print</span>(s.dtype)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># empty</span></span><br><span class="line"><span class="built_in">print</span>(s.empty)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># ndim，Series是一维数据结构，因此它始终返回1</span></span><br><span class="line"><span class="built_in">print</span>(s.ndim)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># size返回Series对象的大小(长度)</span></span><br><span class="line"><span class="built_in">print</span>(s.size)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># value以数组的形式返回Series对象中的数据</span></span><br><span class="line"><span class="built_in">print</span>(s.values)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># index该属性用来查看Series中索引的取值范围</span></span><br><span class="line"><span class="comment">#显示索引</span></span><br><span class="line">s1 = pd.Series([<span class="number">1</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">8</span>],index = [<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(s1.index)</span><br><span class="line"><span class="comment">#隐式索引</span></span><br><span class="line">s2 = pd.Series([<span class="number">1</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">8</span>])</span><br><span class="line"><span class="built_in">print</span>(s2.index)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line"><span class="number">0</span>   -<span class="number">0.674501</span></span><br><span class="line"><span class="number">1</span>    <span class="number">1.030106</span></span><br><span class="line"><span class="number">2</span>   -<span class="number">1.636359</span></span><br><span class="line"><span class="number">3</span>   -<span class="number">1.540996</span></span><br><span class="line"><span class="number">4</span>    <span class="number">1.312837</span></span><br><span class="line"><span class="number">5</span>   -<span class="number">0.735986</span></span><br><span class="line">dtype: float64</span><br><span class="line">********************</span><br><span class="line">[RangeIndex(start=<span class="number">0</span>, stop=<span class="number">6</span>, step=<span class="number">1</span>)]</span><br><span class="line">********************</span><br><span class="line">float64</span><br><span class="line">********************</span><br><span class="line"><span class="literal">False</span></span><br><span class="line">********************</span><br><span class="line"><span class="number">1</span></span><br><span class="line">********************</span><br><span class="line"><span class="number">6</span></span><br><span class="line">********************</span><br><span class="line">[-<span class="number">0.67450078</span>  <span class="number">1.03010573</span> -<span class="number">1.63635856</span> -<span class="number">1.54099596</span>  <span class="number">1.31283698</span> -<span class="number">0.73598645</span>]</span><br><span class="line">********************</span><br><span class="line">Index([<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], dtype=<span class="string">&#x27;object&#x27;</span>)</span><br><span class="line">RangeIndex(start=<span class="number">0</span>, stop=<span class="number">4</span>, step=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<h3 id="series常用方法">👀Series常用方法</h3>
<p>（1）<code>head()</code>&amp;<code>tail()</code>查看数据</p>
<p>如果想要查看<code>Series</code>的某一部分数据，可以使用<code>head()</code>或者tail()方法。其中<code>head()</code>返回前n行数据，默认显示前5行数据。<code>tail()</code>返回的是后n行数据，默认为后5行。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">s = pd.Series(np.random.randn(<span class="number">5</span>))</span><br><span class="line"><span class="built_in">print</span> (s)</span><br><span class="line"><span class="comment"># 返回前三行数据</span></span><br><span class="line"><span class="built_in">print</span>(s.head(<span class="number">3</span>))</span><br><span class="line"><span class="comment"># 返回后两行数据</span></span><br><span class="line"><span class="built_in">print</span>(s.tail(<span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line"><span class="number">0</span>   -<span class="number">0.264915</span></span><br><span class="line"><span class="number">1</span>   -<span class="number">1.120671</span></span><br><span class="line"><span class="number">2</span>    <span class="number">0.621638</span></span><br><span class="line"><span class="number">3</span>   -<span class="number">0.449170</span></span><br><span class="line"><span class="number">4</span>    <span class="number">0.533876</span></span><br><span class="line">dtype: float64</span><br><span class="line"><span class="number">0</span>   -<span class="number">0.264915</span></span><br><span class="line"><span class="number">1</span>   -<span class="number">1.120671</span></span><br><span class="line"><span class="number">2</span>    <span class="number">0.621638</span></span><br><span class="line">dtype: float64</span><br><span class="line"><span class="number">2</span>    <span class="number">0.621638</span></span><br><span class="line"><span class="number">3</span>   -<span class="number">0.449170</span></span><br><span class="line"><span class="number">4</span>    <span class="number">0.533876</span></span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure>
<p>（2）<code>isnull()</code>&amp;<code>notnull()</code>检测缺失值</p>
<p><code>isnull()</code>和<code>notnull()</code>用于检测<code>Series</code>中的缺失值。所谓缺失值，顾名思义就是值不存在、丢失、缺少。</p>
<ul>
<li><code>isnull()</code>：如果为值不存在或者缺失，则返回<code>True</code>。</li>
<li><code>notnull()</code>：如果值不存在或者缺失，则返回<code>False</code>。</li>
</ul>
<p>其实不难理解，在实际的数据分析任物中，数据的收集往往要经历一个繁琐的过程。在这个过程中难免会因为一些不可抗力，或者人为因素导致数据丢失的现象。这时，我们可以使用相应的方法对缺失值进行处理，比如均值插值、数据补齐等方法。上述两个方法就是帮助我们检测是否存在缺失值。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="comment">#None代表缺失数据</span></span><br><span class="line">s = pd.Series([<span class="number">1</span>,<span class="number">6</span>,<span class="literal">None</span>,<span class="number">8</span>,<span class="literal">None</span>])</span><br><span class="line"><span class="built_in">print</span>(pd.isnull(s))  <span class="comment">#是空值返回True</span></span><br><span class="line"><span class="built_in">print</span>(pd.notnull(s)) <span class="comment">#空值返回False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line"><span class="number">0</span>    <span class="literal">False</span></span><br><span class="line"><span class="number">1</span>    <span class="literal">False</span></span><br><span class="line"><span class="number">2</span>     <span class="literal">True</span></span><br><span class="line"><span class="number">3</span>    <span class="literal">False</span></span><br><span class="line"><span class="number">4</span>     <span class="literal">True</span></span><br><span class="line">dtype: <span class="built_in">bool</span></span><br><span class="line"><span class="number">0</span>     <span class="literal">True</span></span><br><span class="line"><span class="number">1</span>     <span class="literal">True</span></span><br><span class="line"><span class="number">2</span>    <span class="literal">False</span></span><br><span class="line"><span class="number">3</span>     <span class="literal">True</span></span><br><span class="line"><span class="number">4</span>    <span class="literal">False</span></span><br><span class="line">dtype: <span class="built_in">bool</span></span><br></pre></td></tr></table></figure>
<h2 id="pandas-dataframe">⛄Pandas DataFrame</h2>
<p><code>DataFrame</code>是表格型的数据结构，既有行标签（<code>index</code>），又有列标签（<code>columns</code>），它也被称异构数据表。</p>
<p>它含有一组有序的列，每列可以是不同的值类型（数值、字符串、布尔型值）。<code>DataFrame</code>既有<strong>行索引</strong>也有<strong>列索引</strong>，它可以被看做由<code>Series</code>组成的字典（共同用一个索引），每一行数据都可以看成一个<code>Series</code>结构，<code>DataFrame</code>为这些行中每个数据值增加了一个列标签。</p>
<p>同<code>Series</code>一样，<code>DataFrame</code>自带行标签索引，默认为“隐式索引”即从0开始依次递增，行标签与<code>DataFrame</code>中的数据项一一对应。<code>DataFrame</code>数据结构的特点：</p>
<ul>
<li><code>DataFrame</code>每一列的标签值允许使用不同的数据类型；</li>
<li><code>DataFrame</code>是表格型的数据结构，具有行和列；</li>
<li><code>DataFrame</code>中的每个数据值都可以被修改；</li>
<li><code>DataFrame</code>结构的行数、列数允许增加或者删除；</li>
<li><code>DataFrame</code>有两个方向的标签轴，分别是行标签和列标签；</li>
<li><code>DataFrame</code>可以对行和列执行算术运算。</li>
</ul>
<h3 id="创建df对象">👀创建DF对象</h3>
<p><code>DataFrame</code>构造方法如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pandas.DataFrame(data, index, columns, dtype, copy)</span><br><span class="line">参数说明：</span><br><span class="line">    data：一组数据(ndarray、series, <span class="built_in">map</span>, lists, <span class="built_in">dict</span>等类型)。</span><br><span class="line">    index：索引值，或者可以称为行标签。</span><br><span class="line">    columns：列标签，默认为RangeIndex(<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, …, n) 。</span><br><span class="line">    dtype：数据类型。</span><br><span class="line">    copy：拷贝数据，默认为<span class="literal">False</span>。</span><br></pre></td></tr></table></figure>
<p><code>Pandas DataFrame</code>是一个二维的数组结构，类似二维数组。</p>
<p><code>Pandas</code>提供了多种创建<code>DataFrame</code>对象的方式，主要包含以下五种：</p>
<p>（1）创建空的<code>DataFrame</code>对象</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">df = pd.DataFrame()</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">Empty DataFrame</span><br><span class="line">Columns: []</span><br><span class="line">Index: []</span><br></pre></td></tr></table></figure>
<p>（2）列表创建<code>DataFame</code>对象</p>
<p>可以使用单一列表或嵌套列表来创建一个<code>DataFrame</code>。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 单一列表创建DataFrame对象</span></span><br><span class="line">data1 = [<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>]</span><br><span class="line">df1 = pd.DataFrame(data1)</span><br><span class="line"><span class="built_in">print</span>(df1)</span><br><span class="line"><span class="comment"># 嵌套列表创建DataFrame对象，并指定数值元素的数据类型为float</span></span><br><span class="line">data2 = [[<span class="string">&#x27;Google&#x27;</span>,<span class="number">10</span>],[<span class="string">&#x27;Runoob&#x27;</span>,<span class="number">12</span>],[<span class="string">&#x27;Wiki&#x27;</span>,<span class="number">13</span>]]</span><br><span class="line">df2 = pd.DataFrame(data2,columns = [<span class="string">&#x27;Site&#x27;</span>,<span class="string">&#x27;Age&#x27;</span>],dtype = <span class="built_in">float</span>)</span><br><span class="line"><span class="built_in">print</span>(df2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">    <span class="number">0</span></span><br><span class="line"><span class="number">0</span>   <span class="number">6</span></span><br><span class="line"><span class="number">1</span>   <span class="number">7</span></span><br><span class="line"><span class="number">2</span>   <span class="number">8</span></span><br><span class="line"><span class="number">3</span>   <span class="number">9</span></span><br><span class="line"><span class="number">4</span>  <span class="number">10</span></span><br><span class="line">     Site   Age</span><br><span class="line"><span class="number">0</span>  Google  <span class="number">10.0</span></span><br><span class="line"><span class="number">1</span>  Runoob  <span class="number">12.0</span></span><br><span class="line"><span class="number">2</span>    Wiki  <span class="number">13.0</span></span><br></pre></td></tr></table></figure>
<p>（3）字典嵌套列表创建<code>DataFame</code>对象</p>
<p><code>dict</code>字典中，键对应的值的元素长度必须相同（也就是列表长度相同）。如果传递了索引，那么索引的长度应该等于数组的长度；如果没有传递索引，那么默认情况下，索引将是<code>range(n)</code>，其中n代表数组长度。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 这里使用了默认行标签，也就是range(n)。它生成了0,1,2,3，并分别对应了列表中的每个元素值</span></span><br><span class="line">data = &#123;<span class="string">&#x27;Site&#x27;</span>:[<span class="string">&#x27;Google&#x27;</span>, <span class="string">&#x27;Runoob&#x27;</span>, <span class="string">&#x27;Wiki&#x27;</span>], <span class="string">&#x27;Age&#x27;</span>:[<span class="number">10</span>, <span class="number">12</span>, <span class="number">13</span>]&#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="comment"># 添加自定义的行标签,index参数为每行分配了一个索引</span></span><br><span class="line">df2 = pd.DataFrame(data,index = [<span class="string">&#x27;one&#x27;</span>,<span class="string">&#x27;two&#x27;</span>,<span class="string">&#x27;three&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">     Site  Age</span><br><span class="line"><span class="number">0</span>  Google   <span class="number">10</span></span><br><span class="line"><span class="number">1</span>  Runoob   <span class="number">12</span></span><br><span class="line"><span class="number">2</span>    Wiki   <span class="number">13</span></span><br><span class="line">         Site  Age</span><br><span class="line">one    Google   <span class="number">10</span></span><br><span class="line">two    Runoob   <span class="number">12</span></span><br><span class="line">three    Wiki   <span class="number">13</span></span><br></pre></td></tr></table></figure>
<p>从以上输出结果可以知道， <code>DataFrame</code>数据类型一个表格，包含<code>rows</code>（行）和<code>columns</code>（列）。</p>
<p>（4）列表嵌套字典创建<code>DataFrame</code>对象</p>
<p>列表嵌套字典可以作为输入数据传递给<code>DataFrame</code>构造函数。默认情况下，字典的键被用作列名。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 列表嵌套字典</span></span><br><span class="line">data1 = [&#123;<span class="string">&#x27;a&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">2</span>&#125;, &#123;<span class="string">&#x27;a&#x27;</span>: <span class="number">5</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">10</span>, <span class="string">&#x27;c&#x27;</span>: <span class="number">20</span>&#125;]</span><br><span class="line"><span class="comment"># 字典嵌套列表</span></span><br><span class="line">data2 = &#123;<span class="string">&#x27;a&#x27;</span>:[<span class="number">1</span>, <span class="number">5</span>], <span class="string">&#x27;b&#x27;</span>:[<span class="number">2</span>, <span class="number">10</span>], <span class="string">&#x27;c&#x27;</span>:[<span class="number">15</span>, <span class="number">20</span>]&#125;</span><br><span class="line">df1 = pd.DataFrame(data1)</span><br><span class="line"><span class="built_in">print</span>(df1)</span><br><span class="line">df2 = pd.DataFrame(data2)</span><br><span class="line"><span class="built_in">print</span>(df2)</span><br><span class="line"><span class="comment"># 添加行标签索引</span></span><br><span class="line">df3 = pd.DataFrame(data1,index = [<span class="string">&#x27;one&#x27;</span>,<span class="string">&#x27;two&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df3)</span><br><span class="line"><span class="comment"># 行标签索引</span></span><br><span class="line"><span class="comment"># 注意：因为&#x27;abc&#x27;在字典键中不存在，所以对应值为NaN</span></span><br><span class="line">df4 = pd.DataFrame(data1,index = [<span class="string">&#x27;one&#x27;</span>,<span class="string">&#x27;two&#x27;</span>],columns = [<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;abc&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df4)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果，没有对应的部分数据为NaN。</span></span><br><span class="line">   a   b     c</span><br><span class="line"><span class="number">0</span>  <span class="number">1</span>   <span class="number">2</span>   NaN</span><br><span class="line"><span class="number">1</span>  <span class="number">5</span>  <span class="number">10</span>  <span class="number">20.0</span></span><br><span class="line">   a   b   c</span><br><span class="line"><span class="number">0</span>  <span class="number">1</span>   <span class="number">2</span>  <span class="number">15</span></span><br><span class="line"><span class="number">1</span>  <span class="number">5</span>  <span class="number">10</span>  <span class="number">20</span></span><br><span class="line">     a   b     c</span><br><span class="line">one  <span class="number">1</span>   <span class="number">2</span>   NaN</span><br><span class="line">two  <span class="number">5</span>  <span class="number">10</span>  <span class="number">20.0</span></span><br><span class="line">     a  abc</span><br><span class="line">one  <span class="number">1</span>  NaN</span><br><span class="line">two  <span class="number">5</span>  NaN</span><br></pre></td></tr></table></figure>
<p>（5）<code>Series</code>创建<code>DataFrame</code>对象</p>
<p>可以传递一个字典形式的<code>Series</code>，从而创建一个<code>DataFrame</code>对象，其输出结果的行索引是所有index的合集。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">d = &#123;<span class="string">&#x27;one&#x27;</span> : pd.Series([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], index = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>]),</span><br><span class="line">   <span class="string">&#x27;two&#x27;</span> : pd.Series([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], index = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>])&#125;</span><br><span class="line">df = pd.DataFrame(d)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果，对于one列而言，此处虽然显示了行索引&#x27;d&#x27;，但由于没有与其对应的值，所以它的值为NaN</span></span><br><span class="line">   one  two</span><br><span class="line">a  <span class="number">1.0</span>    <span class="number">1</span></span><br><span class="line">b  <span class="number">2.0</span>    <span class="number">2</span></span><br><span class="line">c  <span class="number">3.0</span>    <span class="number">3</span></span><br><span class="line">d  NaN    <span class="number">4</span></span><br></pre></td></tr></table></figure>
<h3 id="列索引操作df对象">👀列索引操作DF对象</h3>
<p><code>DataFrame</code>可以使用列索（<code>columns index</code>）引来完成数据的选取、添加和删除操作。</p>
<p>（1）列索引选取数据列</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">  <span class="string">&quot;calories&quot;</span>: [<span class="number">420</span>, <span class="number">380</span>, <span class="number">390</span>],</span><br><span class="line">  <span class="string">&quot;duration&quot;</span>: [<span class="number">50</span>, <span class="number">40</span>, <span class="number">45</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 数据载入到DataFrame对象</span></span><br><span class="line">df = pd.DataFrame(data, index = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="comment"># 返回第一列 </span></span><br><span class="line"><span class="built_in">print</span>(df[<span class="string">&#x27;calories&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">   calories  duration</span><br><span class="line">a       <span class="number">420</span>        <span class="number">50</span></span><br><span class="line">b       <span class="number">380</span>        <span class="number">40</span></span><br><span class="line">c       <span class="number">390</span>        <span class="number">45</span></span><br><span class="line">a    <span class="number">420</span></span><br><span class="line">b    <span class="number">380</span></span><br><span class="line">c    <span class="number">390</span></span><br><span class="line">Name: calories, dtype: int64</span><br></pre></td></tr></table></figure>
<p>（2）列索引添加数据列</p>
<p>使用<code>columns</code>列索引表标签可以实现添加新的数据列。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">  <span class="string">&quot;calories&quot;</span>: [<span class="number">420</span>, <span class="number">380</span>, <span class="number">390</span>],</span><br><span class="line">  <span class="string">&quot;duration&quot;</span>: [<span class="number">50</span>, <span class="number">40</span>, <span class="number">45</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 数据载入到DataFrame对象</span></span><br><span class="line">df = pd.DataFrame(data, index = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="comment"># 返回第一列 </span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 使用df[&#x27;列&#x27;]=值，插入新的数据列</span></span><br><span class="line">df[<span class="string">&#x27;height&#x27;</span>] = pd.Series([<span class="number">160</span>,<span class="number">170</span>,<span class="number">180</span>], index = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 将已经存在的数据列做相加运算</span></span><br><span class="line">df[<span class="string">&#x27;sums&#x27;</span>] = df[<span class="string">&#x27;calories&#x27;</span>] + df[<span class="string">&#x27;duration&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">   calories  duration</span><br><span class="line">a       <span class="number">420</span>        <span class="number">50</span></span><br><span class="line">b       <span class="number">380</span>        <span class="number">40</span></span><br><span class="line">c       <span class="number">390</span>        <span class="number">45</span></span><br><span class="line">********************</span><br><span class="line">   calories  duration  height</span><br><span class="line">a       <span class="number">420</span>        <span class="number">50</span>     <span class="number">160</span></span><br><span class="line">b       <span class="number">380</span>        <span class="number">40</span>     <span class="number">170</span></span><br><span class="line">c       <span class="number">390</span>        <span class="number">45</span>     <span class="number">180</span></span><br><span class="line">********************</span><br><span class="line">   calories  duration  height  sums</span><br><span class="line">a       <span class="number">420</span>        <span class="number">50</span>     <span class="number">160</span>  <span class="number">470</span></span><br><span class="line">b       <span class="number">380</span>        <span class="number">40</span>     <span class="number">170</span>  <span class="number">420</span></span><br><span class="line">c       <span class="number">390</span>        <span class="number">45</span>     <span class="number">180</span>  <span class="number">435</span></span><br></pre></td></tr></table></figure>
<p>我们初次使用了<code>DataFrame</code>的算术运算，这和<code>NumPy</code>非常相似。除了使用<code>df[]=value</code>的方式外，您还可以使用<code>insert()</code>方法插入新的列.</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">info = [[<span class="string">&#x27;Jack&#x27;</span>,<span class="number">18</span>],[<span class="string">&#x27;Helen&#x27;</span>,<span class="number">19</span>],[<span class="string">&#x27;John&#x27;</span>,<span class="number">17</span>]]</span><br><span class="line">df = pd.DataFrame(info,columns = [<span class="string">&#x27;name&#x27;</span>,<span class="string">&#x27;age&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="comment"># 注意是column参数</span></span><br><span class="line"><span class="comment"># 数值1代表插入到columns列表的索引位置</span></span><br><span class="line">df.insert(<span class="number">1</span>,column = <span class="string">&#x27;score&#x27;</span>,value = [<span class="number">91</span>,<span class="number">90</span>,<span class="number">75</span>])</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">    name  age</span><br><span class="line"><span class="number">0</span>   Jack   <span class="number">18</span></span><br><span class="line"><span class="number">1</span>  Helen   <span class="number">19</span></span><br><span class="line"><span class="number">2</span>   John   <span class="number">17</span></span><br><span class="line">    name  score  age</span><br><span class="line"><span class="number">0</span>   Jack     <span class="number">91</span>   <span class="number">18</span></span><br><span class="line"><span class="number">1</span>  Helen     <span class="number">90</span>   <span class="number">19</span></span><br><span class="line"><span class="number">2</span>   John     <span class="number">75</span>   <span class="number">17</span></span><br></pre></td></tr></table></figure>
<p>（3）列索引删除数据列</p>
<p>通过<code>del</code>和<code>pop()</code>都能够删除<code>DataFrame</code>中的数据列。示例如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">d = &#123;<span class="string">&#x27;one&#x27;</span>: pd.Series([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], index = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>]),</span><br><span class="line">   <span class="string">&#x27;two&#x27;</span>: pd.Series([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], index = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>]),</span><br><span class="line">   <span class="string">&#x27;three&#x27;</span>: pd.Series([<span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span>], index = [<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>])&#125;</span><br><span class="line">df = pd.DataFrame(d)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 使用del删除</span></span><br><span class="line"><span class="keyword">del</span> df[<span class="string">&#x27;one&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 使用pop方法删除</span></span><br><span class="line">df.pop(<span class="string">&#x27;two&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">   one  two  three</span><br><span class="line">a  <span class="number">1.0</span>    <span class="number">1</span>   <span class="number">10.0</span></span><br><span class="line">b  <span class="number">2.0</span>    <span class="number">2</span>   <span class="number">20.0</span></span><br><span class="line">c  <span class="number">3.0</span>    <span class="number">3</span>   <span class="number">30.0</span></span><br><span class="line">d  NaN    <span class="number">4</span>    NaN</span><br><span class="line">********************</span><br><span class="line">   two  three</span><br><span class="line">a    <span class="number">1</span>   <span class="number">10.0</span></span><br><span class="line">b    <span class="number">2</span>   <span class="number">20.0</span></span><br><span class="line">c    <span class="number">3</span>   <span class="number">30.0</span></span><br><span class="line">d    <span class="number">4</span>    NaN</span><br><span class="line">********************</span><br><span class="line">   three</span><br><span class="line">a   <span class="number">10.0</span></span><br><span class="line">b   <span class="number">20.0</span></span><br><span class="line">c   <span class="number">30.0</span></span><br><span class="line">d    NaN</span><br></pre></td></tr></table></figure>
<h3 id="行索引操作df对象">👀行索引操作DF对象</h3>
<p><code>Pandas</code>可以使用<code>loc</code>函数返回指定行的数据，如果没有设置索引，第一行索引为0，第二行索引为1，以此类推。</p>
<p>（1）标签索引选取</p>
<p>通过将行标签传递给<code>loc</code>函数，来选取数据。</p>
<p><code>loc</code>允许接两个参数分别是行和列，参数之间需要使用“逗号”隔开，但该函数只能接收<strong>标签索引</strong>。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">  <span class="string">&quot;calories&quot;</span>: [<span class="number">420</span>, <span class="number">380</span>, <span class="number">390</span>],</span><br><span class="line">  <span class="string">&quot;duration&quot;</span>: [<span class="number">50</span>, <span class="number">40</span>, <span class="number">45</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 数据载入到 DataFrame 对象</span></span><br><span class="line">df = pd.DataFrame(data, index = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="built_in">print</span>(df.loc[<span class="string">&#x27;a&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">   calories  duration</span><br><span class="line">a       <span class="number">420</span>        <span class="number">50</span></span><br><span class="line">b       <span class="number">380</span>        <span class="number">40</span></span><br><span class="line">c       <span class="number">390</span>        <span class="number">45</span></span><br><span class="line">********************</span><br><span class="line">calories    <span class="number">420</span></span><br><span class="line">duration     <span class="number">50</span></span><br><span class="line">Name: a, dtype: int64</span><br></pre></td></tr></table></figure>
<p>（2）整数索引选取</p>
<p>通过将数据行所在的索引位置传递给<code>iloc</code>函数，也可以实现数据行选取。</p>
<p><code>iloc</code>允许接受两个参数分别是行和列，参数之间使用“逗号”隔开，但该函数只能接收<strong>整数索引</strong>。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">  <span class="string">&quot;calories&quot;</span>: [<span class="number">420</span>, <span class="number">380</span>, <span class="number">390</span>],</span><br><span class="line">  <span class="string">&quot;duration&quot;</span>: [<span class="number">50</span>, <span class="number">40</span>, <span class="number">45</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 数据载入到 DataFrame 对象</span></span><br><span class="line">df = pd.DataFrame(data, index = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 返回第一行，返回结果其实就是一个Pandas Series数据。</span></span><br><span class="line"><span class="built_in">print</span>(df.iloc[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 返回第二行，返回结果其实就是一个Pandas Series数据。</span></span><br><span class="line"><span class="built_in">print</span>(df.iloc[<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 也可以返回多行数据，使用[[ ... ]] 格式，... 为各行的索引，以逗号隔开：</span></span><br><span class="line"><span class="comment"># 返回第一行和第二行，返回结果其实就是一个Pandas DataFrame数据。</span></span><br><span class="line"><span class="built_in">print</span>(df.iloc[[<span class="number">0</span>, <span class="number">1</span>]])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">   calories  duration</span><br><span class="line">a       <span class="number">420</span>        <span class="number">50</span></span><br><span class="line">b       <span class="number">380</span>        <span class="number">40</span></span><br><span class="line">c       <span class="number">390</span>        <span class="number">45</span></span><br><span class="line">********************</span><br><span class="line">calories    <span class="number">420</span></span><br><span class="line">duration     <span class="number">50</span></span><br><span class="line">Name: a, dtype: int64</span><br><span class="line">********************</span><br><span class="line">calories    <span class="number">380</span></span><br><span class="line">duration     <span class="number">40</span></span><br><span class="line">Name: b, dtype: int64</span><br><span class="line">********************</span><br><span class="line">   calories  duration</span><br><span class="line">a       <span class="number">420</span>        <span class="number">50</span></span><br><span class="line">b       <span class="number">380</span>        <span class="number">40</span></span><br></pre></td></tr></table></figure>
<p>（3）切片操作多行数据</p>
<p>通过使用切片的方式同时选取多行。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">  <span class="string">&quot;calories&quot;</span>: [<span class="number">420</span>, <span class="number">380</span>, <span class="number">390</span>],</span><br><span class="line">  <span class="string">&quot;duration&quot;</span>: [<span class="number">50</span>, <span class="number">40</span>, <span class="number">45</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 数据载入到 DataFrame 对象</span></span><br><span class="line">df = pd.DataFrame(data, index = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 左闭右开</span></span><br><span class="line"><span class="built_in">print</span>(df[<span class="number">1</span>:<span class="number">3</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">   calories  duration</span><br><span class="line">a       <span class="number">420</span>        <span class="number">50</span></span><br><span class="line">b       <span class="number">380</span>        <span class="number">40</span></span><br><span class="line">c       <span class="number">390</span>        <span class="number">45</span></span><br><span class="line">********************</span><br><span class="line">   calories  duration</span><br><span class="line">b       <span class="number">380</span>        <span class="number">40</span></span><br><span class="line">c       <span class="number">390</span>        <span class="number">45</span></span><br></pre></td></tr></table></figure>
<p>（4）添加数据行</p>
<p>使用<code>append()</code>函数，可以将新的数据行添加到<code>DataFrame</code>中，该函数会在行末追加数据行。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">df = pd.DataFrame([[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>]], index = [<span class="string">&#x27;one&#x27;</span>,<span class="string">&#x27;two&#x27;</span>], columns = [<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>])</span><br><span class="line">df2 = pd.DataFrame([[<span class="number">5</span>, <span class="number">6</span>], [<span class="number">7</span>, <span class="number">8</span>]], index = [<span class="string">&#x27;one&#x27;</span>,<span class="string">&#x27;two&#x27;</span>], columns = [<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>])</span><br><span class="line"><span class="comment"># 在行末追加新数据行</span></span><br><span class="line">df = df.append(df2)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">     a  b</span><br><span class="line">one  <span class="number">1</span>  <span class="number">2</span></span><br><span class="line">two  <span class="number">3</span>  <span class="number">4</span></span><br><span class="line">one  <span class="number">5</span>  <span class="number">6</span></span><br><span class="line">two  <span class="number">7</span>  <span class="number">8</span></span><br></pre></td></tr></table></figure>
<p>（5）删除数据行</p>
<p>使用行索引标签，从<code>DataFrame</code>中删除某一行数据。如果索引标签存在重复，那么它们将被一起删除。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">df = pd.DataFrame([[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>]], index = [<span class="string">&#x27;one&#x27;</span>,<span class="string">&#x27;two&#x27;</span>], columns = [<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>])</span><br><span class="line">df2 = pd.DataFrame([[<span class="number">5</span>, <span class="number">6</span>], [<span class="number">7</span>, <span class="number">8</span>]], index = [<span class="string">&#x27;one&#x27;</span>,<span class="string">&#x27;two&#x27;</span>], columns = [<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>])</span><br><span class="line"><span class="comment"># 在行末追加新数据行</span></span><br><span class="line">df = df.append(df2)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 注意此处调用了drop()方法,drop(&#x27;one&#x27;)同时删除了两行数据</span></span><br><span class="line">df1 = df.drop(<span class="string">&#x27;one&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">     a  b</span><br><span class="line">one  <span class="number">1</span>  <span class="number">2</span></span><br><span class="line">two  <span class="number">3</span>  <span class="number">4</span></span><br><span class="line">one  <span class="number">5</span>  <span class="number">6</span></span><br><span class="line">two  <span class="number">7</span>  <span class="number">8</span></span><br><span class="line">********************</span><br><span class="line">     a  b</span><br><span class="line">two  <span class="number">3</span>  <span class="number">4</span></span><br><span class="line">two  <span class="number">7</span>  <span class="number">8</span></span><br></pre></td></tr></table></figure>
<h3 id="df对象属性和方法">👀DF对象属性和方法</h3>
<p><code>DataFrame</code>的属性和方法，与Series相差无几。</p>
<table>
<thead>
<tr class="header">
<th>名称</th>
<th>属性方法描述</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>T</code></td>
<td>行和列转置</td>
</tr>
<tr class="even">
<td><code>axes</code></td>
<td>返回一个仅以行轴标签和列轴标签为成员的列表</td>
</tr>
<tr class="odd">
<td><code>dtypes</code></td>
<td>返回每列数据的数据类型</td>
</tr>
<tr class="even">
<td><code>empty</code></td>
<td><code>DataFrame</code>中没有数据或者任意坐标轴的长度为0，则返回True</td>
</tr>
<tr class="odd">
<td><code>ndim</code></td>
<td>轴的数量，也指数组的维数。</td>
</tr>
<tr class="even">
<td><code>shape</code></td>
<td>返回一个元组，表示了<code>DataFrame</code>维度</td>
</tr>
<tr class="odd">
<td><code>size</code></td>
<td><code>DataFrame</code>中的元素数量</td>
</tr>
<tr class="even">
<td><code>values</code></td>
<td>使用<code>numpy</code>数组表示<code>DataFrame</code>中的元素值</td>
</tr>
<tr class="odd">
<td><code>head()</code></td>
<td>返回前n行数据</td>
</tr>
<tr class="even">
<td><code>tail()</code></td>
<td>返回后n行数据</td>
</tr>
<tr class="odd">
<td><code>shift()</code></td>
<td>将行或列移动指定的步幅长度</td>
</tr>
</tbody>
</table>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">d = &#123;<span class="string">&#x27;Name&#x27;</span>:pd.Series([<span class="string">&#x27;小汤&#x27;</span>,<span class="string">&#x27;小王&#x27;</span>,<span class="string">&quot;小明&quot;</span>,<span class="string">&#x27;小红&#x27;</span>,<span class="string">&#x27;小小&#x27;</span>,<span class="string">&#x27;小微&#x27;</span>,<span class="string">&#x27;小黄&#x27;</span>]),</span><br><span class="line">   <span class="string">&#x27;years&#x27;</span>:pd.Series([<span class="number">2005</span>,<span class="number">2006</span>,<span class="number">2015</span>,<span class="number">2008</span>,<span class="number">2003</span>,<span class="number">2009</span>,<span class="number">2003</span>]),</span><br><span class="line">   <span class="string">&#x27;height&#x27;</span>:pd.Series([<span class="number">180</span>,<span class="number">175</span>,<span class="number">178</span>,<span class="number">179</span>,<span class="number">176</span>,<span class="number">170</span>,<span class="number">173</span>])&#125;</span><br><span class="line"><span class="comment"># 构建DataFrame</span></span><br><span class="line">df = pd.DataFrame(d)</span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># T（Transpose）转置,返回DataFrame的转置，也就是把行和列进行交换</span></span><br><span class="line"><span class="built_in">print</span>(df.T)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 返回一个行标签、列标签组成的列表</span></span><br><span class="line"><span class="built_in">print</span>(df.axes)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 返回每一列的数据类型</span></span><br><span class="line"><span class="built_in">print</span>(df.dtypes)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 返回一个布尔值，判断输出的数据对象是否为空，若为True表示对象为空</span></span><br><span class="line"><span class="built_in">print</span>(df.empty)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 返回数据对象的维数。DataFrame是一个二维数据结构</span></span><br><span class="line"><span class="built_in">print</span>(df.ndim)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 返回一个代表DataFrame维度的元组。返回值元组(a,b)，其中a表示行数，b表示列数</span></span><br><span class="line"><span class="built_in">print</span>(df.shape)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 返回DataFrame中的元素数量</span></span><br><span class="line"><span class="built_in">print</span>(df.size)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 以ndarray数组的形式返回DataFrame中的数据</span></span><br><span class="line"><span class="built_in">print</span>(df.values)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">  Name  years  height</span><br><span class="line"><span class="number">0</span>   小汤   <span class="number">2005</span>     <span class="number">180</span></span><br><span class="line"><span class="number">1</span>   小王   <span class="number">2006</span>     <span class="number">175</span></span><br><span class="line"><span class="number">2</span>   小明   <span class="number">2015</span>     <span class="number">178</span></span><br><span class="line"><span class="number">3</span>   小红   <span class="number">2008</span>     <span class="number">179</span></span><br><span class="line"><span class="number">4</span>   小小   <span class="number">2003</span>     <span class="number">176</span></span><br><span class="line"><span class="number">5</span>   小微   <span class="number">2009</span>     <span class="number">170</span></span><br><span class="line"><span class="number">6</span>   小黄   <span class="number">2003</span>     <span class="number">173</span></span><br><span class="line">********************</span><br><span class="line">           <span class="number">0</span>     <span class="number">1</span>     <span class="number">2</span>     <span class="number">3</span>     <span class="number">4</span>     <span class="number">5</span>     <span class="number">6</span></span><br><span class="line">Name      小汤    小王    小明    小红    小小    小微    小黄</span><br><span class="line">years   <span class="number">2005</span>  <span class="number">2006</span>  <span class="number">2015</span>  <span class="number">2008</span>  <span class="number">2003</span>  <span class="number">2009</span>  <span class="number">2003</span></span><br><span class="line">height   <span class="number">180</span>   <span class="number">175</span>   <span class="number">178</span>   <span class="number">179</span>   <span class="number">176</span>   <span class="number">170</span>   <span class="number">173</span></span><br><span class="line">********************</span><br><span class="line">[RangeIndex(start=<span class="number">0</span>, stop=<span class="number">7</span>, step=<span class="number">1</span>), Index([<span class="string">&#x27;Name&#x27;</span>, <span class="string">&#x27;years&#x27;</span>, <span class="string">&#x27;height&#x27;</span>], dtype=<span class="string">&#x27;object&#x27;</span>)]</span><br><span class="line">********************</span><br><span class="line">Name      <span class="built_in">object</span></span><br><span class="line">years      int64</span><br><span class="line">height     int64</span><br><span class="line">dtype: <span class="built_in">object</span></span><br><span class="line">********************</span><br><span class="line"><span class="literal">False</span></span><br><span class="line">********************</span><br><span class="line"><span class="number">2</span></span><br><span class="line">********************</span><br><span class="line">(<span class="number">7</span>, <span class="number">3</span>)</span><br><span class="line">********************</span><br><span class="line"><span class="number">21</span></span><br><span class="line">********************</span><br><span class="line">[[<span class="string">&#x27;小汤&#x27;</span> <span class="number">2005</span> <span class="number">180</span>]</span><br><span class="line"> [<span class="string">&#x27;小王&#x27;</span> <span class="number">2006</span> <span class="number">175</span>]</span><br><span class="line"> [<span class="string">&#x27;小明&#x27;</span> <span class="number">2015</span> <span class="number">178</span>]</span><br><span class="line"> [<span class="string">&#x27;小红&#x27;</span> <span class="number">2008</span> <span class="number">179</span>]</span><br><span class="line"> [<span class="string">&#x27;小小&#x27;</span> <span class="number">2003</span> <span class="number">176</span>]</span><br><span class="line"> [<span class="string">&#x27;小微&#x27;</span> <span class="number">2009</span> <span class="number">170</span>]</span><br><span class="line"> [<span class="string">&#x27;小黄&#x27;</span> <span class="number">2003</span> <span class="number">173</span>]]</span><br><span class="line">********************</span><br></pre></td></tr></table></figure>
<p><code>head()</code>&amp;<code>tail()</code>查看数据。如果想要查看<code>DataFrame</code>的一部分数据，可以使用<code>head()</code>或者<code>tail()</code>方法。<code>head()</code>返回前n行数据，默认显示前5行数据。<code>tail()</code>返回后n行数据。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">d = &#123;<span class="string">&#x27;Name&#x27;</span>:pd.Series([<span class="string">&#x27;小汤&#x27;</span>,<span class="string">&#x27;小王&#x27;</span>,<span class="string">&quot;小明&quot;</span>,<span class="string">&#x27;小红&#x27;</span>,<span class="string">&#x27;小小&#x27;</span>,<span class="string">&#x27;小微&#x27;</span>,<span class="string">&#x27;小黄&#x27;</span>]),</span><br><span class="line">   <span class="string">&#x27;years&#x27;</span>:pd.Series([<span class="number">2005</span>,<span class="number">2006</span>,<span class="number">2015</span>,<span class="number">2008</span>,<span class="number">2003</span>,<span class="number">2009</span>,<span class="number">2003</span>]),</span><br><span class="line">   <span class="string">&#x27;height&#x27;</span>:pd.Series([<span class="number">180</span>,<span class="number">175</span>,<span class="number">178</span>,<span class="number">179</span>,<span class="number">176</span>,<span class="number">170</span>,<span class="number">173</span>])&#125;</span><br><span class="line"><span class="comment"># 构建DataFrame</span></span><br><span class="line">df = pd.DataFrame(d)</span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 获取前3行数据</span></span><br><span class="line"><span class="built_in">print</span>(df.head(<span class="number">3</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 获取后2行数据</span></span><br><span class="line"><span class="built_in">print</span>(df.tail(<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">  Name  years  height</span><br><span class="line"><span class="number">0</span>   小汤   <span class="number">2005</span>     <span class="number">180</span></span><br><span class="line"><span class="number">1</span>   小王   <span class="number">2006</span>     <span class="number">175</span></span><br><span class="line"><span class="number">2</span>   小明   <span class="number">2015</span>     <span class="number">178</span></span><br><span class="line"><span class="number">3</span>   小红   <span class="number">2008</span>     <span class="number">179</span></span><br><span class="line"><span class="number">4</span>   小小   <span class="number">2003</span>     <span class="number">176</span></span><br><span class="line"><span class="number">5</span>   小微   <span class="number">2009</span>     <span class="number">170</span></span><br><span class="line"><span class="number">6</span>   小黄   <span class="number">2003</span>     <span class="number">173</span></span><br><span class="line">********************</span><br><span class="line">  Name  years  height</span><br><span class="line"><span class="number">0</span>   小汤   <span class="number">2005</span>     <span class="number">180</span></span><br><span class="line"><span class="number">1</span>   小王   <span class="number">2006</span>     <span class="number">175</span></span><br><span class="line"><span class="number">2</span>   小明   <span class="number">2015</span>     <span class="number">178</span></span><br><span class="line">********************</span><br><span class="line">  Name  years  height</span><br><span class="line"><span class="number">5</span>   小微   <span class="number">2009</span>     <span class="number">170</span></span><br><span class="line"><span class="number">6</span>   小黄   <span class="number">2003</span>     <span class="number">173</span></span><br></pre></td></tr></table></figure>
<p><code>shift()</code>移动行或列。如果您想要移动<code>DataFrame</code>中的某一行/列，可以使用<code>shift()</code>函数实现。它提供了一个<code>periods</code>参数，该参数表示在特定的轴上移动指定的步幅。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">DataFrame.shift(periods=<span class="number">1</span>, freq=<span class="literal">None</span>, axis=<span class="number">0</span>)  </span><br><span class="line">参数说明：</span><br><span class="line">    peroids	类型为<span class="built_in">int</span>，表示移动的幅度，可以是正数，也可以是负数，默认值为<span class="number">1</span>。</span><br><span class="line">    freq	日期偏移量，默认值为<span class="literal">None</span>，适用于时间序。取值为符合时间规则的字符串。</span><br><span class="line">    axis	如果是<span class="number">0</span>或者<span class="string">&quot;index&quot;</span>表示上下移动，如果是<span class="number">1</span>或者<span class="string">&quot;columns&quot;</span>则会左右移动。</span><br><span class="line">    fill_value	该参数用来填充缺失值。</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">d = &#123;<span class="string">&#x27;Name&#x27;</span>:pd.Series([<span class="string">&#x27;小汤&#x27;</span>,<span class="string">&#x27;小王&#x27;</span>,<span class="string">&quot;小明&quot;</span>,<span class="string">&#x27;小红&#x27;</span>,<span class="string">&#x27;小小&#x27;</span>,<span class="string">&#x27;小微&#x27;</span>,<span class="string">&#x27;小黄&#x27;</span>]),</span><br><span class="line">   <span class="string">&#x27;years&#x27;</span>:pd.Series([<span class="number">2005</span>,<span class="number">2006</span>,<span class="number">2015</span>,<span class="number">2008</span>,<span class="number">2003</span>,<span class="number">2009</span>,<span class="number">2003</span>]),</span><br><span class="line">   <span class="string">&#x27;height&#x27;</span>:pd.Series([<span class="number">180</span>,<span class="number">175</span>,<span class="number">178</span>,<span class="number">179</span>,<span class="number">176</span>,<span class="number">170</span>,<span class="number">173</span>])&#125;</span><br><span class="line"><span class="comment"># 构建DataFrame</span></span><br><span class="line">df = pd.DataFrame(d)</span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 移动幅度为3</span></span><br><span class="line"><span class="built_in">print</span>(df.shift(periods=<span class="number">3</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 使用fill_value参数填充DataFrame中的缺失值</span></span><br><span class="line"><span class="built_in">print</span>(df.shift(periods=<span class="number">3</span>,fill_value=<span class="number">52</span>)) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="built_in">print</span>(df.shift(periods=<span class="number">3</span>,axis=<span class="number">1</span>,fill_value=<span class="number">52</span>)) </span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">  Name  years  height</span><br><span class="line"><span class="number">0</span>   小汤   <span class="number">2005</span>     <span class="number">180</span></span><br><span class="line"><span class="number">1</span>   小王   <span class="number">2006</span>     <span class="number">175</span></span><br><span class="line"><span class="number">2</span>   小明   <span class="number">2015</span>     <span class="number">178</span></span><br><span class="line"><span class="number">3</span>   小红   <span class="number">2008</span>     <span class="number">179</span></span><br><span class="line"><span class="number">4</span>   小小   <span class="number">2003</span>     <span class="number">176</span></span><br><span class="line"><span class="number">5</span>   小微   <span class="number">2009</span>     <span class="number">170</span></span><br><span class="line"><span class="number">6</span>   小黄   <span class="number">2003</span>     <span class="number">173</span></span><br><span class="line">********************</span><br><span class="line">  Name   years  height</span><br><span class="line"><span class="number">0</span>  NaN     NaN     NaN</span><br><span class="line"><span class="number">1</span>  NaN     NaN     NaN</span><br><span class="line"><span class="number">2</span>  NaN     NaN     NaN</span><br><span class="line"><span class="number">3</span>   小汤  <span class="number">2005.0</span>   <span class="number">180.0</span></span><br><span class="line"><span class="number">4</span>   小王  <span class="number">2006.0</span>   <span class="number">175.0</span></span><br><span class="line"><span class="number">5</span>   小明  <span class="number">2015.0</span>   <span class="number">178.0</span></span><br><span class="line"><span class="number">6</span>   小红  <span class="number">2008.0</span>   <span class="number">179.0</span></span><br><span class="line">********************</span><br><span class="line">  Name  years  height</span><br><span class="line"><span class="number">0</span>   <span class="number">52</span>     <span class="number">52</span>      <span class="number">52</span></span><br><span class="line"><span class="number">1</span>   <span class="number">52</span>     <span class="number">52</span>      <span class="number">52</span></span><br><span class="line"><span class="number">2</span>   <span class="number">52</span>     <span class="number">52</span>      <span class="number">52</span></span><br><span class="line"><span class="number">3</span>   小汤   <span class="number">2005</span>     <span class="number">180</span></span><br><span class="line"><span class="number">4</span>   小王   <span class="number">2006</span>     <span class="number">175</span></span><br><span class="line"><span class="number">5</span>   小明   <span class="number">2015</span>     <span class="number">178</span></span><br><span class="line"><span class="number">6</span>   小红   <span class="number">2008</span>     <span class="number">179</span></span><br><span class="line">********************</span><br><span class="line">  Name  years  height</span><br><span class="line"><span class="number">0</span>   <span class="number">52</span>     <span class="number">52</span>      <span class="number">52</span></span><br><span class="line"><span class="number">1</span>   <span class="number">52</span>     <span class="number">52</span>      <span class="number">52</span></span><br><span class="line"><span class="number">2</span>   <span class="number">52</span>     <span class="number">52</span>      <span class="number">52</span></span><br><span class="line"><span class="number">3</span>   <span class="number">52</span>     <span class="number">52</span>      <span class="number">52</span></span><br><span class="line"><span class="number">4</span>   <span class="number">52</span>     <span class="number">52</span>      <span class="number">52</span></span><br><span class="line"><span class="number">5</span>   <span class="number">52</span>     <span class="number">52</span>      <span class="number">52</span></span><br><span class="line"><span class="number">6</span>   <span class="number">52</span>     <span class="number">52</span>      <span class="number">52</span></span><br></pre></td></tr></table></figure>
<h2 id="pandas函数操作">⛄Pandas函数操作</h2>
<h3 id="panel结构了解">👀Panel结构（了解）</h3>
<p><code>Panel</code>是一个用来承载数据的三维数据结构，它有三个轴，分别是<code>items</code>（0轴），<code>major_axis</code>（1轴），而 <code>minor_axis</code>（2轴）。这三个轴为描述、操作<code>Panel</code>提供了支持，其作用介绍如下：</p>
<ul>
<li><code>items</code>：axis =0，Panel 中的每个<code>items</code>都对应一个<code>DataFrame</code>。</li>
<li><code>major_axis</code>：axis=1，用来描述每个<code>DataFrame</code>的行索引。</li>
<li><code>minor_axis</code>：axis=2，用来描述每个<code>DataFrame</code>的列索引。</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pandas.Panel(data, items, major_axis, minor_axis, dtype, copy)</span><br><span class="line">参数说明：</span><br><span class="line">    data	输入数据，可以是 ndarray，Series，列表，字典，或者 DataFrame。</span><br><span class="line">    items	axis=<span class="number">0</span></span><br><span class="line">    major_axis	axis=<span class="number">1</span></span><br><span class="line">    minor_axis	axis=<span class="number">2</span></span><br><span class="line">    dtype	每一列的数据类型。</span><br><span class="line">    copy	默认为 <span class="literal">False</span>，表示是否复制数据。</span><br></pre></td></tr></table></figure>
<blockquote>
<p>自<code>Pandas 0.25</code>版本后， <code>Panel</code>结构已经被废弃。</p>
</blockquote>
<h3 id="描述性统计函数">👀描述性统计函数</h3>
<table>
<thead>
<tr class="header">
<th>函数名称</th>
<th>描述说明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>count()</code></td>
<td>统计某个非空值的数量</td>
</tr>
<tr class="even">
<td><code>sum()</code></td>
<td>求和</td>
</tr>
<tr class="odd">
<td><code>mean()</code></td>
<td>求均值</td>
</tr>
<tr class="even">
<td><code>median()</code></td>
<td>求中位数</td>
</tr>
<tr class="odd">
<td><code>mode()</code></td>
<td>求众数</td>
</tr>
<tr class="even">
<td><code>std()</code></td>
<td>求标准差</td>
</tr>
<tr class="odd">
<td><code>min()</code></td>
<td>求最小值</td>
</tr>
<tr class="even">
<td><code>max()</code></td>
<td>求最大值</td>
</tr>
<tr class="odd">
<td><code>abs()</code></td>
<td>求绝对值</td>
</tr>
<tr class="even">
<td><code>prod()</code></td>
<td>求所有数值的乘积</td>
</tr>
<tr class="odd">
<td><code>cumsum()</code></td>
<td>计算累计和，axis=0，按照行累加；axis=1，按照列累加</td>
</tr>
<tr class="even">
<td><code>cumprod()</code></td>
<td>计算累计积，axis=0，按照行累积；axis=1，按照列累积</td>
</tr>
<tr class="odd">
<td><code>corr()</code></td>
<td>计算数列或变量之间的相关系数，取值-1到1，值越大表示关联性越强</td>
</tr>
<tr class="even">
<td><code>describe()</code></td>
<td>显示与DataFrame数据列相关的统计信息摘要</td>
</tr>
</tbody>
</table>
<p>在<code>DataFrame</code>中，使用聚合类方法时需要指定轴(<code>axis</code>)参数。下面介绍两种传参方式：</p>
<ul>
<li>对行操作，默认使用<code>axis=0</code>或者使用 "<code>index</code>"；</li>
<li>对列操作，默认使用<code>axis=1</code>或者使用 "<code>columns</code>"。</li>
<li><code>axis=0</code>表示按垂直方向进行计算，而<code>axis=1</code>则表示按水平方向。</li>
</ul>
<p><code>describe()</code>函数输出了平均值、<code>std</code>和<code>IQR</code>值(四分位距)等一系列统计信息。通过<code>describe()</code>提供的<code>include</code>能够筛选字符列或者数字列的摘要信息。<code>include</code>相关参数值说明如下：</p>
<ul>
<li><code>object</code>： 表示对字符列进行统计信息描述；</li>
<li><code>number</code>：表示对数字列进行统计信息描述；</li>
<li><code>all</code>：汇总所有列的统计信息。</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">d = &#123;<span class="string">&#x27;Name&#x27;</span>:pd.Series([<span class="string">&#x27;小汤&#x27;</span>,<span class="string">&#x27;小王&#x27;</span>,<span class="string">&quot;小明&quot;</span>,<span class="string">&#x27;小红&#x27;</span>,<span class="string">&#x27;小小&#x27;</span>,<span class="string">&#x27;小微&#x27;</span>,<span class="string">&#x27;小黄&#x27;</span>]),</span><br><span class="line">   <span class="string">&#x27;years&#x27;</span>:pd.Series([<span class="number">2005</span>,<span class="number">2006</span>,<span class="number">2015</span>,<span class="number">2008</span>,<span class="number">2003</span>,<span class="number">2009</span>,<span class="number">2003</span>]),</span><br><span class="line">   <span class="string">&#x27;height&#x27;</span>:pd.Series([<span class="number">180</span>,<span class="number">175</span>,<span class="number">178</span>,<span class="number">179</span>,<span class="number">176</span>,<span class="number">170</span>,<span class="number">173</span>])&#125;</span><br><span class="line"><span class="comment"># 构建DataFrame</span></span><br><span class="line">df = pd.DataFrame(d)</span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 求出数据的所有描述信息</span></span><br><span class="line"><span class="built_in">print</span>(df.describe())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="built_in">print</span>(df.describe(include=[<span class="string">&quot;object&quot;</span>]))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="built_in">print</span>(df.describe(include=<span class="string">&quot;all&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">  Name  years  height</span><br><span class="line"><span class="number">0</span>   小汤   <span class="number">2005</span>     <span class="number">180</span></span><br><span class="line"><span class="number">1</span>   小王   <span class="number">2006</span>     <span class="number">175</span></span><br><span class="line"><span class="number">2</span>   小明   <span class="number">2015</span>     <span class="number">178</span></span><br><span class="line"><span class="number">3</span>   小红   <span class="number">2008</span>     <span class="number">179</span></span><br><span class="line"><span class="number">4</span>   小小   <span class="number">2003</span>     <span class="number">176</span></span><br><span class="line"><span class="number">5</span>   小微   <span class="number">2009</span>     <span class="number">170</span></span><br><span class="line"><span class="number">6</span>   小黄   <span class="number">2003</span>     <span class="number">173</span></span><br><span class="line">********************</span><br><span class="line">             years      height</span><br><span class="line">count     <span class="number">7.000000</span>    <span class="number">7.000000</span></span><br><span class="line">mean   <span class="number">2007.000000</span>  <span class="number">175.857143</span></span><br><span class="line">std       <span class="number">4.203173</span>    <span class="number">3.532165</span></span><br><span class="line"><span class="built_in">min</span>    <span class="number">2003.000000</span>  <span class="number">170.000000</span></span><br><span class="line"><span class="number">25</span>%    <span class="number">2004.000000</span>  <span class="number">174.000000</span></span><br><span class="line"><span class="number">50</span>%    <span class="number">2006.000000</span>  <span class="number">176.000000</span></span><br><span class="line"><span class="number">75</span>%    <span class="number">2008.500000</span>  <span class="number">178.500000</span></span><br><span class="line"><span class="built_in">max</span>    <span class="number">2015.000000</span>  <span class="number">180.000000</span></span><br><span class="line">********************</span><br><span class="line">       Name</span><br><span class="line">count     <span class="number">7</span></span><br><span class="line">unique    <span class="number">7</span></span><br><span class="line">top      小汤</span><br><span class="line">freq      <span class="number">1</span></span><br><span class="line">********************</span><br><span class="line">       Name        years      height</span><br><span class="line">count     <span class="number">7</span>     <span class="number">7.000000</span>    <span class="number">7.000000</span></span><br><span class="line">unique    <span class="number">7</span>          NaN         NaN</span><br><span class="line">top      小汤          NaN         NaN</span><br><span class="line">freq      <span class="number">1</span>          NaN         NaN</span><br><span class="line">mean    NaN  <span class="number">2007.000000</span>  <span class="number">175.857143</span></span><br><span class="line">std     NaN     <span class="number">4.203173</span>    <span class="number">3.532165</span></span><br><span class="line"><span class="built_in">min</span>     NaN  <span class="number">2003.000000</span>  <span class="number">170.000000</span></span><br><span class="line"><span class="number">25</span>%     NaN  <span class="number">2004.000000</span>  <span class="number">174.000000</span></span><br><span class="line"><span class="number">50</span>%     NaN  <span class="number">2006.000000</span>  <span class="number">176.000000</span></span><br><span class="line"><span class="number">75</span>%     NaN  <span class="number">2008.500000</span>  <span class="number">178.500000</span></span><br><span class="line"><span class="built_in">max</span>     NaN  <span class="number">2015.000000</span>  <span class="number">180.000000</span></span><br></pre></td></tr></table></figure>
<h3 id="自定义函数">👀自定义函数</h3>
<p>如果想要应用自定义的函数，或者把其他库中的函数应用到Pandas对象中，有以下三种方法：</p>
<ul>
<li>操作整个<code>DataFrame</code>的函数：<code>pipe()</code></li>
<li>操作行或者列的函数：<code>apply()</code></li>
<li>操作单一元素的函数：<code>applymap()</code></li>
</ul>
<p>（1）操作整个数据表</p>
<p>通过给<code>pipe()</code>函数传递一个自定义函数和适当数量的参数值，从而操作<code>DataFrme</code>中的所有元素。下面示例，实现了数据表中的元素值依次加 6。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="comment"># 自定义函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">addsum</span>(<span class="params">a1,a2</span>):</span><br><span class="line">   <span class="keyword">return</span> a1 + a2</span><br><span class="line"><span class="comment"># 操作DataFrame</span></span><br><span class="line">df = pd.DataFrame([[<span class="number">120</span>,<span class="number">130</span>,<span class="number">150</span>],[<span class="number">90</span>,<span class="number">100</span>,<span class="number">110</span>],[<span class="number">60</span>,<span class="number">70</span>,<span class="number">80</span>]],columns=[<span class="string">&#x27;c1&#x27;</span>,<span class="string">&#x27;c2&#x27;</span>,<span class="string">&#x27;c3&#x27;</span>])</span><br><span class="line"><span class="comment"># 相加前</span></span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="comment"># 相加后</span></span><br><span class="line"><span class="built_in">print</span>(df.pipe(addsum,<span class="number">6</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">    c1   c2   c3</span><br><span class="line"><span class="number">0</span>  <span class="number">120</span>  <span class="number">130</span>  <span class="number">150</span></span><br><span class="line"><span class="number">1</span>   <span class="number">90</span>  <span class="number">100</span>  <span class="number">110</span></span><br><span class="line"><span class="number">2</span>   <span class="number">60</span>   <span class="number">70</span>   <span class="number">80</span></span><br><span class="line">    c1   c2   c3</span><br><span class="line"><span class="number">0</span>  <span class="number">126</span>  <span class="number">136</span>  <span class="number">156</span></span><br><span class="line"><span class="number">1</span>   <span class="number">96</span>  <span class="number">106</span>  <span class="number">116</span></span><br><span class="line"><span class="number">2</span>   <span class="number">66</span>   <span class="number">76</span>   <span class="number">86</span></span><br></pre></td></tr></table></figure>
<p>（2）操作行或列</p>
<p>如果要操作<code>DataFrame</code>的某一行或者某一列，可以使用<code>apply()</code>方法，该方法与描述性统计方法类似，都有可选参数<code>axis</code>，并且默认按列操作。示例如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="comment"># 操作DataFrame</span></span><br><span class="line">df = pd.DataFrame([[<span class="number">120</span>,<span class="number">130</span>,<span class="number">150</span>],[<span class="number">90</span>,<span class="number">100</span>,<span class="number">110</span>],[<span class="number">60</span>,<span class="number">70</span>,<span class="number">80</span>]],columns=[<span class="string">&#x27;c1&#x27;</span>,<span class="string">&#x27;c2&#x27;</span>,<span class="string">&#x27;c3&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 默认按列操作，计算每一列均值</span></span><br><span class="line"><span class="built_in">print</span>(df.apply(np.mean))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 传递轴参axis=1，表示逐行进行操作</span></span><br><span class="line"><span class="built_in">print</span>(df.apply(np.mean,axis=<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 求每一列中，最大值与最小值之差</span></span><br><span class="line"><span class="built_in">print</span>(df.apply(<span class="keyword">lambda</span> x: x.<span class="built_in">max</span>() - x.<span class="built_in">min</span>()))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">    c1   c2   c3</span><br><span class="line"><span class="number">0</span>  <span class="number">120</span>  <span class="number">130</span>  <span class="number">150</span></span><br><span class="line"><span class="number">1</span>   <span class="number">90</span>  <span class="number">100</span>  <span class="number">110</span></span><br><span class="line"><span class="number">2</span>   <span class="number">60</span>   <span class="number">70</span>   <span class="number">80</span></span><br><span class="line">********************</span><br><span class="line">c1     <span class="number">90.000000</span></span><br><span class="line">c2    <span class="number">100.000000</span></span><br><span class="line">c3    <span class="number">113.333333</span></span><br><span class="line">dtype: float64</span><br><span class="line">********************</span><br><span class="line"><span class="number">0</span>    <span class="number">133.333333</span></span><br><span class="line"><span class="number">1</span>    <span class="number">100.000000</span></span><br><span class="line"><span class="number">2</span>     <span class="number">70.000000</span></span><br><span class="line">dtype: float64</span><br><span class="line">********************</span><br><span class="line">c1    <span class="number">60</span></span><br><span class="line">c2    <span class="number">60</span></span><br><span class="line">c3    <span class="number">70</span></span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<p>（3）操作单一元素</p>
<p><code>DataFrame</code>数据表结构的<code>applymap()</code>和<code>Series</code>系列结构的<code>map()</code>类似，它们都可以接受一个<code>Python</code>函数，并返回相应的值。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="comment"># 操作DataFrame</span></span><br><span class="line">df = pd.DataFrame([[<span class="number">120</span>,<span class="number">130</span>,<span class="number">150</span>],[<span class="number">90</span>,<span class="number">100</span>,<span class="number">110</span>],[<span class="number">60</span>,<span class="number">70</span>,<span class="number">80</span>]],columns=[<span class="string">&#x27;c1&#x27;</span>,<span class="string">&#x27;c2&#x27;</span>,<span class="string">&#x27;c3&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 自定义函数lambda函数</span></span><br><span class="line"><span class="built_in">print</span>(df[<span class="string">&#x27;c1&#x27;</span>].<span class="built_in">map</span>(<span class="keyword">lambda</span> x:x*<span class="number">10</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 使用了applymap()函数</span></span><br><span class="line"><span class="built_in">print</span>(df.applymap(<span class="keyword">lambda</span> x:x*<span class="number">10</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">    c1   c2   c3</span><br><span class="line"><span class="number">0</span>  <span class="number">120</span>  <span class="number">130</span>  <span class="number">150</span></span><br><span class="line"><span class="number">1</span>   <span class="number">90</span>  <span class="number">100</span>  <span class="number">110</span></span><br><span class="line"><span class="number">2</span>   <span class="number">60</span>   <span class="number">70</span>   <span class="number">80</span></span><br><span class="line">********************</span><br><span class="line"><span class="number">0</span>    <span class="number">1200</span></span><br><span class="line"><span class="number">1</span>     <span class="number">900</span></span><br><span class="line"><span class="number">2</span>     <span class="number">600</span></span><br><span class="line">Name: c1, dtype: int64</span><br><span class="line">********************</span><br><span class="line">     c1    c2    c3</span><br><span class="line"><span class="number">0</span>  <span class="number">1200</span>  <span class="number">1300</span>  <span class="number">1500</span></span><br><span class="line"><span class="number">1</span>   <span class="number">900</span>  <span class="number">1000</span>  <span class="number">1100</span></span><br><span class="line"><span class="number">2</span>   <span class="number">600</span>   <span class="number">700</span>   <span class="number">800</span></span><br></pre></td></tr></table></figure>
<h3 id="reindex重置索引">👀reindex重置索引</h3>
<p>重置索引（<code>reindex</code>）可以更改原<code>DataFrame</code>的行标签或列标签，并使更改后的行、列标签与<code>DataFrame</code>中的数据逐一匹配。通过重置索引操作，您可以完成对现有数据的重新排序。如果重置的索引标签在原<code>DataFrame</code>中不存在，那么该标签对应的元素值将全部填充为<code>NaN</code>。</p>
<p>（1）重置行列标签</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="comment"># 操作DataFrame</span></span><br><span class="line">df = pd.DataFrame([[<span class="number">120</span>,<span class="number">130</span>,<span class="number">150</span>],[<span class="number">90</span>,<span class="number">100</span>,<span class="number">110</span>],[<span class="number">60</span>,<span class="number">70</span>,<span class="number">80</span>]],columns=[<span class="string">&#x27;c1&#x27;</span>,<span class="string">&#x27;c2&#x27;</span>,<span class="string">&#x27;c3&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 重置行、列索引标签</span></span><br><span class="line">df_reindexed = df.reindex(index=[<span class="number">0</span>,<span class="number">1</span>], columns=[<span class="string">&#x27;c1&#x27;</span>, <span class="string">&#x27;c3&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df_reindexed)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">    c1   c2   c3</span><br><span class="line"><span class="number">0</span>  <span class="number">120</span>  <span class="number">130</span>  <span class="number">150</span></span><br><span class="line"><span class="number">1</span>   <span class="number">90</span>  <span class="number">100</span>  <span class="number">110</span></span><br><span class="line"><span class="number">2</span>   <span class="number">60</span>   <span class="number">70</span>   <span class="number">80</span></span><br><span class="line">********************</span><br><span class="line">    c1   c3</span><br><span class="line"><span class="number">0</span>  <span class="number">120</span>  <span class="number">150</span></span><br><span class="line"><span class="number">1</span>   <span class="number">90</span>  <span class="number">110</span></span><br></pre></td></tr></table></figure>
<p>现有a、b两个<code>DataFrame</code>对象，如果想让a的行索引与b相同，您可以使用<code>reindex_like()</code> 方法。示例如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">a = pd.DataFrame(np.random.randn(<span class="number">10</span>,<span class="number">3</span>),columns=[<span class="string">&#x27;col1&#x27;</span>,<span class="string">&#x27;col2&#x27;</span>,<span class="string">&#x27;col3&#x27;</span>])</span><br><span class="line">b = pd.DataFrame(np.random.randn(<span class="number">7</span>,<span class="number">3</span>),columns=[<span class="string">&#x27;col1&#x27;</span>,<span class="string">&#x27;col2&#x27;</span>,<span class="string">&#x27;col3&#x27;</span>])</span><br><span class="line"><span class="comment"># a会按照b的形式重建行索引。需要特别注意的是，a与b的列索引标签必须相同。</span></span><br><span class="line">a= a.reindex_like(b)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">       col1      col2      col3</span><br><span class="line"><span class="number">0</span>  <span class="number">0.669617</span>  <span class="number">0.010243</span> -<span class="number">0.091776</span></span><br><span class="line"><span class="number">1</span> -<span class="number">0.333395</span> -<span class="number">1.521432</span>  <span class="number">0.292087</span></span><br><span class="line"><span class="number">2</span> -<span class="number">0.174709</span> -<span class="number">0.623413</span>  <span class="number">1.291384</span></span><br><span class="line"><span class="number">3</span>  <span class="number">1.033132</span> -<span class="number">0.383137</span>  <span class="number">1.280788</span></span><br><span class="line"><span class="number">4</span>  <span class="number">1.052466</span> -<span class="number">1.326848</span> -<span class="number">1.390581</span></span><br><span class="line"><span class="number">5</span>  <span class="number">1.828058</span>  <span class="number">0.422678</span> -<span class="number">0.734622</span></span><br><span class="line"><span class="number">6</span>  <span class="number">0.988210</span> -<span class="number">1.047092</span> -<span class="number">1.959839</span></span><br></pre></td></tr></table></figure>
<p>（2）填充元素值</p>
<p><code>reindex_like()</code>提供了一个可选的参数<code>method</code>，使用它来填充相应的元素值，参数值介绍如下：</p>
<ul>
<li><code>pad/ffill</code>：向前填充值；</li>
<li><code>bfill/backfill</code>：向后填充值；</li>
<li><code>nearest</code>：从距离最近的索引值开始填充。</li>
</ul>
<p><code>reindex_like()</code>还提供了一个额外参数<code>limit</code>，该参数用来控制填充的最大行数。示例如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">df1 = pd.DataFrame(np.random.randn(<span class="number">6</span>,<span class="number">3</span>),columns=[<span class="string">&#x27;col1&#x27;</span>,<span class="string">&#x27;col2&#x27;</span>,<span class="string">&#x27;col3&#x27;</span>])</span><br><span class="line">df2 = pd.DataFrame(np.random.randn(<span class="number">2</span>,<span class="number">3</span>),columns=[<span class="string">&#x27;col1&#x27;</span>,<span class="string">&#x27;col2&#x27;</span>,<span class="string">&#x27;col3&#x27;</span>])</span><br><span class="line"><span class="comment"># 使df2和df1行标签相同</span></span><br><span class="line"><span class="built_in">print</span>(df2.reindex_like(df1))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 向前填充</span></span><br><span class="line"><span class="built_in">print</span>(df2.reindex_like(df1,method=<span class="string">&#x27;ffill&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 向后填充</span></span><br><span class="line"><span class="built_in">print</span>(df2.reindex_like(df1,method=<span class="string">&#x27;backfill&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># limit限制填充行数</span></span><br><span class="line"><span class="built_in">print</span>(df2.reindex_like(df1,method=<span class="string">&#x27;ffill&#x27;</span>,limit=<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">       col1      col2      col3</span><br><span class="line"><span class="number">0</span>  <span class="number">0.552991</span>  <span class="number">1.230408</span>  <span class="number">0.403586</span></span><br><span class="line"><span class="number">1</span> -<span class="number">0.135228</span>  <span class="number">1.065911</span> -<span class="number">0.624843</span></span><br><span class="line"><span class="number">2</span>       NaN       NaN       NaN</span><br><span class="line"><span class="number">3</span>       NaN       NaN       NaN</span><br><span class="line"><span class="number">4</span>       NaN       NaN       NaN</span><br><span class="line"><span class="number">5</span>       NaN       NaN       NaN</span><br><span class="line">********************</span><br><span class="line">       col1      col2      col3</span><br><span class="line"><span class="number">0</span>  <span class="number">0.552991</span>  <span class="number">1.230408</span>  <span class="number">0.403586</span></span><br><span class="line"><span class="number">1</span> -<span class="number">0.135228</span>  <span class="number">1.065911</span> -<span class="number">0.624843</span></span><br><span class="line"><span class="number">2</span> -<span class="number">0.135228</span>  <span class="number">1.065911</span> -<span class="number">0.624843</span></span><br><span class="line"><span class="number">3</span> -<span class="number">0.135228</span>  <span class="number">1.065911</span> -<span class="number">0.624843</span></span><br><span class="line"><span class="number">4</span> -<span class="number">0.135228</span>  <span class="number">1.065911</span> -<span class="number">0.624843</span></span><br><span class="line"><span class="number">5</span> -<span class="number">0.135228</span>  <span class="number">1.065911</span> -<span class="number">0.624843</span></span><br><span class="line">********************</span><br><span class="line">       col1      col2      col3</span><br><span class="line"><span class="number">0</span>  <span class="number">0.552991</span>  <span class="number">1.230408</span>  <span class="number">0.403586</span></span><br><span class="line"><span class="number">1</span> -<span class="number">0.135228</span>  <span class="number">1.065911</span> -<span class="number">0.624843</span></span><br><span class="line"><span class="number">2</span>       NaN       NaN       NaN</span><br><span class="line"><span class="number">3</span>       NaN       NaN       NaN</span><br><span class="line"><span class="number">4</span>       NaN       NaN       NaN</span><br><span class="line"><span class="number">5</span>       NaN       NaN       NaN</span><br><span class="line">********************</span><br><span class="line">       col1      col2      col3</span><br><span class="line"><span class="number">0</span>  <span class="number">0.552991</span>  <span class="number">1.230408</span>  <span class="number">0.403586</span></span><br><span class="line"><span class="number">1</span> -<span class="number">0.135228</span>  <span class="number">1.065911</span> -<span class="number">0.624843</span></span><br><span class="line"><span class="number">2</span> -<span class="number">0.135228</span>  <span class="number">1.065911</span> -<span class="number">0.624843</span></span><br><span class="line"><span class="number">3</span> -<span class="number">0.135228</span>  <span class="number">1.065911</span> -<span class="number">0.624843</span></span><br><span class="line"><span class="number">4</span>       NaN       NaN       NaN</span><br><span class="line"><span class="number">5</span>       NaN       NaN       NaN</span><br></pre></td></tr></table></figure>
<p>（3）重命名标签</p>
<p><code>rename()</code>方法允许您使用某些映射(<code>dict</code>或<code>Series</code>)或任意函数来对行、列标签重新命名，示例如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="comment"># 操作DataFrame</span></span><br><span class="line">df = pd.DataFrame([[<span class="number">120</span>,<span class="number">130</span>,<span class="number">150</span>],[<span class="number">90</span>,<span class="number">100</span>,<span class="number">110</span>],[<span class="number">60</span>,<span class="number">70</span>,<span class="number">80</span>]],columns=[<span class="string">&#x27;c1&#x27;</span>,<span class="string">&#x27;c2&#x27;</span>,<span class="string">&#x27;c3&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 对行和列重新命名</span></span><br><span class="line"><span class="built_in">print</span>(df.rename(columns=&#123;<span class="string">&#x27;c1&#x27;</span>:<span class="string">&#x27;cc1&#x27;</span>,<span class="string">&#x27;c2&#x27;</span>:<span class="string">&#x27;cc2&#x27;</span>&#125;,index = &#123;<span class="number">0</span>:<span class="string">&#x27;one&#x27;</span>,<span class="number">1</span>:<span class="string">&#x27;two&#x27;</span>,<span class="number">2</span>:<span class="string">&#x27;three&#x27;</span>&#125;))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">    c1   c2   c3</span><br><span class="line"><span class="number">0</span>  <span class="number">120</span>  <span class="number">130</span>  <span class="number">150</span></span><br><span class="line"><span class="number">1</span>   <span class="number">90</span>  <span class="number">100</span>  <span class="number">110</span></span><br><span class="line"><span class="number">2</span>   <span class="number">60</span>   <span class="number">70</span>   <span class="number">80</span></span><br><span class="line">********************</span><br><span class="line">       cc1  cc2   c3</span><br><span class="line">one    <span class="number">120</span>  <span class="number">130</span>  <span class="number">150</span></span><br><span class="line">two     <span class="number">90</span>  <span class="number">100</span>  <span class="number">110</span></span><br><span class="line">three   <span class="number">60</span>   <span class="number">70</span>   <span class="number">80</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>rename()</code>方法提供了一个<code>inplace</code>参数，默认值为<code>False</code>，表示拷贝一份原数据，并在复制后的数据上做重命名操作。若<code>inplace=True</code>则表示在原数据的基础上重命名。</p>
</blockquote>
<h3 id="iteration遍历操作">👀iteration遍历操作</h3>
<p><code>Pandas</code>是如何遍历<code>Series</code>和<code>DataFrame</code>结构呢？对于<code>Series</code>而言，您可以把它当做一维数组进行遍历操作；而像<code>DataFrame</code>这种二维数据表结构，则类似于遍历<code>Python</code>字典。</p>
<p>在<code>Pandas</code>中同样也是使用<code>for</code>循环进行遍历。通过<code>for</code>遍历后，<code>Series</code>可直接获取相应的<code>value</code>，而<code>DataFrame</code>则会获取列标签。示例如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="comment"># 操作DataFrame</span></span><br><span class="line">df = pd.DataFrame([[<span class="number">120</span>,<span class="number">130</span>,<span class="number">150</span>],[<span class="number">90</span>,<span class="number">100</span>,<span class="number">110</span>],[<span class="number">60</span>,<span class="number">70</span>,<span class="number">80</span>]],columns=[<span class="string">&#x27;c1&#x27;</span>,<span class="string">&#x27;c2&#x27;</span>,<span class="string">&#x27;c3&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="keyword">for</span> col <span class="keyword">in</span> df:</span><br><span class="line">   <span class="built_in">print</span> (col)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">    c1   c2   c3</span><br><span class="line"><span class="number">0</span>  <span class="number">120</span>  <span class="number">130</span>  <span class="number">150</span></span><br><span class="line"><span class="number">1</span>   <span class="number">90</span>  <span class="number">100</span>  <span class="number">110</span></span><br><span class="line"><span class="number">2</span>   <span class="number">60</span>   <span class="number">70</span>   <span class="number">80</span></span><br><span class="line">********************</span><br><span class="line">c1</span><br><span class="line">c2</span><br><span class="line">c3</span><br></pre></td></tr></table></figure>
<p>如果想要遍历<code>DataFrame</code>的每一行，我们下列函数：</p>
<ul>
<li><code>iteritems()</code>：以键值对 (<code>key</code>,<code>value</code>) 的形式遍历；</li>
<li><code>iterrows()</code>：以 (<code>row_index</code>,<code>row</code>) 的形式遍历行;</li>
<li><code>itertuples()</code>：使用已命名元组的方式对行遍历。</li>
</ul>
<p><code>iteritems()</code>以键值对的形式遍历<code>DataFrame</code>对象，以<strong>列标签</strong>为键，以对应列的元素为值。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="comment"># 操作DataFrame</span></span><br><span class="line">df = pd.DataFrame([[<span class="number">120</span>,<span class="number">130</span>,<span class="number">150</span>],[<span class="number">90</span>,<span class="number">100</span>,<span class="number">110</span>],[<span class="number">60</span>,<span class="number">70</span>,<span class="number">80</span>]],columns=[<span class="string">&#x27;c1&#x27;</span>,<span class="string">&#x27;c2&#x27;</span>,<span class="string">&#x27;c3&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="keyword">for</span> key,value <span class="keyword">in</span> df.iteritems():</span><br><span class="line">   <span class="built_in">print</span>(key)</span><br><span class="line">   <span class="built_in">print</span>(value)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">    c1   c2   c3</span><br><span class="line"><span class="number">0</span>  <span class="number">120</span>  <span class="number">130</span>  <span class="number">150</span></span><br><span class="line"><span class="number">1</span>   <span class="number">90</span>  <span class="number">100</span>  <span class="number">110</span></span><br><span class="line"><span class="number">2</span>   <span class="number">60</span>   <span class="number">70</span>   <span class="number">80</span></span><br><span class="line">********************</span><br><span class="line">c1</span><br><span class="line"><span class="number">0</span>    <span class="number">120</span></span><br><span class="line"><span class="number">1</span>     <span class="number">90</span></span><br><span class="line"><span class="number">2</span>     <span class="number">60</span></span><br><span class="line">Name: c1, dtype: int64</span><br><span class="line">c2</span><br><span class="line"><span class="number">0</span>    <span class="number">130</span></span><br><span class="line"><span class="number">1</span>    <span class="number">100</span></span><br><span class="line"><span class="number">2</span>     <span class="number">70</span></span><br><span class="line">Name: c2, dtype: int64</span><br><span class="line">c3</span><br><span class="line"><span class="number">0</span>    <span class="number">150</span></span><br><span class="line"><span class="number">1</span>    <span class="number">110</span></span><br><span class="line"><span class="number">2</span>     <span class="number">80</span></span><br><span class="line">Name: c3, dtype: int64</span><br></pre></td></tr></table></figure>
<p><code>iterrows()</code>方法按行遍历，返回一个迭代器，以<strong>行索引</strong>标签为键，以每一行数据为值。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="comment"># 操作DataFrame</span></span><br><span class="line">df = pd.DataFrame([[<span class="number">120</span>,<span class="number">130</span>,<span class="number">150</span>],[<span class="number">90</span>,<span class="number">100</span>,<span class="number">110</span>],[<span class="number">60</span>,<span class="number">70</span>,<span class="number">80</span>]],columns=[<span class="string">&#x27;c1&#x27;</span>,<span class="string">&#x27;c2&#x27;</span>,<span class="string">&#x27;c3&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># iterrows()遍历行，其中0,1,2是行索引而c1,c2,c3是列索引。</span></span><br><span class="line"><span class="keyword">for</span> row_index,value <span class="keyword">in</span> df.iterrows():</span><br><span class="line">   <span class="built_in">print</span>(row_index)</span><br><span class="line">   <span class="built_in">print</span>(value)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">    c1   c2   c3</span><br><span class="line"><span class="number">0</span>  <span class="number">120</span>  <span class="number">130</span>  <span class="number">150</span></span><br><span class="line"><span class="number">1</span>   <span class="number">90</span>  <span class="number">100</span>  <span class="number">110</span></span><br><span class="line"><span class="number">2</span>   <span class="number">60</span>   <span class="number">70</span>   <span class="number">80</span></span><br><span class="line">********************</span><br><span class="line"><span class="number">0</span></span><br><span class="line">c1    <span class="number">120</span></span><br><span class="line">c2    <span class="number">130</span></span><br><span class="line">c3    <span class="number">150</span></span><br><span class="line">Name: <span class="number">0</span>, dtype: int64</span><br><span class="line"><span class="number">1</span></span><br><span class="line">c1     <span class="number">90</span></span><br><span class="line">c2    <span class="number">100</span></span><br><span class="line">c3    <span class="number">110</span></span><br><span class="line">Name: <span class="number">1</span>, dtype: int64</span><br><span class="line"><span class="number">2</span></span><br><span class="line">c1    <span class="number">60</span></span><br><span class="line">c2    <span class="number">70</span></span><br><span class="line">c3    <span class="number">80</span></span><br><span class="line">Name: <span class="number">2</span>, dtype: int64</span><br></pre></td></tr></table></figure>
<p><code>itertuples()</code>同样将返回一个迭代器，该方法会把<code>DataFrame</code>的<strong>每一行</strong>生成一个元组，示例如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="comment"># 操作DataFrame</span></span><br><span class="line">df = pd.DataFrame([[<span class="number">120</span>,<span class="number">130</span>,<span class="number">150</span>],[<span class="number">90</span>,<span class="number">100</span>,<span class="number">110</span>],[<span class="number">60</span>,<span class="number">70</span>,<span class="number">80</span>]],columns=[<span class="string">&#x27;c1&#x27;</span>,<span class="string">&#x27;c2&#x27;</span>,<span class="string">&#x27;c3&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> df.itertuples():</span><br><span class="line">    <span class="built_in">print</span>(row)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">    c1   c2   c3</span><br><span class="line"><span class="number">0</span>  <span class="number">120</span>  <span class="number">130</span>  <span class="number">150</span></span><br><span class="line"><span class="number">1</span>   <span class="number">90</span>  <span class="number">100</span>  <span class="number">110</span></span><br><span class="line"><span class="number">2</span>   <span class="number">60</span>   <span class="number">70</span>   <span class="number">80</span></span><br><span class="line">********************</span><br><span class="line">Pandas(Index=<span class="number">0</span>, c1=<span class="number">120</span>, c2=<span class="number">130</span>, c3=<span class="number">150</span>)</span><br><span class="line">Pandas(Index=<span class="number">1</span>, c1=<span class="number">90</span>, c2=<span class="number">100</span>, c3=<span class="number">110</span>)</span><br><span class="line">Pandas(Index=<span class="number">2</span>, c1=<span class="number">60</span>, c2=<span class="number">70</span>, c3=<span class="number">80</span>)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>迭代器返回的是原对象的副本，如果在迭代过程中修改元素值，不会影响原对象。</p>
</blockquote>
<h3 id="排序和去重">👀排序和去重</h3>
<h4 id="排序sorting">👁排序sorting</h4>
<p><code>Pandas</code>提供了两种排序方法，分别是按标签排序和按数值排序。</p>
<p>（1）按行标签排序</p>
<p>使用<code>sort_index()</code>方法对<strong>行标签排序</strong>，指定轴参数（<code>axis</code>）或者排序顺序。或者可以对<code>DataFrame</code>进行排序。默认情况下，按照行标签序排序。通过将布尔值传递给<code>ascending</code>参数，可以控制排序的顺序（行号顺序）。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="comment"># 行标签乱序排列，列标签乱序排列</span></span><br><span class="line">unsorted_df = pd.DataFrame(np.random.randn(<span class="number">6</span>,<span class="number">2</span>),index=[<span class="number">1</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">0</span>],columns=[<span class="string">&#x27;col2&#x27;</span>,<span class="string">&#x27;col1&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(unsorted_df)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line">sorted_df1 = unsorted_df.sort_index()</span><br><span class="line"><span class="built_in">print</span>(sorted_df1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line">sorted_df2 = unsorted_df.sort_index(ascending=<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(sorted_df2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">       col2      col1</span><br><span class="line"><span class="number">1</span> -<span class="number">0.458463</span>  <span class="number">0.422606</span></span><br><span class="line"><span class="number">4</span>  <span class="number">0.809682</span>  <span class="number">2.489952</span></span><br><span class="line"><span class="number">2</span>  <span class="number">1.609935</span>  <span class="number">0.096181</span></span><br><span class="line"><span class="number">3</span>  <span class="number">1.087255</span>  <span class="number">1.215676</span></span><br><span class="line"><span class="number">5</span>  <span class="number">0.436520</span>  <span class="number">0.389565</span></span><br><span class="line"><span class="number">0</span>  <span class="number">0.536720</span>  <span class="number">0.820746</span></span><br><span class="line">********************</span><br><span class="line">       col2      col1</span><br><span class="line"><span class="number">0</span>  <span class="number">0.536720</span>  <span class="number">0.820746</span></span><br><span class="line"><span class="number">1</span> -<span class="number">0.458463</span>  <span class="number">0.422606</span></span><br><span class="line"><span class="number">2</span>  <span class="number">1.609935</span>  <span class="number">0.096181</span></span><br><span class="line"><span class="number">3</span>  <span class="number">1.087255</span>  <span class="number">1.215676</span></span><br><span class="line"><span class="number">4</span>  <span class="number">0.809682</span>  <span class="number">2.489952</span></span><br><span class="line"><span class="number">5</span>  <span class="number">0.436520</span>  <span class="number">0.389565</span></span><br><span class="line">********************</span><br><span class="line">       col2      col1</span><br><span class="line"><span class="number">5</span>  <span class="number">0.436520</span>  <span class="number">0.389565</span></span><br><span class="line"><span class="number">4</span>  <span class="number">0.809682</span>  <span class="number">2.489952</span></span><br><span class="line"><span class="number">3</span>  <span class="number">1.087255</span>  <span class="number">1.215676</span></span><br><span class="line"><span class="number">2</span>  <span class="number">1.609935</span>  <span class="number">0.096181</span></span><br><span class="line"><span class="number">1</span> -<span class="number">0.458463</span>  <span class="number">0.422606</span></span><br><span class="line"><span class="number">0</span>  <span class="number">0.536720</span>  <span class="number">0.820746</span></span><br></pre></td></tr></table></figure>
<p>（2）按列标签排序</p>
<p>通过给<code>axis</code>轴参数传递0或1，可以对列标签进行排序。默认情况下，<code>axis=0</code>表示按行排序；而<code>axis=1</code>则表示按列排序。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="comment"># 行标签乱序排列，列标签乱序排列</span></span><br><span class="line">unsorted_df = pd.DataFrame(np.random.randn(<span class="number">6</span>,<span class="number">2</span>),index=[<span class="number">1</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">0</span>],columns=[<span class="string">&#x27;col2&#x27;</span>,<span class="string">&#x27;col1&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(unsorted_df)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line">sorted_df1 = unsorted_df.sort_index(axis=<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(sorted_df1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">       col2      col1</span><br><span class="line"><span class="number">1</span>  <span class="number">0.891755</span>  <span class="number">1.006258</span></span><br><span class="line"><span class="number">4</span>  <span class="number">0.232999</span>  <span class="number">0.549146</span></span><br><span class="line"><span class="number">2</span>  <span class="number">0.158894</span>  <span class="number">0.246825</span></span><br><span class="line"><span class="number">3</span>  <span class="number">0.653124</span> -<span class="number">1.695749</span></span><br><span class="line"><span class="number">5</span> -<span class="number">0.774252</span> -<span class="number">0.525881</span></span><br><span class="line"><span class="number">0</span>  <span class="number">0.082147</span>  <span class="number">0.384929</span></span><br><span class="line">********************</span><br><span class="line">       col1      col2</span><br><span class="line"><span class="number">1</span>  <span class="number">1.006258</span>  <span class="number">0.891755</span></span><br><span class="line"><span class="number">4</span>  <span class="number">0.549146</span>  <span class="number">0.232999</span></span><br><span class="line"><span class="number">2</span>  <span class="number">0.246825</span>  <span class="number">0.158894</span></span><br><span class="line"><span class="number">3</span> -<span class="number">1.695749</span>  <span class="number">0.653124</span></span><br><span class="line"><span class="number">5</span> -<span class="number">0.525881</span> -<span class="number">0.774252</span></span><br><span class="line"><span class="number">0</span>  <span class="number">0.384929</span>  <span class="number">0.082147</span></span><br></pre></td></tr></table></figure>
<p>（3）按值排序</p>
<p>与标签排序类似，<code>sort_values()</code>表示按值排序。它接受一个<code>by</code>参数，该参数值是要排序数列的<code>DataFrame</code>列名。示例如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="comment"># 行标签乱序排列，列标签乱序排列</span></span><br><span class="line">unsorted_df = pd.DataFrame(&#123;<span class="string">&#x27;col1&#x27;</span>:[<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>],<span class="string">&#x27;col2&#x27;</span>:[<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">4</span>]&#125;)</span><br><span class="line"><span class="built_in">print</span>(unsorted_df)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line">sorted_df1 = unsorted_df.sort_values(by=<span class="string">&#x27;col1&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(sorted_df1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 注意：当对col1列排序时，相应的col2列的元素值和行索引也会随col1一起改变。by参数可以接受一个列表参数值</span></span><br><span class="line">sorted_df2 = unsorted_df.sort_values(by=[<span class="string">&#x27;col1&#x27;</span>,<span class="string">&#x27;col2&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(sorted_df2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">   col1  col2</span><br><span class="line"><span class="number">0</span>     <span class="number">2</span>     <span class="number">1</span></span><br><span class="line"><span class="number">1</span>     <span class="number">1</span>     <span class="number">3</span></span><br><span class="line"><span class="number">2</span>     <span class="number">1</span>     <span class="number">2</span></span><br><span class="line"><span class="number">3</span>     <span class="number">1</span>     <span class="number">4</span></span><br><span class="line">********************</span><br><span class="line">   col1  col2</span><br><span class="line"><span class="number">1</span>     <span class="number">1</span>     <span class="number">3</span></span><br><span class="line"><span class="number">2</span>     <span class="number">1</span>     <span class="number">2</span></span><br><span class="line"><span class="number">3</span>     <span class="number">1</span>     <span class="number">4</span></span><br><span class="line"><span class="number">0</span>     <span class="number">2</span>     <span class="number">1</span></span><br><span class="line">********************</span><br><span class="line">   col1  col2</span><br><span class="line"><span class="number">2</span>     <span class="number">1</span>     <span class="number">2</span></span><br><span class="line"><span class="number">1</span>     <span class="number">1</span>     <span class="number">3</span></span><br><span class="line"><span class="number">3</span>     <span class="number">1</span>     <span class="number">4</span></span><br><span class="line"><span class="number">0</span>     <span class="number">2</span>     <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>（4）排序算法</p>
<p><code>sort_values()</code>提供了参数<code>kind</code>用来指定排序算法。这里有三种排序算法：</p>
<ul>
<li><code>mergesort</code></li>
<li><code>heapsort</code></li>
<li><code>quicksort</code></li>
</ul>
<p>默认为<code>quicksort</code>(快速排序) ，其中<code>Mergesort</code>归并排序是最稳定的算法。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="comment"># 行标签乱序排列，列标签乱序排列</span></span><br><span class="line">unsorted_df = pd.DataFrame(&#123;<span class="string">&#x27;col1&#x27;</span>:[<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>],<span class="string">&#x27;col2&#x27;</span>:[<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">4</span>]&#125;)</span><br><span class="line"><span class="built_in">print</span>(unsorted_df)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line">sorted_df1 = unsorted_df.sort_values(by=<span class="string">&#x27;col1&#x27;</span>,kind=<span class="string">&#x27;mergesort&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(sorted_df1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">   col1  col2</span><br><span class="line"><span class="number">0</span>     <span class="number">2</span>     <span class="number">1</span></span><br><span class="line"><span class="number">1</span>     <span class="number">1</span>     <span class="number">3</span></span><br><span class="line"><span class="number">2</span>     <span class="number">1</span>     <span class="number">2</span></span><br><span class="line"><span class="number">3</span>     <span class="number">1</span>     <span class="number">4</span></span><br><span class="line">********************</span><br><span class="line">   col1  col2</span><br><span class="line"><span class="number">1</span>     <span class="number">1</span>     <span class="number">3</span></span><br><span class="line"><span class="number">2</span>     <span class="number">1</span>     <span class="number">2</span></span><br><span class="line"><span class="number">3</span>     <span class="number">1</span>     <span class="number">4</span></span><br><span class="line"><span class="number">0</span>     <span class="number">2</span>     <span class="number">1</span></span><br></pre></td></tr></table></figure>
<h4 id="去重drop_duplicates">👁去重drop_duplicates()</h4>
<p>“去重”通过字面意思不难理解，就是删除重复的数据。在一个数据集中，找出重复的数据删并将其删除，最终只保存一个唯一存在的数据项，这就是数据去重的整个过程。</p>
<p><code>Panda DataFrame</code>对象提供了一个数据去重的函数<code>drop_duplicates()</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">df.drop_duplicates(subset=[<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>],keep=<span class="string">&#x27;first&#x27;</span>,inplace=<span class="literal">True</span>)</span><br><span class="line">参数说明如下：</span><br><span class="line">    subset：表示要进去重的列名，默认为<span class="literal">None</span>。</span><br><span class="line">    keep：有三个可选参数，分别是first、last、<span class="literal">False</span>，默认为first，表示只保留第一次出现的重复项，删除其余重复项，last表示只保留最后一次出现的重复项，<span class="literal">False</span>则表示删除所有重复项。</span><br><span class="line">    inplace：布尔值参数，默认为<span class="literal">False</span>表示删除重复项后返回一个副本，若为Ture则表示直接在原数据上删除重复项。</span><br></pre></td></tr></table></figure>
<blockquote>
<p>删除重复项后，行标签使用的数字是原来的，并没有从0重新开始，那么我们应该怎么从0重置索引呢？<code>Pandas</code>提供的<code>reset_index()</code>函数会直接使用重置后的索引。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">data = &#123;<span class="string">&#x27;col1&#x27;</span>:[<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>],<span class="string">&#x27;col2&#x27;</span>:[<span class="number">0</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">0</span>],<span class="string">&#x27;col3&#x27;</span>:[<span class="number">4</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">4</span>],<span class="string">&#x27;col4&#x27;</span>:[<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>]&#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 默认保留第一次出现的重复项,默认为first</span></span><br><span class="line"><span class="built_in">print</span>(df.drop_duplicates())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># keep=False删除所有重复项</span></span><br><span class="line">df1 = df.drop_duplicates(keep=<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(df1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 重置索引，从0重新开始</span></span><br><span class="line"><span class="built_in">print</span>(df1.reset_index(drop=<span class="literal">True</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 指定多列同时去重</span></span><br><span class="line"><span class="built_in">print</span>(df.drop_duplicates([<span class="string">&#x27;col3&#x27;</span>,<span class="string">&#x27;col4&#x27;</span>],keep=<span class="string">&#x27;last&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">   col1  col2  col3  col4</span><br><span class="line"><span class="number">0</span>     <span class="number">1</span>     <span class="number">0</span>     <span class="number">4</span>     <span class="number">1</span></span><br><span class="line"><span class="number">1</span>     <span class="number">0</span>     <span class="number">2</span>     <span class="number">0</span>     <span class="number">0</span></span><br><span class="line"><span class="number">2</span>     <span class="number">1</span>     <span class="number">5</span>     <span class="number">4</span>     <span class="number">1</span></span><br><span class="line"><span class="number">3</span>     <span class="number">1</span>     <span class="number">0</span>     <span class="number">4</span>     <span class="number">1</span></span><br><span class="line">********************</span><br><span class="line">   col1  col2  col3  col4</span><br><span class="line"><span class="number">0</span>     <span class="number">1</span>     <span class="number">0</span>     <span class="number">4</span>     <span class="number">1</span></span><br><span class="line"><span class="number">1</span>     <span class="number">0</span>     <span class="number">2</span>     <span class="number">0</span>     <span class="number">0</span></span><br><span class="line"><span class="number">2</span>     <span class="number">1</span>     <span class="number">5</span>     <span class="number">4</span>     <span class="number">1</span></span><br><span class="line">********************</span><br><span class="line">   col1  col2  col3  col4</span><br><span class="line"><span class="number">1</span>     <span class="number">0</span>     <span class="number">2</span>     <span class="number">0</span>     <span class="number">0</span></span><br><span class="line"><span class="number">2</span>     <span class="number">1</span>     <span class="number">5</span>     <span class="number">4</span>     <span class="number">1</span></span><br><span class="line">********************</span><br><span class="line">   col1  col2  col3  col4</span><br><span class="line"><span class="number">0</span>     <span class="number">0</span>     <span class="number">2</span>     <span class="number">0</span>     <span class="number">0</span></span><br><span class="line"><span class="number">1</span>     <span class="number">1</span>     <span class="number">5</span>     <span class="number">4</span>     <span class="number">1</span></span><br><span class="line">********************</span><br><span class="line">   col1  col2  col3  col4</span><br><span class="line"><span class="number">1</span>     <span class="number">0</span>     <span class="number">2</span>     <span class="number">0</span>     <span class="number">0</span></span><br><span class="line"><span class="number">3</span>     <span class="number">1</span>     <span class="number">0</span>     <span class="number">4</span>     <span class="number">1</span></span><br></pre></td></tr></table></figure>
<h3 id="字符串处理">👀字符串处理</h3>
<p><code>Pandas</code>提供了一系列的字符串函数，因此能够很方便地对字符串进行处理。</p>
<table>
<thead>
<tr class="header">
<th>函数名称</th>
<th>函数功能和描述</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>lower()</code></td>
<td>将的字符串转换为小写</td>
</tr>
<tr class="even">
<td><code>upper()</code></td>
<td>将的字符串转换为大写</td>
</tr>
<tr class="odd">
<td><code>len()</code></td>
<td>得出字符串的长度</td>
</tr>
<tr class="even">
<td><code>strip()</code></td>
<td>去除字符串两边的空格（包含换行符）</td>
</tr>
<tr class="odd">
<td><code>split()</code></td>
<td>用指定的分割符分割字符串</td>
</tr>
<tr class="even">
<td><code>cat(sep="")</code></td>
<td>用给定的分隔符连接字符串元素</td>
</tr>
<tr class="odd">
<td><code>get_dummies()</code></td>
<td>返回一个带有独热编码值的<code>DataFrame</code>结构</td>
</tr>
<tr class="even">
<td><code>contains(pattern)</code></td>
<td>如果子字符串包含在元素中，则为每个元素返回一个布尔值True，否则为False</td>
</tr>
<tr class="odd">
<td><code>replace(a,b)</code></td>
<td>将值a替换为值b</td>
</tr>
<tr class="even">
<td><code>count(pattern)</code></td>
<td>返回每个字符串元素出现的次数</td>
</tr>
<tr class="odd">
<td><code>startswith(pattern)</code></td>
<td>如果<code>Series</code>中的元素以指定的字符串开头，则返回True</td>
</tr>
<tr class="even">
<td><code>endswith(pattern)</code></td>
<td>如果<code>Series</code>中的元素以指定的字符串结尾，则返回True</td>
</tr>
<tr class="odd">
<td><code>findall(pattern)</code></td>
<td>以列表的形式返出现的字符串</td>
</tr>
<tr class="even">
<td><code>swapcase()</code></td>
<td>交换大小写</td>
</tr>
<tr class="odd">
<td><code>islower()</code></td>
<td>返回布尔值，检查<code>Series</code>中组成每个字符串的所有字符是否都为小写</td>
</tr>
<tr class="even">
<td><code>issupper()</code></td>
<td>返回布尔值，检查<code>Series</code>中组成每个字符串的所有字符是否都为大写</td>
</tr>
<tr class="odd">
<td><code>isnumeric()</code></td>
<td>返回布尔值，检查<code>Series</code>中组成每个字符串的所有字符是否都为数字</td>
</tr>
<tr class="even">
<td><code>repeat(value)</code></td>
<td>以指定的次数重复每个元素</td>
</tr>
<tr class="odd">
<td><code>find(pattern)</code></td>
<td>返回字符串第一次出现的索引位置</td>
</tr>
</tbody>
</table>
<blockquote>
<p>注意：上述所有字符串函数全部适用于<code>DataFrame</code>对象，同时也可以与<code>Python</code>内置的字符串函数一起使用，这些函数在处理<code>Series/DataFrame</code>对象的时候会自动忽略缺失值数据（<code>NaN</code>）。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">s = pd.Series([<span class="string">&#x27;C &#x27;</span>, <span class="string">&#x27; Python&#x27;</span>, <span class="string">&#x27;java&#x27;</span>, <span class="string">&#x27;go&#x27;</span>, np.nan, <span class="string">&#x27;1125 &#x27;</span>,<span class="string">&#x27;javascript&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(s.<span class="built_in">str</span>.lower)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="built_in">print</span>(s.<span class="built_in">str</span>.<span class="built_in">len</span>())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="built_in">print</span>(s.<span class="built_in">str</span>.strip())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="built_in">print</span>(s.<span class="built_in">str</span>.split(<span class="string">&quot; &quot;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="built_in">print</span>(s.<span class="built_in">str</span>.cat(sep=<span class="string">&quot;_&quot;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="built_in">print</span>(s.<span class="built_in">str</span>.get_dummies())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="built_in">print</span>(s.<span class="built_in">str</span>.contains(<span class="string">&quot; &quot;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="built_in">print</span>(s.<span class="built_in">str</span>.repeat(<span class="number">3</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="built_in">print</span>(s.<span class="built_in">str</span>.startswith(<span class="string">&quot;j&quot;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 如果返回-1表示该字符串中没有出现指定的字符</span></span><br><span class="line"><span class="built_in">print</span>(s.<span class="built_in">str</span>.find(<span class="string">&quot;j&quot;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="built_in">print</span>(s.<span class="built_in">str</span>.swapcase())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="built_in">print</span>(s.<span class="built_in">str</span>.isnumeric())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line"><span class="number">0</span>            c </span><br><span class="line"><span class="number">1</span>        python</span><br><span class="line"><span class="number">2</span>          java</span><br><span class="line"><span class="number">3</span>            go</span><br><span class="line"><span class="number">4</span>           NaN</span><br><span class="line"><span class="number">5</span>         <span class="number">1125</span> </span><br><span class="line"><span class="number">6</span>    javascript</span><br><span class="line">dtype: <span class="built_in">object</span></span><br><span class="line">********************</span><br><span class="line"><span class="number">0</span>     <span class="number">2.0</span></span><br><span class="line"><span class="number">1</span>     <span class="number">7.0</span></span><br><span class="line"><span class="number">2</span>     <span class="number">4.0</span></span><br><span class="line"><span class="number">3</span>     <span class="number">2.0</span></span><br><span class="line"><span class="number">4</span>     NaN</span><br><span class="line"><span class="number">5</span>     <span class="number">5.0</span></span><br><span class="line"><span class="number">6</span>    <span class="number">10.0</span></span><br><span class="line">dtype: float64</span><br><span class="line">********************</span><br><span class="line"><span class="number">0</span>             C</span><br><span class="line"><span class="number">1</span>        Python</span><br><span class="line"><span class="number">2</span>          java</span><br><span class="line"><span class="number">3</span>            go</span><br><span class="line"><span class="number">4</span>           NaN</span><br><span class="line"><span class="number">5</span>          <span class="number">1125</span></span><br><span class="line"><span class="number">6</span>    javascript</span><br><span class="line">dtype: <span class="built_in">object</span></span><br><span class="line">********************</span><br><span class="line"><span class="number">0</span>           [C, ]</span><br><span class="line"><span class="number">1</span>      [, Python]</span><br><span class="line"><span class="number">2</span>          [java]</span><br><span class="line"><span class="number">3</span>            [go]</span><br><span class="line"><span class="number">4</span>             NaN</span><br><span class="line"><span class="number">5</span>        [<span class="number">1125</span>, ]</span><br><span class="line"><span class="number">6</span>    [javascript]</span><br><span class="line">dtype: <span class="built_in">object</span></span><br><span class="line">********************</span><br><span class="line">C _ Python_java_go_1125 _javascript</span><br><span class="line">********************</span><br><span class="line">    Python  <span class="number">1125</span>   C   go  java  javascript</span><br><span class="line"><span class="number">0</span>        <span class="number">0</span>      <span class="number">0</span>   <span class="number">1</span>   <span class="number">0</span>     <span class="number">0</span>           <span class="number">0</span></span><br><span class="line"><span class="number">1</span>        <span class="number">1</span>      <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span>     <span class="number">0</span>           <span class="number">0</span></span><br><span class="line"><span class="number">2</span>        <span class="number">0</span>      <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span>     <span class="number">1</span>           <span class="number">0</span></span><br><span class="line"><span class="number">3</span>        <span class="number">0</span>      <span class="number">0</span>   <span class="number">0</span>   <span class="number">1</span>     <span class="number">0</span>           <span class="number">0</span></span><br><span class="line"><span class="number">4</span>        <span class="number">0</span>      <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span>     <span class="number">0</span>           <span class="number">0</span></span><br><span class="line"><span class="number">5</span>        <span class="number">0</span>      <span class="number">1</span>   <span class="number">0</span>   <span class="number">0</span>     <span class="number">0</span>           <span class="number">0</span></span><br><span class="line"><span class="number">6</span>        <span class="number">0</span>      <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span>     <span class="number">0</span>           <span class="number">1</span></span><br><span class="line">********************</span><br><span class="line"><span class="number">0</span>     <span class="literal">True</span></span><br><span class="line"><span class="number">1</span>     <span class="literal">True</span></span><br><span class="line"><span class="number">2</span>    <span class="literal">False</span></span><br><span class="line"><span class="number">3</span>    <span class="literal">False</span></span><br><span class="line"><span class="number">4</span>      NaN</span><br><span class="line"><span class="number">5</span>     <span class="literal">True</span></span><br><span class="line"><span class="number">6</span>    <span class="literal">False</span></span><br><span class="line">dtype: <span class="built_in">object</span></span><br><span class="line">********************</span><br><span class="line"><span class="number">0</span>                            C C C </span><br><span class="line"><span class="number">1</span>              Python Python Python</span><br><span class="line"><span class="number">2</span>                      javajavajava</span><br><span class="line"><span class="number">3</span>                            gogogo</span><br><span class="line"><span class="number">4</span>                               NaN</span><br><span class="line"><span class="number">5</span>                   <span class="number">1125</span> <span class="number">1125</span> <span class="number">1125</span> </span><br><span class="line"><span class="number">6</span>    javascriptjavascriptjavascript</span><br><span class="line">dtype: <span class="built_in">object</span></span><br><span class="line">********************</span><br><span class="line"><span class="number">0</span>    <span class="literal">False</span></span><br><span class="line"><span class="number">1</span>    <span class="literal">False</span></span><br><span class="line"><span class="number">2</span>     <span class="literal">True</span></span><br><span class="line"><span class="number">3</span>    <span class="literal">False</span></span><br><span class="line"><span class="number">4</span>      NaN</span><br><span class="line"><span class="number">5</span>    <span class="literal">False</span></span><br><span class="line"><span class="number">6</span>     <span class="literal">True</span></span><br><span class="line">dtype: <span class="built_in">object</span></span><br><span class="line">********************</span><br><span class="line"><span class="number">0</span>   -<span class="number">1.0</span></span><br><span class="line"><span class="number">1</span>   -<span class="number">1.0</span></span><br><span class="line"><span class="number">2</span>    <span class="number">0.0</span></span><br><span class="line"><span class="number">3</span>   -<span class="number">1.0</span></span><br><span class="line"><span class="number">4</span>    NaN</span><br><span class="line"><span class="number">5</span>   -<span class="number">1.0</span></span><br><span class="line"><span class="number">6</span>    <span class="number">0.0</span></span><br><span class="line">dtype: float64</span><br><span class="line">********************</span><br><span class="line"><span class="number">0</span>            c </span><br><span class="line"><span class="number">1</span>        pYTHON</span><br><span class="line"><span class="number">2</span>          JAVA</span><br><span class="line"><span class="number">3</span>            GO</span><br><span class="line"><span class="number">4</span>           NaN</span><br><span class="line"><span class="number">5</span>         <span class="number">1125</span> </span><br><span class="line"><span class="number">6</span>    JAVASCRIPT</span><br><span class="line">dtype: <span class="built_in">object</span></span><br><span class="line">********************</span><br><span class="line"><span class="number">0</span>    <span class="literal">False</span></span><br><span class="line"><span class="number">1</span>    <span class="literal">False</span></span><br><span class="line"><span class="number">2</span>    <span class="literal">False</span></span><br><span class="line"><span class="number">3</span>    <span class="literal">False</span></span><br><span class="line"><span class="number">4</span>      NaN</span><br><span class="line"><span class="number">5</span>    <span class="literal">False</span></span><br><span class="line"><span class="number">6</span>    <span class="literal">False</span></span><br><span class="line">dtype: <span class="built_in">object</span></span><br></pre></td></tr></table></figure>
<h3 id="设置数据显示格式">👀设置数据显示格式</h3>
<p>在用<code>Pandas</code>做数据分析的过程中，总需要打印数据分析的结果，如果数据体量较大就会存在输出内容不全（部分内容省略）或者换行错误等问题。<code>Pandas</code>为了解决上述问题，允许你对数据显示格式进行设置。下面列出了五个用来设置显示格式的函数，分别是：</p>
<table>
<thead>
<tr class="header">
<th>函数名称</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>get_option()</code></td>
<td>获取解释器的默认参数值</td>
</tr>
<tr class="even">
<td><code>set_option()</code></td>
<td>更改解释器的默认参数值</td>
</tr>
<tr class="odd">
<td><code>reset_option()</code></td>
<td>解释器的参数重置为默认值</td>
</tr>
<tr class="even">
<td><code>describe_option()</code></td>
<td>输出参数的描述信息</td>
</tr>
<tr class="odd">
<td><code>option_context()</code></td>
<td>临时设置解释器参数，当退出使用的语句块时，恢复为默认值</td>
</tr>
</tbody>
</table>
<p>上述函数常用的参数项：</p>
<table>
<colgroup>
<col style="width: 31%" />
<col style="width: 68%" />
</colgroup>
<thead>
<tr class="header">
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>display.max_rows</code></td>
<td>最大显示行数，超过该值用省略号代替，为None时显示所有行</td>
</tr>
<tr class="even">
<td><code>display.max_columns</code></td>
<td>最大显示列数，超过该值用省略号代替，为None时显示所有列</td>
</tr>
<tr class="odd">
<td><code>display.expand_frame_repr</code></td>
<td>输出数据宽度超过设置宽度时，表示是否对其要折叠，False不折叠，True要折叠</td>
</tr>
<tr class="even">
<td><code>display.max_colwidth</code></td>
<td>单列数据宽度，以字符个数计算，超过时用省略号表示</td>
</tr>
<tr class="odd">
<td><code>display.precision</code></td>
<td>设置输出数据的小数点位数</td>
</tr>
<tr class="even">
<td><code>display.width</code></td>
<td>数据显示区域的宽度，以总字符数计算</td>
</tr>
<tr class="odd">
<td><code>display.show_dimensions</code></td>
<td>当数据量大需要以truncate（带引号的省略方式）显示时，该参数表示是否在最后显示数据的维数，默认True显示，False不显示。</td>
</tr>
</tbody>
</table>
<h3 id="loc和iloc用法详解">👀loc和iloc用法详解</h3>
<p>在数据分析过程中，很多时候需要从数据表中提取出相应的数据，而这么做的前提是需要先“索引”出这一部分数据。虽然通过<code>Python</code>提供的索引操作符<code>"[]"</code>和属性操作符<code>"."</code>可以访问<code>Series</code>或者<code>DataFrame</code>中的数据，但这种方式只适应与少量的数据，为了解决这一问题，<code>Pandas</code>提供了两种类型的索引方式来实现数据的访问。</p>
<table>
<thead>
<tr class="header">
<th>方法名称</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>.loc[]</code></td>
<td>基于标签索引选取数据</td>
</tr>
<tr class="even">
<td><code>.iloc[]</code></td>
<td>基于整数索引选取数据</td>
</tr>
</tbody>
</table>
<p><code>df.loc[]</code>只能使用标签索引，不能使用整数索引。当通过标签索引的切片方式来筛选数据时，它的取值前闭后闭，也就是只包括边界值标签（开始和结束）。</p>
<p><code>.loc[]</code>具有多种访问方法，如下所示：</p>
<ul>
<li>一个标量标签</li>
<li>标签列表</li>
<li>切片对象</li>
<li>布尔数组</li>
</ul>
<p><code>loc[]</code>接受两个参数，并以<code>','</code>分隔。第一个位置表示行，第二个位置表示列。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: [<span class="string">&#x27;Tom&#x27;</span>, <span class="string">&#x27;Rose&#x27;</span>, <span class="string">&#x27;Mike&#x27;</span>, <span class="string">&#x27;Twg&#x27;</span>],</span><br><span class="line">  <span class="string">&quot;calories&quot;</span>: [<span class="number">420</span>, <span class="number">380</span>, <span class="number">390</span>, <span class="number">500</span>],</span><br><span class="line">  <span class="string">&quot;duration&quot;</span>: [<span class="number">50</span>, <span class="number">40</span>, <span class="number">45</span>, <span class="number">60</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 数据载入到 DataFrame 对象</span></span><br><span class="line">df = pd.DataFrame(data, index = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 对行操作，等同于df.loc[&#x27;a&#x27;:&#x27;b&#x27;]</span></span><br><span class="line"><span class="built_in">print</span>(df.loc[<span class="string">&#x27;a&#x27;</span>:<span class="string">&#x27;b&#x27;</span>,:])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 对列操作</span></span><br><span class="line"><span class="built_in">print</span>(df.loc[:,<span class="string">&#x27;name&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 对行、列操作</span></span><br><span class="line"><span class="built_in">print</span>(df.loc[[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;d&#x27;</span>],[<span class="string">&#x27;name&#x27;</span>,<span class="string">&#x27;duration&#x27;</span>]])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 布尔值操作</span></span><br><span class="line"><span class="built_in">print</span>(df.loc[:,<span class="string">&#x27;duration&#x27;</span>] &gt; <span class="number">45</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">   name  calories  duration</span><br><span class="line">a   Tom       <span class="number">420</span>        <span class="number">50</span></span><br><span class="line">b  Rose       <span class="number">380</span>        <span class="number">40</span></span><br><span class="line">c  Mike       <span class="number">390</span>        <span class="number">45</span></span><br><span class="line">d   Twg       <span class="number">500</span>        <span class="number">60</span></span><br><span class="line">********************</span><br><span class="line">   name  calories  duration</span><br><span class="line">a   Tom       <span class="number">420</span>        <span class="number">50</span></span><br><span class="line">b  Rose       <span class="number">380</span>        <span class="number">40</span></span><br><span class="line">********************</span><br><span class="line">a     Tom</span><br><span class="line">b    Rose</span><br><span class="line">c    Mike</span><br><span class="line">d     Twg</span><br><span class="line">Name: name, dtype: <span class="built_in">object</span></span><br><span class="line">********************</span><br><span class="line">  name  duration</span><br><span class="line">a  Tom        <span class="number">50</span></span><br><span class="line">d  Twg        <span class="number">60</span></span><br><span class="line">********************</span><br><span class="line">a     <span class="literal">True</span></span><br><span class="line">b    <span class="literal">False</span></span><br><span class="line">c    <span class="literal">False</span></span><br><span class="line">d     <span class="literal">True</span></span><br><span class="line">Name: duration, dtype: <span class="built_in">bool</span></span><br></pre></td></tr></table></figure>
<p><code>df.iloc[]</code>只能使用整数索引，不能使用标签索引，通过整数索引切片选择数据时，前闭后开(不包含边界结束值)。同<code>Python</code>和<code>NumPy</code>一样，它们的索引都是从0开始。</p>
<p><code>.iloc[]</code>提供了以下方式来选择数据：</p>
<ul>
<li>整数索引</li>
<li>整数列表</li>
<li>数值范围</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: [<span class="string">&#x27;Tom&#x27;</span>, <span class="string">&#x27;Rose&#x27;</span>, <span class="string">&#x27;Mike&#x27;</span>, <span class="string">&#x27;Twg&#x27;</span>],</span><br><span class="line">  <span class="string">&quot;calories&quot;</span>: [<span class="number">420</span>, <span class="number">380</span>, <span class="number">390</span>, <span class="number">500</span>],</span><br><span class="line">  <span class="string">&quot;duration&quot;</span>: [<span class="number">50</span>, <span class="number">40</span>, <span class="number">45</span>, <span class="number">60</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 数据载入到 DataFrame 对象</span></span><br><span class="line">df = pd.DataFrame(data, index = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="built_in">print</span>(df.iloc[<span class="number">2</span>:,:])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="built_in">print</span>(df.iloc[[<span class="number">0</span>,<span class="number">2</span>],[<span class="number">1</span>,<span class="number">2</span>]])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="built_in">print</span>(df.iloc[:,:<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">   name  calories  duration</span><br><span class="line">a   Tom       <span class="number">420</span>        <span class="number">50</span></span><br><span class="line">b  Rose       <span class="number">380</span>        <span class="number">40</span></span><br><span class="line">c  Mike       <span class="number">390</span>        <span class="number">45</span></span><br><span class="line">d   Twg       <span class="number">500</span>        <span class="number">60</span></span><br><span class="line">********************</span><br><span class="line">   name  calories  duration</span><br><span class="line">c  Mike       <span class="number">390</span>        <span class="number">45</span></span><br><span class="line">d   Twg       <span class="number">500</span>        <span class="number">60</span></span><br><span class="line">********************</span><br><span class="line">   calories  duration</span><br><span class="line">a       <span class="number">420</span>        <span class="number">50</span></span><br><span class="line">c       <span class="number">390</span>        <span class="number">45</span></span><br><span class="line">********************</span><br><span class="line">   name  calories</span><br><span class="line">a   Tom       <span class="number">420</span></span><br><span class="line">b  Rose       <span class="number">380</span></span><br><span class="line">c  Mike       <span class="number">390</span></span><br><span class="line">d   Twg       <span class="number">500</span></span><br></pre></td></tr></table></figure>
<h3 id="日期时间操作">👀日期时间操作</h3>
<h4 id="pandas时间序列">👁Pandas时间序列</h4>
<p>顾名思义，时间序列（<code>time series</code>），就是由时间构成的序列，它指的是在一定时间内按照时间顺序测量的某个变量的取值序列，比如一天内的温度会随时间而发生变化，或者股票的价格会随着时间不断的波动，这里用到的一系列时间，就可以看做时间序列。时间序列包含三种应用场景，分别是：</p>
<ul>
<li>特定的时刻（<code>timestamp</code>），也就是时间戳；</li>
<li>固定的日期（<code>period</code>），比如某年某月某日；</li>
<li>时间间隔（<code>interval</code>），每隔一段时间具有规律性；</li>
</ul>
<p>在处理时间序列的过程中，我们一般会遇到两个问题，第一，如何创建时间序列；第二，如何更改已生成时间序列的频率。 <code>Pandas</code>为解决上述问题提供了一套简单、易用的方法。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Python内置的datetime模块来获取当前时间，通过该模块提供的now()方法即可实现。</span></span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="comment"># 数据类型为datetime</span></span><br><span class="line"><span class="built_in">print</span>(datetime.now())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line"><span class="number">2023</span>-03-<span class="number">19</span> <span class="number">17</span>:<span class="number">42</span>:<span class="number">39.528176</span></span><br></pre></td></tr></table></figure>
<p>创建时间戳：<code>TimeStamp</code>（时间戳） 是时间序列中的最基本的数据类型，它将数值与时间点完美结合在一起。</p>
<p>创建时间间隔：通过<code>date_range()</code>方法可以创建某段连续的时间或者固定间隔的时间时间段。该函数提供了三个参数，分别是：<code>start</code>开始时间；<code>end</code>结束时间；<code>freq</code>时间频率，默认为 "D"（天）。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="comment"># 创建时间戳</span></span><br><span class="line"><span class="built_in">print</span>(pd.Timestamp(<span class="string">&#x27;2023-03-16&#x27;</span>))</span><br><span class="line"><span class="comment"># 可以将整型或浮点型表示的时间转换为时间戳。默认的单位是纳秒(时间戳单位)</span></span><br><span class="line"><span class="built_in">print</span>(pd.Timestamp(<span class="number">1687687255</span>,unit=<span class="string">&#x27;s&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 创建时间范围，freq表示时间频率，每30min变化一次</span></span><br><span class="line"><span class="built_in">print</span>(pd.date_range(<span class="string">&quot;9:00&quot;</span>, <span class="string">&quot;18:10&quot;</span>, freq=<span class="string">&quot;30min&quot;</span>).time)</span><br><span class="line"><span class="comment"># 修改为按小时</span></span><br><span class="line"><span class="built_in">print</span>(pd.date_range(<span class="string">&quot;9:00&quot;</span>, <span class="string">&quot;18:10&quot;</span>, freq=<span class="string">&quot;H&quot;</span>).time)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 使用to_datetime()函数将series或list转换为日期对象，其中list会转换为DatetimeIndex</span></span><br><span class="line"><span class="comment"># 输出中，注意：NaT表示的不是时间 ，它等效于NaN</span></span><br><span class="line"><span class="comment"># 传入series，生成Datetimeindex</span></span><br><span class="line"><span class="built_in">print</span>(pd.to_datetime(pd.Series([<span class="string">&#x27;Jun 3, 2020&#x27;</span>,<span class="string">&#x27;2020-12-10&#x27;</span>, <span class="literal">None</span>])))</span><br><span class="line"><span class="comment"># 传入list，生成Datetimeindex</span></span><br><span class="line"><span class="built_in">print</span>(pd.to_datetime([<span class="string">&#x27;Jun 30, 2020&#x27;</span>,<span class="string">&#x27;2020-12-10&#x27;</span>, <span class="literal">None</span>]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line"><span class="number">2023</span>-03-<span class="number">16</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line"><span class="number">2023</span>-06-<span class="number">25</span> <span class="number">10</span>:<span class="number">00</span>:<span class="number">55</span></span><br><span class="line">********************</span><br><span class="line">[datetime.time(<span class="number">9</span>, <span class="number">0</span>) datetime.time(<span class="number">9</span>, <span class="number">30</span>) datetime.time(<span class="number">10</span>, <span class="number">0</span>)</span><br><span class="line"> datetime.time(<span class="number">10</span>, <span class="number">30</span>) datetime.time(<span class="number">11</span>, <span class="number">0</span>) datetime.time(<span class="number">11</span>, <span class="number">30</span>)</span><br><span class="line"> datetime.time(<span class="number">12</span>, <span class="number">0</span>) datetime.time(<span class="number">12</span>, <span class="number">30</span>) datetime.time(<span class="number">13</span>, <span class="number">0</span>)</span><br><span class="line"> datetime.time(<span class="number">13</span>, <span class="number">30</span>) datetime.time(<span class="number">14</span>, <span class="number">0</span>) datetime.time(<span class="number">14</span>, <span class="number">30</span>)</span><br><span class="line"> datetime.time(<span class="number">15</span>, <span class="number">0</span>) datetime.time(<span class="number">15</span>, <span class="number">30</span>) datetime.time(<span class="number">16</span>, <span class="number">0</span>)</span><br><span class="line"> datetime.time(<span class="number">16</span>, <span class="number">30</span>) datetime.time(<span class="number">17</span>, <span class="number">0</span>) datetime.time(<span class="number">17</span>, <span class="number">30</span>)</span><br><span class="line"> datetime.time(<span class="number">18</span>, <span class="number">0</span>)]</span><br><span class="line">[datetime.time(<span class="number">9</span>, <span class="number">0</span>) datetime.time(<span class="number">10</span>, <span class="number">0</span>) datetime.time(<span class="number">11</span>, <span class="number">0</span>)</span><br><span class="line"> datetime.time(<span class="number">12</span>, <span class="number">0</span>) datetime.time(<span class="number">13</span>, <span class="number">0</span>) datetime.time(<span class="number">14</span>, <span class="number">0</span>)</span><br><span class="line"> datetime.time(<span class="number">15</span>, <span class="number">0</span>) datetime.time(<span class="number">16</span>, <span class="number">0</span>) datetime.time(<span class="number">17</span>, <span class="number">0</span>)</span><br><span class="line"> datetime.time(<span class="number">18</span>, <span class="number">0</span>)]</span><br><span class="line">********************</span><br><span class="line"><span class="number">0</span>   <span class="number">2020</span>-06-03</span><br><span class="line"><span class="number">1</span>   <span class="number">2020</span>-<span class="number">12</span>-<span class="number">10</span></span><br><span class="line"><span class="number">2</span>          NaT</span><br><span class="line">dtype: datetime64[ns]</span><br><span class="line">DatetimeIndex([<span class="string">&#x27;2020-06-30&#x27;</span>, <span class="string">&#x27;2020-12-10&#x27;</span>, <span class="string">&#x27;NaT&#x27;</span>], dtype=<span class="string">&#x27;datetime64[ns]&#x27;</span>, freq=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>
<p>频率和周期转换：<code>Time Periods</code>表示时间跨度，一段时间周期，它被定义在<code>Pandas Periods</code>类中，通过该类提供的方法可以实现将频率转换为周期。比如<code>Periods()</code>方法，可以将频率 "<code>M</code>"（月）转换为 <code>Period</code>（时间段）。使用<code>asfreq()</code>和<code>start</code>参数，打印 "<code>01</code>" ，若使用<code>end</code>参数，则打印 "<code>31</code>"。对于常用的时间序列频率，<code>Pandas</code>为其规定了一些字符串别名，我们将这些别名称为“<code>offset</code>（偏移量）”。</p>
<table>
<thead>
<tr class="header">
<th>别名</th>
<th>描述</th>
<th>别名</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>B</code></td>
<td>工作日频率</td>
<td><code>BQS</code></td>
<td>工作季度开始频率</td>
</tr>
<tr class="even">
<td><code>D</code></td>
<td>日历日频率</td>
<td><code>A</code></td>
<td>年终频率</td>
</tr>
<tr class="odd">
<td><code>W</code></td>
<td>每周频率</td>
<td><code>BA</code></td>
<td>工作年度结束频率</td>
</tr>
<tr class="even">
<td><code>M</code></td>
<td>月末频率</td>
<td><code>BAS</code></td>
<td>工作年度开始频率</td>
</tr>
<tr class="odd">
<td><code>SM</code></td>
<td>半月结束频率</td>
<td><code>BH</code></td>
<td>营业时间频率</td>
</tr>
<tr class="even">
<td><code>BM</code></td>
<td>工作月结束频率</td>
<td><code>H</code></td>
<td>小时频率</td>
</tr>
<tr class="odd">
<td><code>MS</code></td>
<td>月开始频率</td>
<td><code>T,min</code></td>
<td>每分钟频率</td>
</tr>
<tr class="even">
<td><code>SMS</code></td>
<td>半月开始频率</td>
<td><code>S</code></td>
<td>每秒钟频率</td>
</tr>
<tr class="odd">
<td><code>BMS</code></td>
<td>工作月开始频率</td>
<td><code>L,ms</code></td>
<td>毫秒</td>
</tr>
<tr class="even">
<td><code>Q</code></td>
<td>季末频率</td>
<td><code>U,us</code></td>
<td>微秒</td>
</tr>
<tr class="odd">
<td><code>BQ</code></td>
<td>工作季度结束频率</td>
<td><code>N</code></td>
<td>纳秒</td>
</tr>
<tr class="even">
<td><code>QS</code></td>
<td>季度开始频率</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>周期计算：指的是对时间周期进行算术运算，所有的操作将在“频率”的基础上执行。</p>
<p>创建时间周期：可以使用<code>period_range()</code>方法来创建时间周期范围。</p>
<p>时间序列转换：如果想要把字符串日期转换为<code>Period</code>，首先需要将字符串转换为日期格式，然后再将日期转换为<code>Period</code>。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd </span><br><span class="line"><span class="comment"># S表示秒</span></span><br><span class="line">x = pd.Period(<span class="string">&#x27;2014&#x27;</span>, freq=<span class="string">&#x27;S&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line"><span class="comment"># 加1s的时间</span></span><br><span class="line"><span class="built_in">print</span>(x+<span class="number">1</span>)</span><br><span class="line"><span class="comment"># 使用period_range()方法来创建时间周期范围</span></span><br><span class="line">p = pd.period_range(<span class="string">&#x27;2016&#x27;</span>,<span class="string">&#x27;2018&#x27;</span>, freq=<span class="string">&#x27;Y&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line"><span class="number">2014</span>-01-01 <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line"><span class="number">2014</span>-01-01 <span class="number">00</span>:<span class="number">00</span>:01</span><br><span class="line">PeriodIndex([<span class="string">&#x27;2016&#x27;</span>, <span class="string">&#x27;2017&#x27;</span>, <span class="string">&#x27;2018&#x27;</span>], dtype=<span class="string">&#x27;period[A-DEC]&#x27;</span>, freq=<span class="string">&#x27;A-DEC&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="日期时间格式化">👁日期时间格式化</h4>
<p>当进行数据分析时，我们会遇到很多带有日期、时间格式的数据集，在处理这些数据集时，可能会遇到日期格式不统一的问题，此时就需要对日期时间做统一的格式化处理。比如"<code>Wednesday, June 6, 2020</code>"可以写成"<code>6/6/20</code>"，或者写成"<code>06-06-2020</code>"。</p>
<p>（1）日期格式化符号</p>
<p>在对时间进行格式化处理时，它们都有固定的表示格式，比如小时的格式化符号为<code>%H</code> ,分钟简写为<code>%M</code> ，秒简写为<code>%S</code>。</p>
<table>
<thead>
<tr class="header">
<th>符号</th>
<th>说明</th>
<th>符号</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>%y</code></td>
<td>两位数的年份表示（00-99）</td>
<td><code>%Y</code></td>
<td>四位数的年份表示（000-9999）</td>
</tr>
<tr class="even">
<td><code>%m</code></td>
<td>月份（01-12）</td>
<td><code>%d</code></td>
<td>月内中的一天（0-31）</td>
</tr>
<tr class="odd">
<td><code>%H</code></td>
<td>24小时制小时数（0-23）</td>
<td><code>%I</code></td>
<td>12小时制小时数（01-12）</td>
</tr>
<tr class="even">
<td><code>%M</code></td>
<td>分钟数（00=59）</td>
<td><code>%S</code></td>
<td>秒（00-59）</td>
</tr>
<tr class="odd">
<td><code>%a</code></td>
<td>本地英文缩写星期名称</td>
<td><code>%A</code></td>
<td>本地英文完整星期名称</td>
</tr>
<tr class="even">
<td><code>%b</code></td>
<td>本地缩写英文的月份名称</td>
<td><code>%B</code></td>
<td>本地完整英文的月份名称</td>
</tr>
<tr class="odd">
<td><code>%w</code></td>
<td>星期（0-6），星期天为星期的开始</td>
<td><code>%W</code></td>
<td>一年中的星期数（00-53）星期一为星期的开始</td>
</tr>
<tr class="even">
<td><code>%x</code></td>
<td>本地相应的日期表示</td>
<td><code>%X</code></td>
<td>本地相应的时间表示</td>
</tr>
<tr class="odd">
<td><code>%Z</code></td>
<td>当前时区的名称</td>
<td><code>%U</code></td>
<td>一年中的星期数（00-53）星期天为星期的开始</td>
</tr>
<tr class="even">
<td><code>%j</code></td>
<td>年内的一天（001-366）</td>
<td><code>%c</code></td>
<td>本地相应的日期表示和时间表示</td>
</tr>
</tbody>
</table>
<p>（2）日期格式化处理函数</p>
<p><code>Python</code>内置的<code>strptime()</code>方法能够将字符串日期转换为<code>datetime</code>类型。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="comment"># 将日期定义为字符串    </span></span><br><span class="line">date_str1 = <span class="string">&#x27;Wednesday,July 18,2020&#x27;</span> </span><br><span class="line">date_str2 = <span class="string">&#x27;18/7/20&#x27;</span> </span><br><span class="line">date_str3 = <span class="string">&#x27;18-07-2020&#x27;</span>  </span><br><span class="line"><span class="comment"># 将日期转化为datetime对象 </span></span><br><span class="line">dmy_dt1 = datetime.strptime(date_str1, <span class="string">&#x27;%A,%B %d,%Y&#x27;</span>) </span><br><span class="line">dmy_dt2 = datetime.strptime(date_str2, <span class="string">&#x27;%d/%m/%y&#x27;</span>) </span><br><span class="line">dmy_dt3 = datetime.strptime(date_str3, <span class="string">&#x27;%d-%m-%Y&#x27;</span>)  </span><br><span class="line"><span class="comment"># 处理为相同格式，并打印输出</span></span><br><span class="line"><span class="built_in">print</span>(dmy_dt1) </span><br><span class="line"><span class="built_in">print</span>(dmy_dt2) </span><br><span class="line"><span class="built_in">print</span>(dmy_dt3) </span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line"><span class="number">2020</span>-07-<span class="number">18</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line"><span class="number">2020</span>-07-<span class="number">18</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line"><span class="number">2020</span>-07-<span class="number">18</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br></pre></td></tr></table></figure>
<p>除了使用<code>Python</code>内置的<code>strptime()</code>方法外，你还可以使用<code>Pandas</code>模块的<code>pd.to_datetime()</code>和<code>pd.DatetimeIndex()</code>进行转换。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="comment"># 通过to_datetime()直接转换为 datetime 类型</span></span><br><span class="line">date1 = [<span class="string">&#x27;2012-05-06 11:00:00&#x27;</span>,<span class="string">&#x27;2012-05-16 11:00:00&#x27;</span>]</span><br><span class="line">pd_date1 = pd.to_datetime(date1)</span><br><span class="line">df1 = pd.Series(np.random.randn(<span class="number">2</span>),index=pd_date1)</span><br><span class="line"><span class="built_in">print</span>(pd_date1)</span><br><span class="line"><span class="built_in">print</span>(df1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 使用Datetimeindex()函数设置时间序</span></span><br><span class="line">date2 = pd.DatetimeIndex([<span class="string">&#x27;1/1/2008&#x27;</span>, <span class="string">&#x27;1/2/2008&#x27;</span>, <span class="string">&#x27;1/3/2008&#x27;</span>, <span class="string">&#x27;1/4/2008&#x27;</span>, <span class="string">&#x27;1/5/2008&#x27;</span>])</span><br><span class="line">dt2 = pd.DataFrame(np.random.randn(<span class="number">5</span>),index=date2, columns=[<span class="string">&#x27;value&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(date2)</span><br><span class="line"><span class="built_in">print</span>(dt2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">DatetimeIndex([<span class="string">&#x27;2012-05-06 11:00:00&#x27;</span>, <span class="string">&#x27;2012-05-16 11:00:00&#x27;</span>], dtype=<span class="string">&#x27;datetime64[ns]&#x27;</span>, freq=<span class="literal">None</span>)</span><br><span class="line"><span class="number">2012</span>-05-06 <span class="number">11</span>:<span class="number">00</span>:<span class="number">00</span>    <span class="number">2.115566</span></span><br><span class="line"><span class="number">2012</span>-05-<span class="number">16</span> <span class="number">11</span>:<span class="number">00</span>:<span class="number">00</span>   -<span class="number">0.145139</span></span><br><span class="line">dtype: float64</span><br><span class="line">********************</span><br><span class="line">DatetimeIndex([<span class="string">&#x27;2008-01-01&#x27;</span>, <span class="string">&#x27;2008-01-02&#x27;</span>, <span class="string">&#x27;2008-01-03&#x27;</span>, <span class="string">&#x27;2008-01-04&#x27;</span>,</span><br><span class="line">               <span class="string">&#x27;2008-01-05&#x27;</span>],</span><br><span class="line">              dtype=<span class="string">&#x27;datetime64[ns]&#x27;</span>, freq=<span class="literal">None</span>)</span><br><span class="line">               value</span><br><span class="line"><span class="number">2008</span>-01-01  <span class="number">0.828022</span></span><br><span class="line"><span class="number">2008</span>-01-02 -<span class="number">1.873516</span></span><br><span class="line"><span class="number">2008</span>-01-03  <span class="number">1.940921</span></span><br><span class="line"><span class="number">2008</span>-01-04  <span class="number">1.563612</span></span><br><span class="line"><span class="number">2008</span>-01-05  <span class="number">0.964914</span></span><br></pre></td></tr></table></figure>
<h4 id="timedelta时间差">👁Timedelta时间差</h4>
<p><code>Timedelta</code>表示时间差（或者时间增量），我们可以使用不同的时间单位来表示它，比如，天、小时、分、秒。时间差的最终的结果可以是正时间差，也可以是负时间差。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="comment"># 通过传递字符串可以创建Timedelta对象</span></span><br><span class="line"><span class="built_in">print</span>(pd.Timedelta(<span class="string">&#x27;5 days 8 hours 6 minutes 59 seconds&#x27;</span>))</span><br><span class="line"><span class="comment"># 通过传递整数值和unit参数也可以创建一个Timedelta对象。</span></span><br><span class="line"><span class="built_in">print</span>(pd.Timedelta(<span class="number">19</span>,unit=<span class="string">&#x27;h&#x27;</span>))</span><br><span class="line"><span class="comment"># 数据偏移量， 比如，周(weeks)、天(days)、小时(hours)、分钟(minutes)、秒(milliseconds)、毫秒、微秒、纳秒都可以使用。</span></span><br><span class="line"><span class="built_in">print</span>(pd.Timedelta(days=<span class="number">2</span>,hours=<span class="number">6</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 您可以使用pd.to_timedelta()方法，将具有timedelta格式的值 (标量、数组、列表或Series）转换为Timedelta类型。如果输入是Series，则返回Series；如果输入是标量，则返回值也为标量，其他情况输出TimedeltaIndex。</span></span><br><span class="line"><span class="built_in">print</span>(pd.to_timedelta([<span class="string">&#x27;1 days 06:05:01.00003&#x27;</span>, <span class="string">&#x27;15.5us&#x27;</span>, <span class="string">&#x27;nan&#x27;</span>]))</span><br><span class="line"><span class="built_in">print</span>(pd.to_timedelta(np.arange(<span class="number">5</span>), unit=<span class="string">&#x27;s&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line"><span class="number">5</span> days 08:06:<span class="number">59</span></span><br><span class="line"><span class="number">0</span> days <span class="number">19</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line"><span class="number">2</span> days 06:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line">********************</span><br><span class="line">TimedeltaIndex([<span class="string">&#x27;1 days 06:05:01.000030&#x27;</span>, <span class="string">&#x27;0 days 00:00:00.000015&#x27;</span>, NaT], dtype=<span class="string">&#x27;timedelta64[ns]&#x27;</span>, freq=<span class="literal">None</span>)</span><br><span class="line">TimedeltaIndex([<span class="string">&#x27;00:00:00&#x27;</span>, <span class="string">&#x27;00:00:01&#x27;</span>, <span class="string">&#x27;00:00:02&#x27;</span>, <span class="string">&#x27;00:00:03&#x27;</span>, <span class="string">&#x27;00:00:04&#x27;</span>], dtype=<span class="string">&#x27;timedelta64[ns]&#x27;</span>, freq=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>
<p>通过对<code>datetime64[ns]</code>类型的时间序列或时间戳做算术运算，其运算结果依然是<code>datetime64[ns]</code>数据类型。接下来，我们创建一个带有<code>Timedelta</code>与<code>datetime</code>的<code>DataFrame</code>对象，并对其做一些算术运算。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">s = pd.Series(pd.date_range(<span class="string">&#x27;2020-1-1&#x27;</span>, periods=<span class="number">5</span>, freq=<span class="string">&#x27;D&#x27;</span>))</span><br><span class="line"><span class="comment"># 推导式用法</span></span><br><span class="line">td = pd.Series([ pd.Timedelta(days=i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)])</span><br><span class="line">df = pd.DataFrame(<span class="built_in">dict</span>(A = s, B = td))</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 加法运算</span></span><br><span class="line">df[<span class="string">&#x27;C&#x27;</span>]=df[<span class="string">&#x27;A&#x27;</span>]+df[<span class="string">&#x27;B&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 减法运算</span></span><br><span class="line">df[<span class="string">&#x27;D&#x27;</span>]=df[<span class="string">&#x27;C&#x27;</span>]-df[<span class="string">&#x27;B&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">           A      B</span><br><span class="line"><span class="number">0</span> <span class="number">2020</span>-01-01 <span class="number">0</span> days</span><br><span class="line"><span class="number">1</span> <span class="number">2020</span>-01-02 <span class="number">1</span> days</span><br><span class="line"><span class="number">2</span> <span class="number">2020</span>-01-03 <span class="number">2</span> days</span><br><span class="line"><span class="number">3</span> <span class="number">2020</span>-01-04 <span class="number">3</span> days</span><br><span class="line"><span class="number">4</span> <span class="number">2020</span>-01-05 <span class="number">4</span> days</span><br><span class="line">********************</span><br><span class="line">           A      B          C</span><br><span class="line"><span class="number">0</span> <span class="number">2020</span>-01-01 <span class="number">0</span> days <span class="number">2020</span>-01-01</span><br><span class="line"><span class="number">1</span> <span class="number">2020</span>-01-02 <span class="number">1</span> days <span class="number">2020</span>-01-03</span><br><span class="line"><span class="number">2</span> <span class="number">2020</span>-01-03 <span class="number">2</span> days <span class="number">2020</span>-01-05</span><br><span class="line"><span class="number">3</span> <span class="number">2020</span>-01-04 <span class="number">3</span> days <span class="number">2020</span>-01-07</span><br><span class="line"><span class="number">4</span> <span class="number">2020</span>-01-05 <span class="number">4</span> days <span class="number">2020</span>-01-09</span><br><span class="line">********************</span><br><span class="line">           A      B          C          D</span><br><span class="line"><span class="number">0</span> <span class="number">2020</span>-01-01 <span class="number">0</span> days <span class="number">2020</span>-01-01 <span class="number">2020</span>-01-01</span><br><span class="line"><span class="number">1</span> <span class="number">2020</span>-01-02 <span class="number">1</span> days <span class="number">2020</span>-01-03 <span class="number">2020</span>-01-02</span><br><span class="line"><span class="number">2</span> <span class="number">2020</span>-01-03 <span class="number">2</span> days <span class="number">2020</span>-01-05 <span class="number">2020</span>-01-03</span><br><span class="line"><span class="number">3</span> <span class="number">2020</span>-01-04 <span class="number">3</span> days <span class="number">2020</span>-01-07 <span class="number">2020</span>-01-04</span><br><span class="line"><span class="number">4</span> <span class="number">2020</span>-01-05 <span class="number">4</span> days <span class="number">2020</span>-01-09 <span class="number">2020</span>-01-05</span><br></pre></td></tr></table></figure>
<h3 id="数据样本处理">👀数据样本处理</h3>
<h4 id="pandas缺失值处理">👁Pandas缺失值处理</h4>
<p>稀疏数据，指的是在数据库或者数据集中存在大量缺失数据或者空值，我们把这样的数据集称为稀疏数据集。稀疏数据不是无效数据，只不过是信息不全而已，只要通过适当的方法就可以“变废为宝”。</p>
<p><strong>检查缺失值</strong>：<code>Pandas</code>提供了<code>isnull()</code>和<code>notnull()</code>两个函数，它们同时适用于<code>Series</code>和<code>DataFrame</code>对象。</p>
<p><strong>缺失数据计算</strong>：计算缺失数据时，需要注意两点：首先数据求和时，将NA值视为0，其次，如果要计算的数据为NA，那么结果就是NA。</p>
<p><strong>清理并填充缺失值</strong>：<code>Pandas</code>提供了多种方法来清除缺失值。<code>fillna()</code>函数可以实现用非空数据“填充”<code>NaN</code>值；<code>ffill()</code>向前填充和<code>bfill()</code>向后填充，使用这两个函数也可以处理NA值。<code>replace()</code>将<code>DataFrame</code>中的通用值替换成特定值。</p>
<p><strong>删除缺失值</strong>：使用<code>dropna()</code>函数与参数<code>axis</code>可以实现删除缺失值。在默认情况下，按照<code>axis=0</code>来按行处理，这意味着如果某一行中存在<code>NaN</code>值将会删除整行数据。</p>
<h4 id="pandas随机样本选择">👁Pandas随机样本选择</h4>
<p>随机抽样，是统计学中常用的一种方法，它可以帮助我们从大量的数据中快速地构建出一组数据分析模型。在<code>Pandas</code>中，如果想要对数据集进行随机抽样，需要使用<code>sample()</code>函数。该函数返回与数据集类型相同的新对象，相当于<code>numpy.random.choice()</code>。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">DataFrame.sample(n=<span class="literal">None</span>,frac=<span class="literal">None</span>,replace=<span class="literal">False</span>,weights=<span class="literal">None</span>,random_state=<span class="literal">None</span>,axis=<span class="literal">None</span>)</span><br><span class="line">参数说明</span><br><span class="line">n		表示要抽取的行数。</span><br><span class="line">frac	表示抽取的比例，比如frac=<span class="number">0.5</span>，代表抽取总体数据的<span class="number">50</span>%。</span><br><span class="line">replace	布尔值参数，表示是否以有放回抽样的方式进行选择，默认为<span class="literal">False</span>，取出数据后不再放回。</span><br><span class="line">weights	可选参数，代表每个样本的权重值，参数值是字符串或者数组。</span><br><span class="line">random_state 可选参数，控制随机状态，默认为<span class="literal">None</span>，表示随机数据不会重复；若为<span class="number">1</span>表示会取得重复数据。</span><br><span class="line">axis	表示在哪个方向上抽取数据(axis=<span class="number">1</span>表示列/axis=<span class="number">0</span>表示行)。</span><br></pre></td></tr></table></figure>
<h4 id="pandas数据重采样">👁Pandas数据重采样</h4>
<p>数据重采样是将时间序列从一个频率转换至另一个频率的过程，它主要有两种实现方式，分别是降采样和升采样，降采样指将高频率的数据转换为低频率，升采样则与其恰好相反，说明如下：</p>
<table>
<thead>
<tr class="header">
<th>方法</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>降采样</td>
<td>将高频率(间隔短)数据转换为低频率(间隔长)。</td>
</tr>
<tr class="even">
<td>升采样</td>
<td>将低频率数据转换为高频率。</td>
</tr>
</tbody>
</table>
<p><code>Pandas</code>提供了<code>resample()</code>函数来实现数据的重采样。</p>
<p><code>asfreq()</code>方法不仅能够实现频率转换，还可以保留原频率对应的数值，同时它也可以单独使用。</p>
<p>插值处理，升采样的结果会产生缺失值，那么就需要对缺失值进行处理，一般有以下几种处理方式：</p>
<table>
<thead>
<tr class="header">
<th>方法</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>pad/ffill</code></td>
<td>用前一个非缺失值去填充缺失值。</td>
</tr>
<tr class="even">
<td><code>backfill/bfill</code></td>
<td>用后一个非缺失值去填充缺失值。</td>
</tr>
<tr class="odd">
<td><code>interpolater('linear')</code></td>
<td>线性插值方法。</td>
</tr>
<tr class="even">
<td><code>fillna(value)</code></td>
<td>指定一个值去替换缺失值。</td>
</tr>
</tbody>
</table>
<h4 id="pandas分类对象">👁Pandas分类对象</h4>
<p>通常情况下，数据集中会存在许多同一类别的信息，比如相同国家、相同行政编码、相同性别等，当这些相同类别的数据多次出现时，就会给数据处理增添许多麻烦，导致数据集变得臃肿，不能直观、清晰地展示数据。</p>
<p><code>Pandas</code>提供了分类对象（<code>Categorical Object</code>），该对象能够实现有序排列、自动去重的功能，但是它不能执行运算。通过<code>Category</code>的构造函数，您可以创建一个类别对象。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pandas.Categorical(values, categories, ordered)</span><br><span class="line">参数说明</span><br><span class="line">    values：以列表的形式传参，表示要分类的值。</span><br><span class="line">    ordered：布尔值，默认为<span class="literal">False</span>，若为Ture，表示对分类的数据进行排序。</span><br><span class="line">    dtype：返回一个category类型，表示分类对象。</span><br></pre></td></tr></table></figure>
<p><code>describe()</code>：对已经分类的数据使用<code>describe()</code>方法，得到和数据统计相关的摘要信息。</p>
<p><code>categories</code>：使用<code>obj.categories</code>命令可以获取对象的类别信息。</p>
<p><code>Series.cat.categories</code>：对类别实现重命名。</p>
<p><code>Series.cat.add_categories()</code>：追加新类别。</p>
<p><code>Series.cat.remove_categories()</code>：删除不需要的类别。</p>
<h3 id="其它函数">👀其它函数</h3>
<h4 id="pandas统计函数">👁Pandas统计函数</h4>
<p><code>Pandas</code>的本质是统计学原理在计算机领域的一种应用实现，通过编程的方式达到分析、描述数据的目的。而统计函数则是统计学中用于计算和分析数据的一种工具。在数据分析的过程中，使用统计函数有助于我们理解和分析数据。常见的统计函数，比如百分比函数、协方差函数、相关系数等。</p>
<ul>
<li><code>pct_change()</code> ：<code>Series</code>和<code>DatFrames</code>都可以使用<code>pct_change()</code>函数。该函数将每个元素与其前一个元素进行比较，并计算前后数值的百分比变化。默认情况下，<code>pct_change()</code>对列进行操作，如果想要操作行，则需要传递参数<code>axis=1</code>参数。</li>
<li><code>cov()</code>：<code>Series</code>对象提供了一个<code>cov</code>方法用来计算Series对象之间的协方差。同时，该方法也会将缺失值(<code>NAN</code>)自动排除。当应用于<code>DataFrame</code>时，协方差（<code>cov</code>）将计算所有列之间的协方差。</li>
<li><code>corr()</code>：相关系数显示任意两个<code>Series</code>之间的线性关系。<code>Pandas</code>提供了计算相关性的三种方法，分别是<code>pearson(default)</code>、<code>spearman()</code>和<code>kendall()</code>。注意：如果<code>DataFrame</code>存在非数值（<code>NAN</code>），该方法会自动将其删除。</li>
<li><code>rank()</code> ：按照某种规则（升序或者降序）对序列中的元素值排名，该函数的返回值的也是一个序列，包含了原序列中每个元素值的名次。如果序列中包含两个相同的的元素值，那么会为其分配两者的平均排名。</li>
</ul>
<h4 id="pandas窗口函数">👁Pandas窗口函数</h4>
<p>为了能更好地处理数值型数据，<code>Pandas</code>提供了几种窗口函数：</p>
<ul>
<li>移动函数（<code>rolling</code>）</li>
<li>扩展函数（<code>expanding</code>）</li>
<li>指数加权函数（<code>ewm</code>）</li>
</ul>
<blockquote>
<p>窗口是一种形象化的叫法，这些函数在执行操作时，就如同窗口一样在数据区间上移动。</p>
</blockquote>
<p>如何在<code>DataFrame</code>和<code>Series</code>对象上应用窗口函数：</p>
<ul>
<li><p><code>rolling()</code> ：移动窗口函数，它可以与<code>mean</code>、<code>count</code>、<code>sum</code>、<code>median</code>、<code>std</code>等聚合函数一起使用。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">rolling(window=n, min_periods=<span class="literal">None</span>, center=<span class="literal">False</span>)</span><br><span class="line">参数说明</span><br><span class="line">    window	默认值为<span class="number">1</span>，表示窗口的大小，也就是观测值的数量，</span><br><span class="line">    min_periods	表示窗口的最小观察值，默认与window的参数值相等。</span><br><span class="line">    center	是否把中间值做为窗口标准，默认值为<span class="literal">False</span>。</span><br></pre></td></tr></table></figure></li>
<li><p><code>expanding()</code> ：扩展窗口函数，扩展是指由序列的第一个元素开始，逐个向后计算元素的聚合值。</p></li>
<li><p><code>ewm()</code>：（全称 Exponentially Weighted Moving）表示指数加权移动。<code>ewn()</code>函数先会对序列元素做指数加权运算，其次计算加权后的均值。该函数通过指定<code>com</code>、<code>span</code>或者<code>halflife</code>参数来实现指数加权移动。</p></li>
</ul>
<p>在数据分析的过程中，使用窗口函数能够提升数据的准确性，并且使数据曲线的变化趋势更加平滑，从而让数据分析变得更加准确、可靠。</p>
<h4 id="pandas聚合函数">👁Pandas聚合函数</h4>
<p>窗口函数可以与聚合函数一起使用，聚合函数指的是对一组数据求总和、最大值、最小值以及平均值的操作，本节重点讲解聚合函数的应用。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">&#x27;col1&#x27;</span>:[<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>],<span class="string">&#x27;col2&#x27;</span>:[<span class="number">0</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">0</span>],<span class="string">&#x27;col3&#x27;</span>:[<span class="number">4</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">4</span>],<span class="string">&#x27;col4&#x27;</span>:[<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>]&#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 窗口大小为3，min_periods最小观测值为1</span></span><br><span class="line">r1 = df.rolling(window=<span class="number">3</span>,min_periods=<span class="number">1</span>)</span><br><span class="line"><span class="comment"># min_periods默认与window的参数值相等</span></span><br><span class="line">r2 = df.rolling(window=<span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(r1.<span class="built_in">sum</span>())</span><br><span class="line"><span class="built_in">print</span>(r2.<span class="built_in">sum</span>())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 把一个聚合函数传递给DataFrame</span></span><br><span class="line"><span class="comment"># 对整体聚合,使用aggregate()聚合操作</span></span><br><span class="line"><span class="built_in">print</span>(r1.aggregate(np.<span class="built_in">sum</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 对任意某一列聚合</span></span><br><span class="line"><span class="built_in">print</span>(r1[<span class="string">&#x27;col1&#x27;</span>].aggregate(np.<span class="built_in">sum</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 对多列数据聚合</span></span><br><span class="line"><span class="built_in">print</span>(r1[<span class="string">&#x27;col1&#x27;</span>,<span class="string">&#x27;col2&#x27;</span>].aggregate(np.<span class="built_in">sum</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 对单列应用多个函数</span></span><br><span class="line"><span class="built_in">print</span>(r1[<span class="string">&#x27;col1&#x27;</span>].aggregate([np.<span class="built_in">sum</span>,np.mean]))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 对不同列应用多个函数</span></span><br><span class="line"><span class="built_in">print</span>(r1[<span class="string">&#x27;col1&#x27;</span>,<span class="string">&#x27;col2&#x27;</span>].aggregate([np.<span class="built_in">sum</span>,np.mean]))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 对不同列应用不同函数</span></span><br><span class="line"><span class="built_in">print</span>(r1.aggregate(&#123;<span class="string">&#x27;col1&#x27;</span>:np.<span class="built_in">sum</span>,<span class="string">&#x27;col2&#x27;</span>:np.mean&#125;))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line"> col1  col2  col3  col4</span><br><span class="line"><span class="number">0</span>     <span class="number">1</span>     <span class="number">0</span>     <span class="number">4</span>     <span class="number">1</span></span><br><span class="line"><span class="number">1</span>     <span class="number">0</span>     <span class="number">2</span>     <span class="number">0</span>     <span class="number">0</span></span><br><span class="line"><span class="number">2</span>     <span class="number">1</span>     <span class="number">5</span>     <span class="number">4</span>     <span class="number">1</span></span><br><span class="line"><span class="number">3</span>     <span class="number">1</span>     <span class="number">0</span>     <span class="number">4</span>     <span class="number">1</span></span><br><span class="line">********************</span><br><span class="line">   col1  col2  col3  col4</span><br><span class="line"><span class="number">0</span>   <span class="number">1.0</span>   <span class="number">0.0</span>   <span class="number">4.0</span>   <span class="number">1.0</span></span><br><span class="line"><span class="number">1</span>   <span class="number">1.0</span>   <span class="number">2.0</span>   <span class="number">4.0</span>   <span class="number">1.0</span></span><br><span class="line"><span class="number">2</span>   <span class="number">2.0</span>   <span class="number">7.0</span>   <span class="number">8.0</span>   <span class="number">2.0</span></span><br><span class="line"><span class="number">3</span>   <span class="number">2.0</span>   <span class="number">7.0</span>   <span class="number">8.0</span>   <span class="number">2.0</span></span><br><span class="line">   col1  col2  col3  col4</span><br><span class="line"><span class="number">0</span>   NaN   NaN   NaN   NaN</span><br><span class="line"><span class="number">1</span>   NaN   NaN   NaN   NaN</span><br><span class="line"><span class="number">2</span>   <span class="number">2.0</span>   <span class="number">7.0</span>   <span class="number">8.0</span>   <span class="number">2.0</span></span><br><span class="line"><span class="number">3</span>   <span class="number">2.0</span>   <span class="number">7.0</span>   <span class="number">8.0</span>   <span class="number">2.0</span></span><br><span class="line">********************</span><br><span class="line">   col1  col2  col3  col4</span><br><span class="line"><span class="number">0</span>   <span class="number">1.0</span>   <span class="number">0.0</span>   <span class="number">4.0</span>   <span class="number">1.0</span></span><br><span class="line"><span class="number">1</span>   <span class="number">1.0</span>   <span class="number">2.0</span>   <span class="number">4.0</span>   <span class="number">1.0</span></span><br><span class="line"><span class="number">2</span>   <span class="number">2.0</span>   <span class="number">7.0</span>   <span class="number">8.0</span>   <span class="number">2.0</span></span><br><span class="line"><span class="number">3</span>   <span class="number">2.0</span>   <span class="number">7.0</span>   <span class="number">8.0</span>   <span class="number">2.0</span></span><br><span class="line">********************</span><br><span class="line"><span class="number">0</span>    <span class="number">1.0</span></span><br><span class="line"><span class="number">1</span>    <span class="number">1.0</span></span><br><span class="line"><span class="number">2</span>    <span class="number">2.0</span></span><br><span class="line"><span class="number">3</span>    <span class="number">2.0</span></span><br><span class="line">Name: col1, dtype: float64</span><br><span class="line">********************</span><br><span class="line">   col1  col2</span><br><span class="line"><span class="number">0</span>   <span class="number">1.0</span>   <span class="number">0.0</span></span><br><span class="line"><span class="number">1</span>   <span class="number">1.0</span>   <span class="number">2.0</span></span><br><span class="line"><span class="number">2</span>   <span class="number">2.0</span>   <span class="number">7.0</span></span><br><span class="line"><span class="number">3</span>   <span class="number">2.0</span>   <span class="number">7.0</span></span><br><span class="line">********************</span><br><span class="line">   <span class="built_in">sum</span>      mean</span><br><span class="line"><span class="number">0</span>  <span class="number">1.0</span>  <span class="number">1.000000</span></span><br><span class="line"><span class="number">1</span>  <span class="number">1.0</span>  <span class="number">0.500000</span></span><br><span class="line"><span class="number">2</span>  <span class="number">2.0</span>  <span class="number">0.666667</span></span><br><span class="line"><span class="number">3</span>  <span class="number">2.0</span>  <span class="number">0.666667</span></span><br><span class="line">********************</span><br><span class="line">  col1           col2          </span><br><span class="line">   <span class="built_in">sum</span>      mean  <span class="built_in">sum</span>      mean</span><br><span class="line"><span class="number">0</span>  <span class="number">1.0</span>  <span class="number">1.000000</span>  <span class="number">0.0</span>  <span class="number">0.000000</span></span><br><span class="line"><span class="number">1</span>  <span class="number">1.0</span>  <span class="number">0.500000</span>  <span class="number">2.0</span>  <span class="number">1.000000</span></span><br><span class="line"><span class="number">2</span>  <span class="number">2.0</span>  <span class="number">0.666667</span>  <span class="number">7.0</span>  <span class="number">2.333333</span></span><br><span class="line"><span class="number">3</span>  <span class="number">2.0</span>  <span class="number">0.666667</span>  <span class="number">7.0</span>  <span class="number">2.333333</span></span><br><span class="line">********************</span><br><span class="line">   col1      col2</span><br><span class="line"><span class="number">0</span>   <span class="number">1.0</span>  <span class="number">0.000000</span></span><br><span class="line"><span class="number">1</span>   <span class="number">1.0</span>  <span class="number">1.000000</span></span><br><span class="line"><span class="number">2</span>   <span class="number">2.0</span>  <span class="number">2.333333</span></span><br><span class="line"><span class="number">3</span>   <span class="number">2.0</span>  <span class="number">2.333333</span></span><br></pre></td></tr></table></figure>
<h4 id="groupby分组操作">👁groupby分组操作</h4>
<p>在数据分析中，经常会遇到这样的情况：根据某一列（或多列）标签把数据划分为不同的组别，然后再对其进行数据分析。比如，某网站对注册用户的性别或者年龄等进行分组，从而研究出网站用户的画像（特点）。在<code>Pandas</code> 中，要完成数据的分组操作，需要使用<code>groupby()</code>函数，它和<code>SQL</code>的<code>GROUP BY</code>操作非常相似。 在划分出来的组（<code>group</code>）上应用一些统计函数，从而达到数据分析的目的，比如对分组数据进行聚合、转换，或者过滤。这个过程主要包含以下三步：</p>
<ul>
<li>拆分（<code>Spliting</code>）：表示对数据进行分组；</li>
<li>应用（<code>Applying</code>）：对分组数据应用聚合函数，进行相应计算；</li>
<li>合并（<code>Combining</code>）：最后汇总计算结果。</li>
</ul>
<p>使用<code>groupby()</code>可以沿着任意轴分组。您可以把分组时指定的键（<code>key</code>）作为每组的组名，方法如下所示：</p>
<ul>
<li><code>df.groupby("key")</code></li>
<li><code>df.groupby("key",axis=1)</code></li>
<li><code>df.groupby(["key1","key2"])</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">data = &#123;<span class="string">&#x27;name&#x27;</span>: [<span class="string">&#x27;John&#x27;</span>, <span class="string">&#x27;Helen&#x27;</span>, <span class="string">&#x27;John&#x27;</span>, <span class="string">&#x27;Ella&#x27;</span>],</span><br><span class="line">   <span class="string">&#x27;score&#x27;</span>: [<span class="number">82</span>, <span class="number">98</span>, <span class="number">91</span>, <span class="number">87</span>],</span><br><span class="line">   <span class="string">&#x27;option_course&#x27;</span>: [<span class="string">&#x27;C#&#x27;</span>,<span class="string">&#x27;Python&#x27;</span>,<span class="string">&#x27;Java&#x27;</span>,<span class="string">&#x27;C&#x27;</span>]&#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 生成分组groupby对象</span></span><br><span class="line"><span class="built_in">print</span>(df.groupby(<span class="string">&#x27;score&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 查看分组,通过调用groups属性查看分组结果</span></span><br><span class="line"><span class="built_in">print</span>(df.groupby(<span class="string">&#x27;score&#x27;</span>).groups)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 多个列标签分组</span></span><br><span class="line"><span class="built_in">print</span>(df.groupby([<span class="string">&#x27;name&#x27;</span>,<span class="string">&#x27;score&#x27;</span>]).groups)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 通过 get_group()方法可以选择组内的具体数据项</span></span><br><span class="line"><span class="built_in">print</span>(df.groupby(<span class="string">&#x27;score&#x27;</span>).get_group(<span class="number">91</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 遍历分组数据</span></span><br><span class="line">grouped=df.groupby(<span class="string">&#x27;score&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> label, option_course <span class="keyword">in</span> grouped:</span><br><span class="line">	<span class="comment"># 其中key代表分组后字典的键，也就是score</span></span><br><span class="line">    <span class="built_in">print</span>(label)</span><br><span class="line">	<span class="comment"># 字典对应的值选修的科目</span></span><br><span class="line">    <span class="built_in">print</span>(option_course)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 通过agg()函数可以对分组对象应用多个聚合函数</span></span><br><span class="line">grouped_name = df.groupby(<span class="string">&#x27;name&#x27;</span>)</span><br><span class="line">	<span class="comment"># 应用一个聚合函数求均值</span></span><br><span class="line"><span class="built_in">print</span>(grouped_name[<span class="string">&#x27;score&#x27;</span>].agg(np.mean))</span><br><span class="line">	<span class="comment"># 应用多个聚合函数求均值</span></span><br><span class="line"><span class="built_in">print</span>(grouped_name[<span class="string">&#x27;score&#x27;</span>].agg([np.size,np.mean,np.std]))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 组的数据过滤操作,筛选出名字出现超过两次的人名</span></span><br><span class="line"><span class="built_in">print</span>(grouped_name.<span class="built_in">filter</span>(<span class="keyword">lambda</span> x: <span class="built_in">len</span>(x) &gt;= <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">  name  score option_course</span><br><span class="line"><span class="number">0</span>   John     <span class="number">82</span>            C<span class="comment">#</span></span><br><span class="line"><span class="number">1</span>  Helen     <span class="number">98</span>        Python</span><br><span class="line"><span class="number">2</span>   John     <span class="number">91</span>          Java</span><br><span class="line"><span class="number">3</span>   Ella     <span class="number">87</span>             C</span><br><span class="line">********************</span><br><span class="line">&lt;pandas.core.groupby.generic.DataFrameGroupBy <span class="built_in">object</span> at <span class="number">0x000001CB3F4CD948</span>&gt;</span><br><span class="line">********************</span><br><span class="line">&#123;<span class="number">82</span>: Int64Index([<span class="number">0</span>], dtype=<span class="string">&#x27;int64&#x27;</span>), <span class="number">87</span>: Int64Index([<span class="number">3</span>], dtype=<span class="string">&#x27;int64&#x27;</span>), <span class="number">91</span>: Int64Index([<span class="number">2</span>], dtype=<span class="string">&#x27;int64&#x27;</span>), <span class="number">98</span>: Int64Index([<span class="number">1</span>], dtype=<span class="string">&#x27;int64&#x27;</span>)&#125;</span><br><span class="line">********************</span><br><span class="line">&#123;(<span class="string">&#x27;Ella&#x27;</span>, <span class="number">87</span>): Int64Index([<span class="number">3</span>], dtype=<span class="string">&#x27;int64&#x27;</span>), (<span class="string">&#x27;Helen&#x27;</span>, <span class="number">98</span>): Int64Index([<span class="number">1</span>], dtype=<span class="string">&#x27;int64&#x27;</span>), (<span class="string">&#x27;John&#x27;</span>, <span class="number">82</span>): Int64Index([<span class="number">0</span>], dtype=<span class="string">&#x27;int64&#x27;</span>), (<span class="string">&#x27;John&#x27;</span>, <span class="number">91</span>): Int64Index([<span class="number">2</span>], dtype=<span class="string">&#x27;int64&#x27;</span>)&#125;</span><br><span class="line">********************</span><br><span class="line">   name  score option_course</span><br><span class="line"><span class="number">2</span>  John     <span class="number">91</span>          Java</span><br><span class="line">********************</span><br><span class="line"><span class="number">82</span></span><br><span class="line">   name  score option_course</span><br><span class="line"><span class="number">0</span>  John     <span class="number">82</span>            C<span class="comment">#</span></span><br><span class="line"><span class="number">87</span></span><br><span class="line">   name  score option_course</span><br><span class="line"><span class="number">3</span>  Ella     <span class="number">87</span>             C</span><br><span class="line"><span class="number">91</span></span><br><span class="line">   name  score option_course</span><br><span class="line"><span class="number">2</span>  John     <span class="number">91</span>          Java</span><br><span class="line"><span class="number">98</span></span><br><span class="line">    name  score option_course</span><br><span class="line"><span class="number">1</span>  Helen     <span class="number">98</span>        Python</span><br><span class="line">********************</span><br><span class="line">name</span><br><span class="line">Ella     <span class="number">87.0</span></span><br><span class="line">Helen    <span class="number">98.0</span></span><br><span class="line">John     <span class="number">86.5</span></span><br><span class="line">Name: score, dtype: float64</span><br><span class="line">       size  mean       std</span><br><span class="line">name                       </span><br><span class="line">Ella      <span class="number">1</span>  <span class="number">87.0</span>       NaN</span><br><span class="line">Helen     <span class="number">1</span>  <span class="number">98.0</span>       NaN</span><br><span class="line">John      <span class="number">2</span>  <span class="number">86.5</span>  <span class="number">6.363961</span></span><br><span class="line">********************</span><br><span class="line">   name  score option_course</span><br><span class="line"><span class="number">0</span>  John     <span class="number">82</span>            C<span class="comment">#</span></span><br><span class="line"><span class="number">2</span>  John     <span class="number">91</span>          Java</span><br></pre></td></tr></table></figure>
<p>组的转换操作：通过<code>transform()</code>函数可以实现组的转换，在组的行或列上可以执行转换操作，最终会返回一个与组大小相同的索引对象。</p>
<p>组的数据过滤操作：通过<code>filter()</code>函数可以实现数据的筛选，该函数根据定义的条件过滤数据并返回一个新的数据集。</p>
<h4 id="merge合并操作">👁merge合并操作</h4>
<p><code>Pandas</code>提供的<code>merge()</code>函数能够进行高效的合并操作，这与<code>SQL</code>关系型数据库的<code>MERGE</code>用法非常相似。从字面意思上不难理解，<code>merge</code>翻译为“合并”，指的是将两个<code>DataFrame</code>数据表按照指定的规则进行连接，最后拼接成一个新的<code>DataFrame</code>数据表。<code>merge()</code>函数的法格式如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pd.merge(left, right, how=<span class="string">&#x27;inner&#x27;</span>, on=<span class="literal">None</span>, left_on=<span class="literal">None</span>, right_on=<span class="literal">None</span>, left_index=<span class="literal">False</span>, right_index=<span class="literal">False</span>, sort=<span class="literal">True</span>,suffixes=(<span class="string">&#x27;_x&#x27;</span>, <span class="string">&#x27;_y&#x27;</span>), copy=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">参数说明</span><br><span class="line">left/right: 两个不同的DataFrame对象。</span><br><span class="line">on: 指定用于连接的键（即列标签的名字），该键必须同时存在于左右两个DataFrame中，如果没有指定，并且其他参数也未指定， 那么将会以两个DataFrame的列名交集做为连接键。</span><br><span class="line">left_on: 指定左侧DataFrame中作连接键的列名。该参数在左、右列标签名不相同，但表达的含义相同时非常有用。</span><br><span class="line">right_on: 指定左侧DataFrame中作连接键的列名。</span><br><span class="line">left_index: 布尔参数，默认为<span class="literal">False</span>。如果为<span class="literal">True</span> 则使用左侧DataFrame的行索引作为连接键，若DataFrame具有多层索引(MultiIndex)，则层的数量必须与连接键的数量相等。</span><br><span class="line">right_index: 布尔参数，默认为<span class="literal">False</span>。如果为<span class="literal">True</span> 则使用左侧DataFrame的行索引作为连接键。</span><br><span class="line">how: 要执行的合并类型，从&#123;<span class="string">&#x27;left&#x27;</span>,<span class="string">&#x27;right&#x27;</span>,<span class="string">&#x27;outer&#x27;</span>,<span class="string">&#x27;inner&#x27;</span>&#125; 中取值，默认为“inner”内连接。</span><br><span class="line">sort: 布尔值参数，默认为<span class="literal">True</span>，它会将合并后的数据进行排序；若设置为<span class="literal">False</span>，则按照how给定的参数值进行排序。</span><br><span class="line">suffixes: 字符串组成的元组。当左右DataFrame存在相同列名时，通过该参数可以在相同的列名后附加后缀名，默认为(<span class="string">&#x27;_x&#x27;</span>,<span class="string">&#x27;_y&#x27;</span>)。</span><br><span class="line">copy: 默认为<span class="literal">True</span>，表示对数据进行复制。</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意：<code>Pandas</code>库的<code>merge()</code>支持各种内外连接，与其相似的还有<code>join()</code>函数（默认为左连接）。</p>
</blockquote>
<h4 id="concat连接操作">👁concat连接操作</h4>
<p><code>Pandas</code>通过<code>concat()</code>函数能够轻松地将<code>Series</code>与<code>DataFrame</code>对象组合在一起，函数的语法格式如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pd.concat(objs, axis=<span class="number">0</span>, join=<span class="string">&#x27;outer&#x27;</span>, join_axes=<span class="literal">None</span>, ignore_index=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">参数说明</span><br><span class="line">objs: 一个序列或者是Series、DataFrame对象。</span><br><span class="line">axis: 表示在哪个轴方向上（行或者列）进行连接操作，默认axis=<span class="number">0</span>表示行方向。</span><br><span class="line">join: 指定连接方式，取值为&#123;<span class="string">&quot;inner&quot;</span>,<span class="string">&quot;outer&quot;</span>&#125;，默认为outer表示取并集，inner代表取交集。</span><br><span class="line">ignore_index: 布尔值参数，默认为<span class="literal">False</span>，如果为<span class="literal">True</span>，表示不在连接的轴上使用索引。</span><br><span class="line">join_axes: 表示索引对象的列表。</span><br></pre></td></tr></table></figure>
<p><code>append()</code>: 如果要连接<code>Series</code>和<code>DataFrame</code>对象，有一个最方便、快捷的方法，就是<code>append()</code>方法。该方法沿着<code>axis=0</code>（行方向）进行操作；<code>append()</code>函数也可接收多个对象。</p>
<h3 id="pandas绘图">👀Pandas绘图</h3>
<p><code>Pandas</code>对<code>Matplotlib</code>绘图软件包的基础上单独封装了一个<code>plot()</code>接口，通过调用该接口可以实现常用的绘图操作。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="comment"># 创建包含时间序列的数据</span></span><br><span class="line">df = pd.DataFrame(np.random.randn(<span class="number">8</span>,<span class="number">4</span>),index=pd.date_range(<span class="string">&#x27;2/1/2020&#x27;</span>,periods=<span class="number">8</span>), columns=<span class="built_in">list</span>(<span class="string">&#x27;ABCD&#x27;</span>))</span><br><span class="line">df.plot()</span><br><span class="line"><span class="comment"># 如果行索引中包含日期，Pandas会自动调用gct().autofmt_xdate()来格式化x轴。</span></span><br></pre></td></tr></table></figure>
<p>除了使用默认的线条绘图外，您还可以使用其他绘图方式，如下所示：</p>
<ul>
<li>柱状图：<code>bar()</code> 或 <code>barh()</code></li>
<li>直方图：<code>hist()</code></li>
<li>箱状箱：<code>box()</code></li>
<li>区域图：<code>area()</code></li>
<li>散点图：<code>scatter()</code></li>
</ul>
<p>通过关键字参数<code>kind</code>可以把上述方法传递给<code>plot()</code>。</p>
<p>（1）柱状图</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">df = pd.DataFrame(np.random.rand(<span class="number">10</span>,<span class="number">4</span>),columns=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>])</span><br><span class="line"><span class="comment"># 或使用df.plot(kind=&quot;bar&quot;)</span></span><br><span class="line">df.plot.bar()</span><br><span class="line"><span class="comment"># 通过设置参数stacked=True可以生成柱状堆叠图</span></span><br><span class="line"><span class="comment"># 或者使用df.plot.bar(stacked=&quot;True&quot;)</span></span><br><span class="line">df.plot(kind=<span class="string">&quot;bar&quot;</span>,stacked=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># 如果要绘制水平柱状图</span></span><br><span class="line">df.plot.barh(stacked=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>（2）直方图</p>
<p><code>plot.hist()</code>可以实现绘制直方图，并且它还可以指定<code>bins</code>（构成直方图的箱数）。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;A&#x27;</span>:np.random.randn(<span class="number">100</span>)+<span class="number">2</span>,<span class="string">&#x27;B&#x27;</span>:np.random.randn(<span class="number">100</span>),<span class="string">&#x27;C&#x27;</span>:np.random.randn(<span class="number">100</span>)-<span class="number">2</span>,<span class="string">&#x27;D&#x27;</span>:np.random.randn(<span class="number">100</span>)+<span class="number">3</span>&#125;,columns=[<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>,<span class="string">&#x27;D&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="comment"># 指定箱数为15</span></span><br><span class="line">df.plot.hist(bins=<span class="number">15</span>)</span><br><span class="line"><span class="comment"># 给每一列数据都绘制一个直方图</span></span><br><span class="line">df.diff().hist(color=<span class="string">&quot;r&quot;</span>,alpha=<span class="number">0.5</span>,bins=<span class="number">15</span>)</span><br></pre></td></tr></table></figure>
<p>（3）箱线图</p>
<p>通过调用<code>Series.box.plot()</code> 、<code>DataFrame.box.plot()</code>或者<code>DataFrame.boxplot()</code>方法来绘制箱型图，它将每一列数据的分布情况，以可视化的图像展现出来。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">df = pd.DataFrame(np.random.rand(<span class="number">10</span>, <span class="number">4</span>), columns=[<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;D&#x27;</span>])</span><br><span class="line">df.plot.box()</span><br></pre></td></tr></table></figure>
<p>（4）区域图</p>
<p>使用<code>Series.plot.area()</code>或<code>DataFrame.plot.area()</code>方法来绘制区域图。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">df = pd.DataFrame(np.random.rand(<span class="number">5</span>, <span class="number">4</span>), columns=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>])</span><br><span class="line">df.plot.area()</span><br></pre></td></tr></table></figure>
<p>（5）散点图</p>
<p>使用<code>DataFrame.plot.scatter()</code>方法来绘制散点图。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">df = pd.DataFrame(np.random.rand(<span class="number">30</span>, <span class="number">4</span>), columns=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>])</span><br><span class="line">df.plot.scatter(x=<span class="string">&#x27;a&#x27;</span>,y=<span class="string">&#x27;b&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>（6）饼状图</p>
<p>通过<code>DataFrame.plot.pie()</code>方法来绘制。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">df = pd.DataFrame(<span class="number">3</span> * np.random.rand(<span class="number">4</span>), index=[<span class="string">&#x27;go&#x27;</span>, <span class="string">&#x27;java&#x27;</span>, <span class="string">&#x27;c++&#x27;</span>, <span class="string">&#x27;c&#x27;</span>], columns=[<span class="string">&#x27;L&#x27;</span>])</span><br><span class="line">df.plot.pie(subplots=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<h2 id="pandas和numpy的比较">⛄Pandas和NumPy的比较</h2>
<p><code>Pandas</code>和<code>NumPy</code>被认为是科学计算与机器学习中必不可少的库，因为它们具有直观的语法和高性能的矩阵计算能力。</p>
<table>
<thead>
<tr class="header">
<th>比较项</th>
<th>Pandas</th>
<th>NumPy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>适应性</td>
<td><code>Pandas</code>主要用来处理类表格数据。</td>
<td><code>NumPy</code>主要用来处理数值数据。</td>
</tr>
<tr class="even">
<td>工具</td>
<td><code>Pandas</code>提供了<code>Series</code>和<code>DataFrame</code>数据结构。</td>
<td><code>NumPy</code>构建了<code>ndarray array</code>来容纳数据。</td>
</tr>
<tr class="odd">
<td>性能</td>
<td><code>Pandas</code>对于处理50万行以上的数据更具优势。</td>
<td><code>NumPy</code>则对于50万以下或者更少的数据，性能更佳。</td>
</tr>
<tr class="even">
<td>内存利用率</td>
<td>与<code>NumPy</code>相比，<code>Pandas</code>会消耗大量的内存。</td>
<td><code>NumPy</code>会消耗较少的内存。</td>
</tr>
<tr class="odd">
<td>对象</td>
<td><code>Pandas</code>提供了<code>DataFrame 2D</code>数据表对象。</td>
<td><code>NumPy</code>则提供了一个多维数组<code>ndarray</code>对象</td>
</tr>
</tbody>
</table>
<p>在某些情况下，需要执行一些<code>NumPy</code>数值计算的高级函数，这个时候您可以使用<code>to_numpy()</code>函数，将<code>DataFrame</code>对象转换为<code>NumPy ndarray</code>数组，并将其返回。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">DataFrame.to_numpy(dtype=<span class="literal">None</span>, copy=<span class="literal">False</span>)   </span><br><span class="line">参数说明如下：</span><br><span class="line">    dtype：可选参数，表示数据类型；</span><br><span class="line">    copy：布尔值参数，默认值为 Fales，表示返回值不是其他数组的视图。</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd </span><br><span class="line"><span class="comment">#创建DataFrame对象</span></span><br><span class="line">info = pd.DataFrame([[<span class="number">17</span>,<span class="number">62</span>,<span class="number">35</span>],[<span class="number">25</span>,<span class="number">36</span>,<span class="number">54</span>],[<span class="number">42</span>,<span class="number">20</span>,<span class="number">15</span>],[<span class="number">48</span>,<span class="number">62</span>,<span class="number">76</span>]], columns=[<span class="string">&#x27;x&#x27;</span>,<span class="string">&#x27;y&#x27;</span>,<span class="string">&#x27;z&#x27;</span>]) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;DataFrame\n----------\n&#x27;</span>, info) </span><br><span class="line"><span class="comment">#转换DataFrame为数组array</span></span><br><span class="line">arr = info.to_numpy() </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\nNumpy Array\n----------\n&#x27;</span>, arr)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">DataFrame</span><br><span class="line">----------</span><br><span class="line">     x   y   z</span><br><span class="line"><span class="number">0</span>  <span class="number">17</span>  <span class="number">62</span>  <span class="number">35</span></span><br><span class="line"><span class="number">1</span>  <span class="number">25</span>  <span class="number">36</span>  <span class="number">54</span></span><br><span class="line"><span class="number">2</span>  <span class="number">42</span>  <span class="number">20</span>  <span class="number">15</span></span><br><span class="line"><span class="number">3</span>  <span class="number">48</span>  <span class="number">62</span>  <span class="number">76</span></span><br><span class="line"></span><br><span class="line">Numpy Array</span><br><span class="line">----------</span><br><span class="line"> [[<span class="number">17</span> <span class="number">62</span> <span class="number">35</span>]</span><br><span class="line"> [<span class="number">25</span> <span class="number">36</span> <span class="number">54</span>]</span><br><span class="line"> [<span class="number">42</span> <span class="number">20</span> <span class="number">15</span>]</span><br><span class="line"> [<span class="number">48</span> <span class="number">62</span> <span class="number">76</span>]]</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://heartlovelife.github.io">Xiaotangsmiles</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://heartlovelife.github.io/2023/03/07/Python-Pandas/">https://heartlovelife.github.io/2023/03/07/Python-Pandas/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://heartlovelife.github.io" target="_blank">江湖是你画中亦是你</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%A7%91%E5%AD%A6%E8%AE%A1%E7%AE%97/">科学计算</a><a class="post-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">数据分析</a><a class="post-meta__tags" href="/tags/Pandas/">Pandas</a></div><div class="post_share"><div class="social-share" data-image="https://s2.loli.net/2023/02/19/BiQTEHaJbYwIvhd.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/gh/overtrue/share.js@master/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/loading1.gif" data-original="/img/wechat.jpg" alt="wechat(微信)"/></a><div class="post-qr-code-desc">wechat(微信)</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/loading1.gif" data-original="/img/alipay.jpg" alt="alipay(支付宝)"/></a><div class="post-qr-code-desc">alipay(支付宝)</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/03/27/Python-Pandas-RWF/"><img class="prev-cover" src="/img/loading1.gif" data-original="https://s2.loli.net/2023/02/19/BiQTEHaJbYwIvhd.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Python之Pandas读写文件及索引操作</div></div></a></div><div class="next-post pull-right"><a href="/2023/02/13/Python-Numpy/"><img class="next-cover" src="/img/loading1.gif" data-original="https://s2.loli.net/2023/02/19/uvEtzfpj8P9TANy.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Python之NumPy详解</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2023/03/27/Python-Pandas-RWF/" title="Python之Pandas读写文件及索引操作"><img class="cover" src="/img/loading1.gif" data-original="https://s2.loli.net/2023/02/19/BiQTEHaJbYwIvhd.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-27</div><div class="title">Python之Pandas读写文件及索引操作</div></div></a></div><div><a href="/2023/02/13/Python-Numpy/" title="Python之NumPy详解"><img class="cover" src="/img/loading1.gif" data-original="https://s2.loli.net/2023/02/19/uvEtzfpj8P9TANy.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-02-13</div><div class="title">Python之NumPy详解</div></div></a></div><div><a href="/2022/12/17/Matlab-Basic01/" title="Matlab语法基础（01）"><img class="cover" src="/img/loading1.gif" data-original="https://s2.loli.net/2022/12/17/2RZMExnlA8C6vHS.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-17</div><div class="title">Matlab语法基础（01）</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/loading1.gif" data-original="/img/touxiang.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Xiaotangsmiles</div><div class="author-info__description">我们总以为来日方长，却忘了世事无常</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">27</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">27</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/HeartLoveLife"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/HeartLoveLife" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://blog.csdn.net/twg666" target="_blank" title="CSDN"><i class="fa fa-book-open"></i></a><a class="social-icon" href="tencent://AddContact/?fromId=45&amp;fromSubId=1&amp;subcmd=all&amp;uin=491037927&amp;website=www.oicqzone.com" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="mailto:xiaotangsmiles@163.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">我有我自己的太阳、月亮和星星，我有一个完全属于我自己的小世界。</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#pandas%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-number">1.</span> <span class="toc-text">⛄Pandas数据结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pandas-series"><span class="toc-number">2.</span> <span class="toc-text">⛄Pandas Series</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAseries%E5%AF%B9%E8%B1%A1"><span class="toc-number">2.1.</span> <span class="toc-text">👀创建Series对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BF%E9%97%AEseries%E6%95%B0%E6%8D%AE"><span class="toc-number">2.2.</span> <span class="toc-text">👀访问Series数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#series%E5%B8%B8%E7%94%A8%E5%B1%9E%E6%80%A7"><span class="toc-number">2.3.</span> <span class="toc-text">👀Series常用属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#series%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">2.4.</span> <span class="toc-text">👀Series常用方法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pandas-dataframe"><span class="toc-number">3.</span> <span class="toc-text">⛄Pandas DataFrame</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAdf%E5%AF%B9%E8%B1%A1"><span class="toc-number">3.1.</span> <span class="toc-text">👀创建DF对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%97%E7%B4%A2%E5%BC%95%E6%93%8D%E4%BD%9Cdf%E5%AF%B9%E8%B1%A1"><span class="toc-number">3.2.</span> <span class="toc-text">👀列索引操作DF对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%8C%E7%B4%A2%E5%BC%95%E6%93%8D%E4%BD%9Cdf%E5%AF%B9%E8%B1%A1"><span class="toc-number">3.3.</span> <span class="toc-text">👀行索引操作DF对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#df%E5%AF%B9%E8%B1%A1%E5%B1%9E%E6%80%A7%E5%92%8C%E6%96%B9%E6%B3%95"><span class="toc-number">3.4.</span> <span class="toc-text">👀DF对象属性和方法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pandas%E5%87%BD%E6%95%B0%E6%93%8D%E4%BD%9C"><span class="toc-number">4.</span> <span class="toc-text">⛄Pandas函数操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#panel%E7%BB%93%E6%9E%84%E4%BA%86%E8%A7%A3"><span class="toc-number">4.1.</span> <span class="toc-text">👀Panel结构（了解）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%8F%E8%BF%B0%E6%80%A7%E7%BB%9F%E8%AE%A1%E5%87%BD%E6%95%B0"><span class="toc-number">4.2.</span> <span class="toc-text">👀描述性统计函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0"><span class="toc-number">4.3.</span> <span class="toc-text">👀自定义函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#reindex%E9%87%8D%E7%BD%AE%E7%B4%A2%E5%BC%95"><span class="toc-number">4.4.</span> <span class="toc-text">👀reindex重置索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#iteration%E9%81%8D%E5%8E%86%E6%93%8D%E4%BD%9C"><span class="toc-number">4.5.</span> <span class="toc-text">👀iteration遍历操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%92%E5%BA%8F%E5%92%8C%E5%8E%BB%E9%87%8D"><span class="toc-number">4.6.</span> <span class="toc-text">👀排序和去重</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%92%E5%BA%8Fsorting"><span class="toc-number">4.6.1.</span> <span class="toc-text">👁排序sorting</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8E%BB%E9%87%8Ddrop_duplicates"><span class="toc-number">4.6.2.</span> <span class="toc-text">👁去重drop_duplicates()</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%A4%84%E7%90%86"><span class="toc-number">4.7.</span> <span class="toc-text">👀字符串处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E6%95%B0%E6%8D%AE%E6%98%BE%E7%A4%BA%E6%A0%BC%E5%BC%8F"><span class="toc-number">4.8.</span> <span class="toc-text">👀设置数据显示格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#loc%E5%92%8Ciloc%E7%94%A8%E6%B3%95%E8%AF%A6%E8%A7%A3"><span class="toc-number">4.9.</span> <span class="toc-text">👀loc和iloc用法详解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A5%E6%9C%9F%E6%97%B6%E9%97%B4%E6%93%8D%E4%BD%9C"><span class="toc-number">4.10.</span> <span class="toc-text">👀日期时间操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#pandas%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97"><span class="toc-number">4.10.1.</span> <span class="toc-text">👁Pandas时间序列</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%A5%E6%9C%9F%E6%97%B6%E9%97%B4%E6%A0%BC%E5%BC%8F%E5%8C%96"><span class="toc-number">4.10.2.</span> <span class="toc-text">👁日期时间格式化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#timedelta%E6%97%B6%E9%97%B4%E5%B7%AE"><span class="toc-number">4.10.3.</span> <span class="toc-text">👁Timedelta时间差</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%A0%B7%E6%9C%AC%E5%A4%84%E7%90%86"><span class="toc-number">4.11.</span> <span class="toc-text">👀数据样本处理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#pandas%E7%BC%BA%E5%A4%B1%E5%80%BC%E5%A4%84%E7%90%86"><span class="toc-number">4.11.1.</span> <span class="toc-text">👁Pandas缺失值处理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#pandas%E9%9A%8F%E6%9C%BA%E6%A0%B7%E6%9C%AC%E9%80%89%E6%8B%A9"><span class="toc-number">4.11.2.</span> <span class="toc-text">👁Pandas随机样本选择</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#pandas%E6%95%B0%E6%8D%AE%E9%87%8D%E9%87%87%E6%A0%B7"><span class="toc-number">4.11.3.</span> <span class="toc-text">👁Pandas数据重采样</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#pandas%E5%88%86%E7%B1%BB%E5%AF%B9%E8%B1%A1"><span class="toc-number">4.11.4.</span> <span class="toc-text">👁Pandas分类对象</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E5%AE%83%E5%87%BD%E6%95%B0"><span class="toc-number">4.12.</span> <span class="toc-text">👀其它函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#pandas%E7%BB%9F%E8%AE%A1%E5%87%BD%E6%95%B0"><span class="toc-number">4.12.1.</span> <span class="toc-text">👁Pandas统计函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#pandas%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0"><span class="toc-number">4.12.2.</span> <span class="toc-text">👁Pandas窗口函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#pandas%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0"><span class="toc-number">4.12.3.</span> <span class="toc-text">👁Pandas聚合函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#groupby%E5%88%86%E7%BB%84%E6%93%8D%E4%BD%9C"><span class="toc-number">4.12.4.</span> <span class="toc-text">👁groupby分组操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#merge%E5%90%88%E5%B9%B6%E6%93%8D%E4%BD%9C"><span class="toc-number">4.12.5.</span> <span class="toc-text">👁merge合并操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#concat%E8%BF%9E%E6%8E%A5%E6%93%8D%E4%BD%9C"><span class="toc-number">4.12.6.</span> <span class="toc-text">👁concat连接操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pandas%E7%BB%98%E5%9B%BE"><span class="toc-number">4.13.</span> <span class="toc-text">👀Pandas绘图</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pandas%E5%92%8Cnumpy%E7%9A%84%E6%AF%94%E8%BE%83"><span class="toc-number">5.</span> <span class="toc-text">⛄Pandas和NumPy的比较</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/11/16/RS-CSink-Method/" title="碳汇估算方法概述及基于RS的碳汇估算模型详述【20241116】"><img src="/img/loading1.gif" data-original="https://s2.loli.net/2024/11/16/2lwpstimg6HCTod.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="碳汇估算方法概述及基于RS的碳汇估算模型详述【20241116】"/></a><div class="content"><a class="title" href="/2024/11/16/RS-CSink-Method/" title="碳汇估算方法概述及基于RS的碳汇估算模型详述【20241116】">碳汇估算方法概述及基于RS的碳汇估算模型详述【20241116】</a><time datetime="2024-11-16T12:20:20.000Z" title="发表于 2024-11-16 20:20:20">2024-11-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/10/28/Py6S-Model-Use/" title="常见大气校正模型及6S模型安装部署【20241028】"><img src="/img/loading1.gif" data-original="https://s2.loli.net/2024/10/28/mOhXvaL3YTEdMo9.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="常见大气校正模型及6S模型安装部署【20241028】"/></a><div class="content"><a class="title" href="/2024/10/28/Py6S-Model-Use/" title="常见大气校正模型及6S模型安装部署【20241028】">常见大气校正模型及6S模型安装部署【20241028】</a><time datetime="2024-10-28T12:13:14.000Z" title="发表于 2024-10-28 20:13:14">2024-10-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/09/23/Matlab-GUI-Design/" title="GUI编程之MATLAB入门详解（01）"><img src="/img/loading1.gif" data-original="https://s2.loli.net/2024/08/25/u7qX6PLeFUzxHvV.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="GUI编程之MATLAB入门详解（01）"/></a><div class="content"><a class="title" href="/2024/09/23/Matlab-GUI-Design/" title="GUI编程之MATLAB入门详解（01）">GUI编程之MATLAB入门详解（01）</a><time datetime="2024-09-23T14:22:08.000Z" title="发表于 2024-09-23 22:22:08">2024-09-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/09/15/RS-data-dowmload/" title="MODIS/Landsat/Sentinel下载教程详解【常用网站及方法枚举】"><img src="/img/loading1.gif" data-original="https://s2.loli.net/2024/09/15/xhwoIklLQq2mFp8.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MODIS/Landsat/Sentinel下载教程详解【常用网站及方法枚举】"/></a><div class="content"><a class="title" href="/2024/09/15/RS-data-dowmload/" title="MODIS/Landsat/Sentinel下载教程详解【常用网站及方法枚举】">MODIS/Landsat/Sentinel下载教程详解【常用网站及方法枚举】</a><time datetime="2024-09-15T03:24:52.000Z" title="发表于 2024-09-15 11:24:52">2024-09-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/08/25/Python-GUI-Design/" title="GUI编程之PyQt5入门详解（01）"><img src="/img/loading1.gif" data-original="https://s2.loli.net/2024/08/25/u7qX6PLeFUzxHvV.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="GUI编程之PyQt5入门详解（01）"/></a><div class="content"><a class="title" href="/2024/08/25/Python-GUI-Design/" title="GUI编程之PyQt5入门详解（01）">GUI编程之PyQt5入门详解（01）</a><time datetime="2024-08-25T12:36:36.000Z" title="发表于 2024-08-25 20:36:36">2024-08-25</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2024 By Xiaotangsmiles</div><div class="framework-info"><span>地址 </span><a href="https://heartlovelife.github.io">HeartLoveLife</a><span class="footer-separator">|</span><span>邮箱 </span><a href="javascript:void(0);">xiaotangsmiles@163.com</a></div><div class="footer_custom_text">Hi, welcome to my <a href="https://heartlovelife.github.io/">blog</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div>
        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(r){r.imageLazyLoadSetting.processImages=t;var e=r.imageLazyLoadSetting.isSPA,n=r.imageLazyLoadSetting.preloadRatio||1,c=a();function a(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(){e&&(c=a());for(var t,o=0;o<c.length;o++)0<=(t=(t=c[o]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(r.innerHeight*n||document.documentElement.clientHeight*n)&&function(){var t,e,n,a,i=c[o];e=function(){c=c.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(n=new Image,a=t.getAttribute("data-original"),n.onload=function(){t.src=a,t.removeAttribute("data-original"),e&&e()},t.src!==a&&(n.src=a))}()}function i(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",i),r.addEventListener("resize",i),r.addEventListener("orientationchange",i)}(this);</script></body></html>