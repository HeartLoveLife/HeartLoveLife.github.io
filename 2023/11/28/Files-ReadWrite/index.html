<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Python/Matlab/IDL之文件读写操作【CSV/Excel/JSON/XML/TXT】 | 江湖是你画中亦是你</title><meta name="keywords" content="文件读写"><meta name="author" content="Xiaotangsmiles"><meta name="copyright" content="Xiaotangsmiles"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="⛄前言CSV（Comma-Separated Values，逗号分隔值，有时也称为字符分隔值，因为分隔字符也可以不是逗号），其文件以纯文本形式存储表格数据（数字和文本）。纯文本意味着该文件是一个字符序列，不含必须像二进制数字那样被解读的数据。CSV文件由任意数目的记录组成，记录间以某种换行符分隔；每条记录由字段组成，字段间的分隔符是其它字符或字符串，最常见的是逗号或制表符。CSV文件通常以 .cs">
<meta property="og:type" content="article">
<meta property="og:title" content="Python&#x2F;Matlab&#x2F;IDL之文件读写操作【CSV&#x2F;Excel&#x2F;JSON&#x2F;XML&#x2F;TXT】">
<meta property="og:url" content="https://heartlovelife.github.io/2023/11/28/Files-ReadWrite/index.html">
<meta property="og:site_name" content="江湖是你画中亦是你">
<meta property="og:description" content="⛄前言CSV（Comma-Separated Values，逗号分隔值，有时也称为字符分隔值，因为分隔字符也可以不是逗号），其文件以纯文本形式存储表格数据（数字和文本）。纯文本意味着该文件是一个字符序列，不含必须像二进制数字那样被解读的数据。CSV文件由任意数目的记录组成，记录间以某种换行符分隔；每条记录由字段组成，字段间的分隔符是其它字符或字符串，最常见的是逗号或制表符。CSV文件通常以 .cs">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2024/01/17/5fyvO89JhpKPiz4.jpg">
<meta property="article:published_time" content="2023-11-28T12:45:55.000Z">
<meta property="article:modified_time" content="2024-01-20T14:25:35.999Z">
<meta property="article:author" content="Xiaotangsmiles">
<meta property="article:tag" content="文件读写">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2024/01/17/5fyvO89JhpKPiz4.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://heartlovelife.github.io/2023/11/28/Files-ReadWrite/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":250},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Python/Matlab/IDL之文件读写操作【CSV/Excel/JSON/XML/TXT】',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-01-20 22:25:35'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/loading1.gif" data-original="/img/touxiang.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">25</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">25</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><span> 博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/photos/"><span> 相册</span></a></li><li><a class="site-page child" href="/music/"><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><span> 影视</span></a></li><li><a class="site-page child" href="/shuoshuo/"><span> 分享</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://s2.loli.net/2024/01/17/5fyvO89JhpKPiz4.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">江湖是你画中亦是你</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><span> 博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/photos/"><span> 相册</span></a></li><li><a class="site-page child" href="/music/"><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><span> 影视</span></a></li><li><a class="site-page child" href="/shuoshuo/"><span> 分享</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><span> 关于笔者</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Python/Matlab/IDL之文件读写操作【CSV/Excel/JSON/XML/TXT】</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-11-28T12:45:55.000Z" title="发表于 2023-11-28 20:45:55">2023-11-28</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-01-20T14:25:35.999Z" title="更新于 2024-01-20 22:25:35">2024-01-20</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Python/">Python</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/IDL/">IDL</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Matlab/">Matlab</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">21.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>91分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Python/Matlab/IDL之文件读写操作【CSV/Excel/JSON/XML/TXT】"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="⛄前言"><a href="#⛄前言" class="headerlink" title="⛄前言"></a>⛄前言</h2><p><code>CSV</code>（<code>Comma-Separated Values</code>，逗号分隔值，有时也称为<strong>字符分隔值</strong>，因为分隔字符也可以不是逗号），其文件以纯文本形式存储表格数据（数字和文本）。纯文本意味着该文件是一个字符序列，不含必须像二进制数字那样被解读的数据。<code>CSV</code>文件由任意数目的记录组成，记录间以某种换行符分隔；每条记录由字段组成，字段间的分隔符是其它字符或字符串，最常见的是逗号或制表符。<code>CSV</code>文件通常以 <code>.csv</code> 作为文件扩展名。</p>
<p><code>XLS</code>就是<code>Microsoft Excel</code>工作表，是一种非常常用的电子表格格式。<code>xls</code>文件可以使用<code>Microsoft Excel</code>打开，另外微软为那些没有安装<code>Excel</code>的用户开发了专门的查看器<code>Excel Viewer</code>。使用<code>Microsoft Excel</code>可以将<code>XLS</code>格式的表格转换为多种格式：<code>XML</code>表格、<code>XML</code>数据、网页、使用制表符分割的文本文件（<code>.txt</code>）、使用逗号分隔的文本文件(<code>.csv</code>)等。</p>
<p><code>XLSX</code>是<code>Microsoft Office EXCEL 2007/.../2019</code>文档及以上的扩展名。其基于<code>Office Open XML</code>标准的压缩文件格式取代以前专有的默认文件格式，在传统文件名扩展名后面添加字母”<code>x</code>“（即<code>.docx</code>取代<code>.doc</code>、<code>.xlsx</code>取代<code>.xls</code>、<code>.pptx</code>取代<code>.ppt</code>）。任何能够打开<code>.xlsx</code>文件的文字处理软件都可以将该文档转换为<code>.xls</code>文件，<code>.xlsx</code>文件比<code>.xls</code>文件所占用空间更小。</p>
<blockquote>
<p><code>xlsx</code>格式文档文件无法被<code>EXCEL2003</code>及以下版本<code>EXCEL</code>软件直接打开编辑，安装<code>OFFICE2007</code>兼容包后可以打开查看。手动将<code>XLSX</code>文件后缀修改为<code>XLS</code>无法改变文档文件的本质属性，是不能被<code>EXCEL2003</code>等低版本<code>EXCEL</code>直接打开编辑的。用户可在<code>EXCEL</code>软件成功打开<code>EXCEL2007</code>专有<code>XLSX</code>格式文档的前提下，采用另存为方式将其转换为<code>EXCEL97—2003</code>格式文档的<code>XLS</code>文件这样可与旧的版本兼容，但一些<code>EXCEL2007</code>文档专有的特性格式可能丢失。<code>Excel xls</code>和<code>xlsx</code>的详细区别如下：</p>
<ul>
<li><strong>文件格式不同</strong>：<code>xls</code>是一个特有的<a target="_blank" rel="noopener" href="https://www.zhihu.com/search?q=%E4%BA%8C%E8%BF%9B%E5%88%B6&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22answer%22,%22sourceId%22:2685933475%7D">二进制</a>格式，其核心结构是复合文档类型的结构，而<code>xlsx</code>的核心结构是<code>XML</code>类型的结构，采用的是基于<code>XML</code>的压缩方式，使其占用的空间更小。<code>xlsx</code>中最后一个<code>x</code>的意义就在于此。</li>
<li><strong>版本不同</strong>：<code>xls</code>是<code>excel2003</code>及以前版本生成的文件格式，不管有没有宏程序的话都是<code>xls</code>文件，而<code>xlsx</code>是<code>excel2007</code>及以后版本生成的文件格式，从<code>2007</code>开始做了区分，<code>XLSM</code>文件和<code>XLSX</code>文件都是<code>excel2007</code>及其以后的文件，但前者是含有宏启用，<code>Excel</code>中默认情况下不自动启用宏，默认是<code>XLSX</code>。<code>VBA</code>中，如果不想保存代码，可以保存为<code>xlsx</code>，即可自动删除其中<code>VBA</code>代码，反之则保存为<code>XLSM</code>文件。</li>
<li><strong>兼容性不同</strong>：<code>xlsx</code>格式是向下兼容的，可兼容<code>xls</code>格式。07版的<code>Office Excel</code>，能打开编辑07版（后缀<code>.xlsx</code>）的<code>Excel</code>文件，也能打开编辑03版（后缀<code>.xls</code>）的<code>Excel</code>文件，都不会出现乱码或者卡死的情况。03版的<code>Office Excel</code>，就只能打开编辑03版（后缀<code>.xls</code>）的<code>Excel</code>文件；如果打开编辑07版（后缀<code>.xlsx</code>）的<code>Excel</code>文件，则可能出现乱码或者开始能操作到最后就卡死，以后一打开就卡死。</li>
<li><strong>默认保存方式上</strong>：<code>xls</code>是03版<code>Microsoft Office Excel</code> 工作表的格式，用03版Office，新建<code>Excel</code>默认保存的<code>Excel</code>文件格式的后缀是<code>.xls</code>；<code>xlsx</code>是07版<code>Microsoft Office Excel</code> 工作表的格式，用07版Office，新建<code>Excel</code>默认保存的的<code>Excel</code>文件格式后缀是<code>.xlsx</code>。</li>
<li><strong>容量不同</strong>：<code>xls</code>只有65536行、256列；<code>xlsx</code>可以有1048576行、16384列</li>
</ul>
</blockquote>
<p><code>JSON</code>（<code>JavaScript Object Notation</code>, <code>JS</code>对象简谱）是一种轻量级的数据交换格式。它基于 <a target="_blank" rel="noopener" href="https://baike.baidu.com/item/ECMAScript?fromModule=lemma_inlink">ECMAScript</a>（欧洲计算机协会制定的<code>js</code>规范）的一个子集，采用完全独立于编程语言的文本格式来存储和表示数据。简洁和清晰的层次结构使得<code>JSON</code>成为理想的数据交换语言。 易于人阅读和编写，同时也易于机器解析和生成，并有效地提升网络传输效率。</p>
<p><code>XML</code> (<code>Extensible Markup Language</code>, 可扩展标记语言) ，<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%A0%87%E5%87%86%E9%80%9A%E7%94%A8%E6%A0%87%E8%AE%B0%E8%AF%AD%E8%A8%80/6805073?fromModule=lemma_inlink">标准通用标记语言</a>的子集，可以用来标记数据、定义数据类型，是一种允许用户对自己的标记语言进行定义的源语言。 <code>XML</code>是标准通用标记语言可扩展性良好，内容与形式分离，遵循严格的语法要求，保值性良好等优点。</p>
<p><code>TXT</code>文件是微软在操作系统上附带的一种文本格式，是最常见的一种文件格式，早在<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/DOS/32025?fromModule=lemma_inlink">DOS</a>时代应用就很多，主要存储文本信息，即为文字信息，现在的操作系统大多使用记事本等程序保存，大多数软件可以查看，如记事本，浏览器等等。</p>
<h2 id="⛄Python之读写文件"><a href="#⛄Python之读写文件" class="headerlink" title="⛄Python之读写文件"></a>⛄Python之读写文件</h2><h3 id="👀CSV"><a href="#👀CSV" class="headerlink" title="👀CSV"></a>👀CSV</h3><h4 id="（1）CSV库读取"><a href="#（1）CSV库读取" class="headerlink" title="（1）CSV库读取"></a><strong>（1）CSV库读取</strong></h4><p><code>csv.reader</code>：以列表的形式返回读取的数据；<br><code>csv.writer</code>：以列表的形式写入数据；<br><code>csv.DictReader</code>：以字典的形式返回读取的数据；<br><code>csv.DictWriter</code>：以字典的形式写入数据。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;D:\Desktop\data.csv&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    reader = csv.reader(file)</span><br><span class="line">    <span class="built_in">print</span>(reader)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line">    <span class="comment"># 用next()函数读取文件时：如果只执行一次默认读取第一行。</span></span><br><span class="line">    headers = <span class="built_in">next</span>(reader)</span><br><span class="line">    <span class="built_in">print</span>(headers)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line">        <span class="built_in">print</span>(row)</span><br><span class="line">        <span class="built_in">print</span>(row[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">&lt;_csv.reader <span class="built_in">object</span> at <span class="number">0x000001D6B95F1668</span>&gt;</span><br><span class="line">********************</span><br><span class="line">[<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>, <span class="string">&#x27;age&#x27;</span>, <span class="string">&#x27;hobby&#x27;</span>]</span><br><span class="line">********************</span><br><span class="line">[<span class="string">&#x27;小红&#x27;</span>, <span class="string">&#x27;女&#x27;</span>, <span class="string">&#x27;20&#x27;</span>, <span class="string">&#x27;跑步&#x27;</span>]</span><br><span class="line"><span class="number">20</span></span><br><span class="line">[<span class="string">&#x27;小汤&#x27;</span>, <span class="string">&#x27;男&#x27;</span>, <span class="string">&#x27;22&#x27;</span>, <span class="string">&#x27;篮球&#x27;</span>]</span><br><span class="line"><span class="number">22</span></span><br><span class="line">[<span class="string">&#x27;小李&#x27;</span>, <span class="string">&#x27;男&#x27;</span>, <span class="string">&#x27;24&#x27;</span>, <span class="string">&#x27;足球&#x27;</span>]</span><br><span class="line"><span class="number">24</span></span><br></pre></td></tr></table></figure>

<p><strong><code>namedtuple</code></strong>(具名元组)，因为元组的局限性：不能为元组内部的数据进行命名，所以往往我们并不知道一个元组所要表达的意义，在这里引入了<code>collections.namedtuple</code> 这个工厂函数，来构造一个带字段名的元组。具名元组的实例和普通元组消耗的内存一样多，因为字段名都被存在对应的类里面。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 获取一行数据中的某一列数据</span></span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> namedtuple</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;D:\Desktop\data.csv&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    reader = csv.reader(file)</span><br><span class="line">    <span class="built_in">print</span>(reader)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line">    headers = <span class="built_in">next</span>(reader)</span><br><span class="line">    <span class="comment"># namedtuple(具名元组)返回一个具名元组子类 typename</span></span><br><span class="line">    Row = namedtuple(<span class="string">&#x27;Row&#x27;</span>, headers)</span><br><span class="line">    <span class="built_in">print</span>(headers)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line">        <span class="comment"># 列表或元组前面加星号作用是将列表解开成两个独立的参数;</span></span><br><span class="line">        <span class="comment"># 字典前面加两个星号,是将字典的值解开成独立的元素作为形参。</span></span><br><span class="line">        row = Row(*row)</span><br><span class="line">        <span class="comment"># 获取一行数据中的某一列数据。</span></span><br><span class="line">        <span class="built_in">print</span>(row.name,row.age)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">&lt;_csv.reader <span class="built_in">object</span> at <span class="number">0x000001D6B95F1128</span>&gt;</span><br><span class="line">********************</span><br><span class="line">[<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>, <span class="string">&#x27;age&#x27;</span>, <span class="string">&#x27;hobby&#x27;</span>]</span><br><span class="line">********************</span><br><span class="line">小红 <span class="number">20</span></span><br><span class="line">小汤 <span class="number">22</span></span><br><span class="line">小李 <span class="number">24</span></span><br></pre></td></tr></table></figure>

<p>简单使用<code>csv.DictReader</code></p>
<blockquote>
<p>可以深入了解该函数的参数：</p>
<ul>
<li><code>csv.DictReader()</code>之<code>fieldnames</code>参数</li>
<li><code>csv.DictReader()</code>之<code>restkey</code>参数</li>
<li><code>csv.DictReader()</code>之<code>restval</code>参数</li>
</ul>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;D:\Desktop\data.csv&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    # 如果没有字段名，参数fieldnames</span></span><br><span class="line"><span class="string">    reader = csv.DictReader(file,fieldnames = [&#x27;name&#x27;,&#x27;gender&#x27;,&#x27;age&#x27;,&#x27;hobby&#x27;])</span></span><br><span class="line"><span class="string">    # next()方法用于移动指针</span></span><br><span class="line"><span class="string">    head_row = next(reader)</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    reader = csv.DictReader(file)</span><br><span class="line">    <span class="built_in">print</span>(reader)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line">        <span class="comment"># OrderedDict是一种长相类似于列表的数据类型，该列表中嵌套着元组；</span></span><br><span class="line">        <span class="comment"># 每个元组中的第一个元素为键，第二个元素为值（类似于字典）</span></span><br><span class="line">        <span class="built_in">print</span>(row)</span><br><span class="line">        <span class="built_in">print</span>(row[<span class="string">&quot;name&quot;</span>],row[<span class="string">&quot;hobby&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">&lt;csv.DictReader <span class="built_in">object</span> at <span class="number">0x000001D6B95F0388</span>&gt;</span><br><span class="line">********************</span><br><span class="line">OrderedDict([(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;小红&#x27;</span>), (<span class="string">&#x27;gender&#x27;</span>, <span class="string">&#x27;女&#x27;</span>), (<span class="string">&#x27;age&#x27;</span>, <span class="string">&#x27;20&#x27;</span>), (<span class="string">&#x27;hobby&#x27;</span>, <span class="string">&#x27;跑步&#x27;</span>)])</span><br><span class="line">小红 跑步</span><br><span class="line">OrderedDict([(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;小汤&#x27;</span>), (<span class="string">&#x27;gender&#x27;</span>, <span class="string">&#x27;男&#x27;</span>), (<span class="string">&#x27;age&#x27;</span>, <span class="string">&#x27;22&#x27;</span>), (<span class="string">&#x27;hobby&#x27;</span>, <span class="string">&#x27;篮球&#x27;</span>)])</span><br><span class="line">小汤 篮球</span><br><span class="line">OrderedDict([(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;小李&#x27;</span>), (<span class="string">&#x27;gender&#x27;</span>, <span class="string">&#x27;男&#x27;</span>), (<span class="string">&#x27;age&#x27;</span>, <span class="string">&#x27;24&#x27;</span>), (<span class="string">&#x27;hobby&#x27;</span>, <span class="string">&#x27;足球&#x27;</span>)])</span><br><span class="line">小李 足球</span><br></pre></td></tr></table></figure>

<h4 id="（2）CSV库写入"><a href="#（2）CSV库写入" class="headerlink" title="（2）CSV库写入"></a><strong>（2）CSV库写入</strong></h4><p><code>csv.reader</code>：以列表的形式返回读取的数据；<br><code>csv.writer</code>：以列表的形式写入数据；<br><code>csv.DictReader</code>：以字典的形式返回读取的数据；<br><code>csv.DictWriter</code>：以字典的形式写入数据。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="comment"># 1. 创建文件对象（指定文件名，模式，编码方式）,指定下次写入在这次的下一行</span></span><br><span class="line"><span class="comment"># 注意引入newline=&quot;&quot;，不然加入的数据会空一行</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;D:\Desktop\data.csv&quot;</span>, <span class="string">&quot;a+&quot;</span>, encoding=<span class="string">&quot;gbk&quot;</span>, newline=<span class="string">&quot;&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="comment"># 2. 基于文件对象构建 csv写入对象</span></span><br><span class="line">    csv_writer = csv.writer(f)</span><br><span class="line">    <span class="comment"># 3. 构建列表头</span></span><br><span class="line">    <span class="comment"># name = [&#x27;name&#x27;,&#x27;gender&#x27;,&#x27;age&#x27;,&#x27;hobby&#x27;]</span></span><br><span class="line">    <span class="comment"># csv_writer.writerow(name)</span></span><br><span class="line">    <span class="comment"># 4. 写入csv文件内容</span></span><br><span class="line">    z = [[<span class="string">&quot;小ai&quot;</span>, <span class="string">&quot;男&quot;</span>, <span class="number">21</span>, <span class="string">&quot;篮球&quot;</span>],[<span class="string">&quot;小张&quot;</span>, <span class="string">&quot;男&quot;</span>, <span class="number">25</span>, <span class="string">&quot;篮球&quot;</span>]]</span><br><span class="line">    csv_writer.writerows(z)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;D:\Desktop\data.csv&quot;</span>, <span class="string">&quot;r+&quot;</span>, encoding=<span class="string">&quot;gbk&quot;</span>, newline=<span class="string">&quot;&quot;</span>) <span class="keyword">as</span> f:   </span><br><span class="line">    reader = csv.reader(f)</span><br><span class="line">    headers = <span class="built_in">next</span>(reader)</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line">        <span class="built_in">print</span>(row)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">[<span class="string">&#x27;小红&#x27;</span>, <span class="string">&#x27;女&#x27;</span>, <span class="string">&#x27;20&#x27;</span>, <span class="string">&#x27;跑步&#x27;</span>]</span><br><span class="line">[<span class="string">&#x27;小汤&#x27;</span>, <span class="string">&#x27;男&#x27;</span>, <span class="string">&#x27;22&#x27;</span>, <span class="string">&#x27;篮球&#x27;</span>]</span><br><span class="line">[<span class="string">&#x27;小李&#x27;</span>, <span class="string">&#x27;男&#x27;</span>, <span class="string">&#x27;24&#x27;</span>, <span class="string">&#x27;足球&#x27;</span>]</span><br><span class="line">[<span class="string">&#x27;小ai&#x27;</span>, <span class="string">&#x27;男&#x27;</span>, <span class="string">&#x27;21&#x27;</span>, <span class="string">&#x27;篮球&#x27;</span>]</span><br><span class="line">[<span class="string">&#x27;小张&#x27;</span>, <span class="string">&#x27;男&#x27;</span>, <span class="string">&#x27;25&#x27;</span>, <span class="string">&#x27;篮球&#x27;</span>]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>如果<code>csvfile</code>是文件对象，则打开它时应使用<code>newline=&quot;&quot;</code>。如果没有指定<code>newline=&quot;&quot;</code>，则嵌入引号中的换行符将无法正确解析，并且在写入时，使用<code>\r\n</code>换行的平台会有多余的<code>\r</code>写入。由于<code>csv</code>模块会执行自己的（通用）换行符处理，因此指定<code>newline=&quot;&quot;</code>应该总是安全的。</p>
<p><code>open()</code>完成后必须调用<code>close()</code>方法关闭文件，因为文件对象会占用操作系统资源，并且操作系统同一时间能打开的文件数量也是有限的。由于文件读写时有可能产生<code>IOError</code>，一旦出错，后面的<code>f.close()</code>就不会调用。<code>with open()</code>则可以避免这样的情况。</p>
</blockquote>
<table>
<thead>
<tr>
<th align="center">模式</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>t</code></td>
<td>以<strong>文本格式</strong>打开文件（默认）。一般用于文本文件，如：<code>txt</code>。</td>
</tr>
<tr>
<td align="center"><code>b</code></td>
<td>以<strong>二进制格式</strong>打开文件。一般用于非文本文件，如：图片。</td>
</tr>
<tr>
<td align="center"><code>r</code></td>
<td>以<strong>只读</strong>方式打开文件（默认模式）。文件的指针将会放在文件的开头，如果文件不存在会<strong>报错</strong>。</td>
</tr>
<tr>
<td align="center"><code>w</code></td>
<td>以<strong>只写</strong>方式打开文件。如果该文件已存在则打开文件，并从开头开始编辑，即原有内容会被删除。如果该文件不存在，则创建新文件。</td>
</tr>
<tr>
<td align="center"><code>a</code></td>
<td>以<strong>追加</strong>方式打开文件，同样是只写，不允许进行读操作。如果文件已存在，文件指针将会放在文件的结尾，新的内容将会被写入到已有内容之后。如果该文件不存在，创建新文件进行写入。</td>
</tr>
<tr>
<td align="center"><code>r+</code></td>
<td>打开一个文件用于读写。如果文件存在，则打开文件，将文件指针定位在文件头，新写入的内容在原有内容的前面；如果文件不存在会报错。</td>
</tr>
<tr>
<td align="center"><code>w+</code></td>
<td>打开一个文件用于读写。如果文件存在，则打开文件，清空原有内容，进入编辑模式；如果文件不存在，则创建一个新文件进行读写操作。</td>
</tr>
<tr>
<td align="center"><code>a+</code></td>
<td>以追加模式打开一个文件用于读写。如果文件存在，则打开文件，将文件指针定位在文件尾，新写入的内容在原有内容的后面；如果文件不存在，则创建一个新文件用于读写。</td>
</tr>
<tr>
<td align="center"><code>rb</code></td>
<td>以二进制格式打开一个文件用于只读。文件指针将会放在文件的开头。这是默认模式。一般用于非文本文件如图片等。</td>
</tr>
<tr>
<td align="center"><code>wb</code></td>
<td>以二进制格式打开一个文件只用于写入。如果该文件已存在则打开文件，并从开头开始编辑，即原有内容会被删除。如果该文件不存在，创建新文件。一般用于非文本文件如图片等。</td>
</tr>
<tr>
<td align="center"><code>ab</code></td>
<td>以二进制格式打开一个文件用于追加。如果该文件已存在，文件指针将会放在文件的结尾。也就是说，新的内容将会被写入到已有内容之后。如果该文件不存在，创建新文件进行写入。</td>
</tr>
<tr>
<td align="center"><code>rb+</code></td>
<td>以二进制格式打开一个文件用于读写。文件指针将会放在文件的开头。一般用于非文本文件如图片等。</td>
</tr>
<tr>
<td align="center"><code>wb+</code></td>
<td>以二进制格式打开一个文件用于读写。如果该文件已存在则打开文件，并从开头开始编辑，即原有内容会被删除。如果该文件不存在，创建新文件。一般用于非文本文件如图片等。</td>
</tr>
<tr>
<td align="center"><code>ab+</code></td>
<td>以二进制格式打开一个文件用于追加。如果该文件已存在，文件指针将会放在文件的结尾。如果该文件不存在，创建新文件用于读写。</td>
</tr>
</tbody></table>
<blockquote>
<p><code>csv</code>库常见的问题</p>
<ul>
<li><code>csv.DictWriter()</code>：该函数返回的结果遍历一次之后，再次遍历返回的结果是空列表。</li>
<li><code>csv.reader()</code>：返回的结果是结构体，需要<code>for</code>循环才能调用，不能像<code>list</code>那样直接选取特定单元格。</li>
<li>通过列名来查找指定列的操作麻烦。</li>
</ul>
</blockquote>
<h4 id="（3）pandas库读取"><a href="#（3）pandas库读取" class="headerlink" title="（3）pandas库读取"></a><strong>（3）pandas库读取</strong></h4><blockquote>
<p>使用<code>pandas</code>读取<code>csv</code>文件的优势：</p>
<ul>
<li>方便，有专门支持读取<code>csv</code>文件的<code>pd.read_csv()</code>函数；</li>
<li>将<code>csv</code>转换成二维列表形式；</li>
<li>支持通过列名查找特定列；</li>
<li>相比<code>csv</code>库，事半功倍。</li>
</ul>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pandas.read_csv(filepath_or_buffer, sep=, delimiter=<span class="literal">None</span>, header=‘infer’, names=<span class="literal">None</span>, index_col=<span class="literal">None</span>, usecols=<span class="literal">None</span>, squeeze=<span class="literal">False</span>, prefix=<span class="literal">None</span>, mangle_dupe_cols=<span class="literal">True</span>, dtype=<span class="literal">None</span>, engine=<span class="literal">None</span>, converters=<span class="literal">None</span>, true_values=<span class="literal">None</span>, false_values=<span class="literal">None</span>, skipinitialspace=<span class="literal">False</span>, skiprows=<span class="literal">None</span>, skipfooter=<span class="number">0</span>, nrows=<span class="literal">None</span>, na_values=<span class="literal">None</span>, keep_default_na=<span class="literal">True</span>, na_filter=<span class="literal">True</span>, verbose=<span class="literal">False</span>, skip_blank_lines=<span class="literal">True</span>, parse_dates=<span class="literal">False</span>, infer_datetime_format=<span class="literal">False</span>, keep_date_col=<span class="literal">False</span>, date_parser=<span class="literal">None</span>, dayfirst=<span class="literal">False</span>, cache_dates=<span class="literal">True</span>, iterator=<span class="literal">False</span>, chunksize=<span class="literal">None</span>, compression=‘infer’, thousands=<span class="literal">None</span>, decimal=’.’, lineterminator=<span class="literal">None</span>, quotechar=<span class="string">&#x27;&quot;&#x27;</span>, quoting=<span class="number">0</span>, doublequote=<span class="literal">True</span>, escapechar=<span class="literal">None</span>, comment=<span class="literal">None</span>, encoding=<span class="literal">None</span>, dialect=<span class="literal">None</span>, error_bad_lines=<span class="literal">True</span>, warn_bad_lines=<span class="literal">True</span>, delim_whitespace=<span class="literal">False</span>, low_memory=<span class="literal">True</span>, memory_map=<span class="literal">False</span>, float_precision=<span class="literal">None</span>, storage_options=<span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 常用参数详解</span></span><br><span class="line">（<span class="number">1</span>）filepath_or_buffer：必须有的参数，其它都是按需求选用的。文件所在处的路径。</span><br><span class="line">（<span class="number">2</span>）sep：指定分隔符，默认为逗号<span class="string">&#x27;,&#x27;</span>。</span><br><span class="line">（<span class="number">3</span>）delimiter：<span class="built_in">str</span>/default/<span class="literal">None</span>，定界符，备选分隔符（如果指定该参数，则sep参数失效）</span><br><span class="line">（<span class="number">4</span>）header：<span class="built_in">int</span> <span class="keyword">or</span> <span class="built_in">list</span> of ints, default ‘infer’，指定哪一行作为表头。默认设置为<span class="number">0</span>（即第一行作为表头），如果没有表头的话，要修改参数，设置header=<span class="literal">None</span>。</span><br><span class="line">（<span class="number">5</span>）names：指定列的名称，用列表表示。一般我们没有表头，即header=<span class="literal">None</span>时，这个用来添加列名就很有用啦。</span><br><span class="line">（<span class="number">6</span>）index_col：指定哪一列数据作为行索引，可以是一列，也可以多列。多列的话，会看到一个分层索引。</span><br><span class="line">（<span class="number">7</span>）squeeze：布尔值，默认为<span class="literal">False</span>。如果解析的数据仅包含一列，则返回一个Series。</span><br><span class="line">（<span class="number">8</span>）prefix：给列名添加前缀。如prefix=<span class="string">&quot;x&quot;</span>,会出来<span class="string">&quot;x1&quot;</span>、<span class="string">&quot;x2&quot;</span>、<span class="string">&quot;x3&quot;</span>。</span><br><span class="line">（<span class="number">9</span>）nrows：<span class="built_in">int</span>, default <span class="literal">None</span>。需要读取的行数（从文件头开始算起）。</span><br><span class="line">（<span class="number">10</span>）encoding：编码方式。</span><br><span class="line">（<span class="number">11</span>）skiprows：<span class="built_in">list</span>-like <span class="keyword">or</span> integer, default <span class="literal">None</span>。在文件开始处要跳过的行号（索引为<span class="number">0</span>）或要跳过的行数（整数）。</span><br><span class="line">......</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">df = pd.read_csv(<span class="string">r&quot;D:\Desktop\data.csv&quot;</span>,encoding=<span class="string">&quot;gbk&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(df) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="built_in">print</span>(df.index.values)</span><br><span class="line"><span class="built_in">print</span>(df.columns.values)</span><br><span class="line"><span class="built_in">print</span>(df.values)</span><br><span class="line"><span class="comment"># 通过位置选取</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="built_in">print</span>(df.iloc[:,<span class="number">0</span>:<span class="number">3</span>].values)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(df.iloc[:,<span class="number">0</span>:<span class="number">3</span>].values))</span><br><span class="line"><span class="built_in">print</span>(df.iloc[:,<span class="number">0</span>:<span class="number">3</span>].values.tolist())</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(df.iloc[:,<span class="number">0</span>:<span class="number">3</span>].values.tolist()))</span><br><span class="line"><span class="comment"># 通过标签选取</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;-&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="built_in">print</span>(df.loc[[<span class="number">0</span>,<span class="number">3</span>],[<span class="string">&quot;name&quot;</span>,<span class="string">&quot;hobby&quot;</span>]].values)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">  name gender  age hobby</span><br><span class="line"><span class="number">0</span>   小红      女   <span class="number">20</span>    跑步</span><br><span class="line"><span class="number">1</span>   小汤      男   <span class="number">22</span>    篮球</span><br><span class="line"><span class="number">2</span>   小李      男   <span class="number">24</span>    足球</span><br><span class="line"><span class="number">3</span>  小ai      男   <span class="number">21</span>    篮球</span><br><span class="line"><span class="number">4</span>   小张      男   <span class="number">25</span>    篮球</span><br><span class="line">********************</span><br><span class="line">[<span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span>]</span><br><span class="line">[<span class="string">&#x27;name&#x27;</span> <span class="string">&#x27;gender&#x27;</span> <span class="string">&#x27;age&#x27;</span> <span class="string">&#x27;hobby&#x27;</span>]</span><br><span class="line">[[<span class="string">&#x27;小红&#x27;</span> <span class="string">&#x27;女&#x27;</span> <span class="number">20</span> <span class="string">&#x27;跑步&#x27;</span>]</span><br><span class="line"> [<span class="string">&#x27;小汤&#x27;</span> <span class="string">&#x27;男&#x27;</span> <span class="number">22</span> <span class="string">&#x27;篮球&#x27;</span>]</span><br><span class="line"> [<span class="string">&#x27;小李&#x27;</span> <span class="string">&#x27;男&#x27;</span> <span class="number">24</span> <span class="string">&#x27;足球&#x27;</span>]</span><br><span class="line"> [<span class="string">&#x27;小ai&#x27;</span> <span class="string">&#x27;男&#x27;</span> <span class="number">21</span> <span class="string">&#x27;篮球&#x27;</span>]</span><br><span class="line"> [<span class="string">&#x27;小张&#x27;</span> <span class="string">&#x27;男&#x27;</span> <span class="number">25</span> <span class="string">&#x27;篮球&#x27;</span>]]</span><br><span class="line">====================</span><br><span class="line">[[<span class="string">&#x27;小红&#x27;</span> <span class="string">&#x27;女&#x27;</span> <span class="number">20</span>]</span><br><span class="line"> [<span class="string">&#x27;小汤&#x27;</span> <span class="string">&#x27;男&#x27;</span> <span class="number">22</span>]</span><br><span class="line"> [<span class="string">&#x27;小李&#x27;</span> <span class="string">&#x27;男&#x27;</span> <span class="number">24</span>]</span><br><span class="line"> [<span class="string">&#x27;小ai&#x27;</span> <span class="string">&#x27;男&#x27;</span> <span class="number">21</span>]</span><br><span class="line"> [<span class="string">&#x27;小张&#x27;</span> <span class="string">&#x27;男&#x27;</span> <span class="number">25</span>]]</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;numpy.ndarray&#x27;</span>&gt;</span><br><span class="line">[[<span class="string">&#x27;小红&#x27;</span>, <span class="string">&#x27;女&#x27;</span>, <span class="number">20</span>], [<span class="string">&#x27;小汤&#x27;</span>, <span class="string">&#x27;男&#x27;</span>, <span class="number">22</span>], [<span class="string">&#x27;小李&#x27;</span>, <span class="string">&#x27;男&#x27;</span>, <span class="number">24</span>], [<span class="string">&#x27;小ai&#x27;</span>, <span class="string">&#x27;男&#x27;</span>, <span class="number">21</span>], [<span class="string">&#x27;小张&#x27;</span>, <span class="string">&#x27;男&#x27;</span>, <span class="number">25</span>]]</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;list&#x27;</span>&gt;</span><br><span class="line">--------------------</span><br><span class="line">[[<span class="string">&#x27;小红&#x27;</span> <span class="string">&#x27;跑步&#x27;</span>]</span><br><span class="line"> [<span class="string">&#x27;小ai&#x27;</span> <span class="string">&#x27;篮球&#x27;</span>]]</span><br></pre></td></tr></table></figure>

<h4 id="（4）pandas库写入"><a href="#（4）pandas库写入" class="headerlink" title="（4）pandas库写入"></a><strong>（4）pandas库写入</strong></h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">DataFrame.to_csv(path_or_buf=<span class="literal">None</span>, sep=<span class="string">&#x27;,&#x27;</span>, na_rep=<span class="string">&#x27;&#x27;</span>, float_format=<span class="literal">None</span>, columns=<span class="literal">None</span>, header=<span class="literal">True</span>, index=<span class="literal">True</span>, index_label=<span class="literal">None</span>, mode=<span class="string">&#x27;w&#x27;</span>, encoding=<span class="literal">None</span>, compression=<span class="string">&#x27;infer&#x27;</span>, quoting=<span class="literal">None</span>, quotechar=<span class="string">&#x27;&quot;&#x27;</span>, lineterminator=<span class="literal">None</span>, chunksize=<span class="literal">None</span>, date_format=<span class="literal">None</span>, doublequote=<span class="literal">True</span>, escapechar=<span class="literal">None</span>, decimal=<span class="string">&#x27;.&#x27;</span>, errors=<span class="string">&#x27;strict&#x27;</span>, storage_options=<span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 常用参数详解</span></span><br><span class="line">（<span class="number">1</span>）path_or_buf：字符串，放文件名、相对路径、文件流等。</span><br><span class="line">（<span class="number">2</span>）sep：字符串，分隔符，跟read_csv()的一个意思。</span><br><span class="line">（<span class="number">3</span>）na_rep：字符串，将NaN转换为特定值。</span><br><span class="line">（<span class="number">4</span>）columns：列表，指定哪些列写进去。</span><br><span class="line">（<span class="number">5</span>）header：默认header=<span class="number">0</span>，如果没有表头，设置header=<span class="literal">None</span>，表示我没有表头呀！</span><br><span class="line">（<span class="number">6</span>）index：关于索引的，默认<span class="literal">True</span>,写入索引</span><br><span class="line">（<span class="number">7</span>）mode：&#123;‘w’, ‘x’, ‘a’&#125;, default ‘w’，写入方式。</span><br><span class="line">（<span class="number">8</span>）encoding：编码方式。</span><br><span class="line">......</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">name = [<span class="string">&quot;小小&quot;</span>,<span class="string">&quot;小耿&quot;</span>]</span><br><span class="line">gender = [<span class="string">&quot;男&quot;</span>,<span class="string">&quot;男&quot;</span>]</span><br><span class="line">age = [<span class="number">20</span>,<span class="number">25</span>]</span><br><span class="line">hobby = [<span class="string">&quot;跳绳&quot;</span>,<span class="string">&quot;羽毛球&quot;</span>]</span><br><span class="line"></span><br><span class="line">dict_data = &#123;<span class="string">&quot;name&quot;</span>:name,<span class="string">&quot;gender&quot;</span>:gender,<span class="string">&quot;age&quot;</span>:age,<span class="string">&quot;hobby&quot;</span>:hobby&#125;</span><br><span class="line">df1 = pd.DataFrame(dict_data)</span><br><span class="line"><span class="comment"># mode = &quot;a&quot;为追加数据,index为每行的索引序号,header为标题</span></span><br><span class="line">df1.to_csv(<span class="string">&quot;D:\Desktop\data.csv&quot;</span>,mode=<span class="string">&quot;a&quot;</span>,index=<span class="literal">False</span>,header=<span class="literal">False</span>,encoding=<span class="string">&quot;gbk&quot;</span>)</span><br><span class="line">df2 = pd.read_csv(<span class="string">r&quot;D:\Desktop\data.csv&quot;</span>,encoding=<span class="string">&quot;gbk&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(df2) </span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">  name gender  age hobby</span><br><span class="line"><span class="number">0</span>   小红      女   <span class="number">20</span>    跑步</span><br><span class="line"><span class="number">1</span>   小汤      男   <span class="number">22</span>    篮球</span><br><span class="line"><span class="number">2</span>   小李      男   <span class="number">24</span>    足球</span><br><span class="line"><span class="number">3</span>  小ai      男   <span class="number">21</span>    篮球</span><br><span class="line"><span class="number">4</span>   小张      男   <span class="number">25</span>    篮球</span><br><span class="line"><span class="number">5</span>   小小      男   <span class="number">20</span>    跳绳</span><br><span class="line"><span class="number">6</span>   小耿      男   <span class="number">25</span>   羽毛球</span><br></pre></td></tr></table></figure>

<h3 id="👀Excel"><a href="#👀Excel" class="headerlink" title="👀Excel"></a>👀Excel</h3><p><code>python</code>用于读写<code>excel</code>文件的库有很多，除了前面提到的<code>pandas</code>，还有<code>xlrd</code>、<code>xlwt</code>、<code>openpyxl</code>、<code>xlwings</code>等等。<strong>这里以<code>pandas</code>库为例对<code>Excel</code>进行操作</strong>。</p>
<ul>
<li><code>xlrd</code>库：从<code>excel</code>中读取数据，支持<code>xls</code>、<code>xlsx</code>；</li>
<li><code>xlwt</code>库：对<code>excel</code>进行修改操作，不支持对<code>xlsx</code>格式的修改；</li>
<li><code>xlutils</code>库：在<code>xlw</code>和<code>xlrd</code>中，对一个已存在的文件进行修改；</li>
<li><code>openpyxl</code>库：主要针对<code>xlsx</code>格式的<code>excel</code>进行读取和编辑；</li>
<li><code>xlwings</code>库：对<code>xlsx</code>、<code>xls</code>、<code>xlsm</code>格式文件进行读写、格式修改等操作；</li>
<li><code>xlsxwriter</code>库：用来生成<code>excel</code>表格，插入数据、插入图标等表格操作，不支持读取；</li>
<li><code>Microsoft Excel API</code>：需安装<code>pywin32</code>，直接与<code>Excel</code>进程通信，可以做任何在<code>Excel</code>里可以做的事情，但比较慢。</li>
</ul>
<h4 id="（1）读取Excel文件"><a href="#（1）读取Excel文件" class="headerlink" title="（1）读取Excel文件"></a><strong>（1）读取Excel文件</strong></h4><p><code>read_excel()</code>读取<code>xlsx</code>文件：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pd.read_excel(io, sheet_name=<span class="number">0</span>, header=<span class="number">0</span>, names=<span class="literal">None</span>, index_col=<span class="literal">None</span>, usecols=<span class="literal">None</span>, squeeze=<span class="literal">False</span>,dtype=<span class="literal">None</span>, engine=<span class="literal">None</span>, converters=<span class="literal">None</span>, true_values=<span class="literal">None</span>, false_values=<span class="literal">None</span>, skiprows=<span class="literal">None</span>, nrows=<span class="literal">None</span>, na_values=<span class="literal">None</span>, parse_dates=<span class="literal">False</span>, date_parser=<span class="literal">None</span>, thousands=<span class="literal">None</span>, comment=<span class="literal">None</span>, skipfooter=<span class="number">0</span>, convert_float=<span class="literal">True</span>, **kwds)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 常见参数详解</span></span><br><span class="line">（<span class="number">1</span>）io:文件的路径。</span><br><span class="line">（<span class="number">2</span>）sheet_name:读取的工作表的名称；可以是整型数字、列表名，如果读取多个sheet，也可以是它们组成的列表；以<span class="number">0</span>为起始点。</span><br><span class="line">（<span class="number">3</span>）header:指定哪几行做列名；默认header为<span class="number">0</span>，如果设置为[<span class="number">0</span>,<span class="number">1</span>]，则表示将前两行作为多重索引。</span><br><span class="line">（<span class="number">4</span>）names:自定义列名；长度必须和excel的列大小相同；如果缺少列名，使用names指定列名字，会替代原来的列表头。</span><br><span class="line">（<span class="number">5</span>）index_col:用作索引的列；可以是某列的名字，也可以是整型数字或列表。</span><br><span class="line">（<span class="number">6</span>）usecols:指定读取的列；列从<span class="number">0</span>开始，可以是列表，也可以使用Excel的列名，如<span class="string">&#x27;A&#x27;</span>，<span class="string">&#x27;B&#x27;</span>等字母。</span><br><span class="line">（<span class="number">7</span>）squeeze:一列数据时，返回Series还是DataFrame。仅当Excel只有一列的时候起作用，squeeze为<span class="literal">True</span>时，返回Series，反之返回DataFrame。</span><br><span class="line">（<span class="number">8</span>）skiprows:跳过指定行；skiprows=n，跳过前n行；skiprows=[a,b,c]，跳过第a+<span class="number">1</span>,b+<span class="number">1</span>,c+<span class="number">1</span>行（索引从<span class="number">0</span>开始）；使用skiprows后，可能会跳过行首，也就是列名。</span><br><span class="line">（<span class="number">9</span>）nrows:需要读取的行数，表示只读取excel的前nrows行，包括表头。</span><br><span class="line">（<span class="number">10</span>）skipfooter:跳过末尾n行。</span><br><span class="line">......</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取xlsx,设置sheet位置,详细参数解释可以检索该函数</span></span><br><span class="line">data = pd.read_excel(<span class="string">r&quot;D:\Desktop\data.xlsx&quot;</span>,sheet_name=<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(data))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="built_in">print</span>(data.iloc[:,[<span class="number">0</span>,<span class="number">1</span>,<span class="number">3</span>]].values)</span><br><span class="line"><span class="built_in">print</span>(data.iloc[:,[<span class="number">0</span>,<span class="number">1</span>,<span class="number">3</span>]].values.tolist())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">  name gender  age hobby</span><br><span class="line"><span class="number">0</span>   小红      女   <span class="number">20</span>    跑步</span><br><span class="line"><span class="number">1</span>   小汤      男   <span class="number">22</span>    篮球</span><br><span class="line"><span class="number">2</span>   小李      男   <span class="number">24</span>    足球</span><br><span class="line"><span class="number">3</span>  小ai      男   <span class="number">21</span>    篮球</span><br><span class="line"><span class="number">4</span>   小张      男   <span class="number">25</span>    篮球</span><br><span class="line"><span class="number">5</span>   小小      男   <span class="number">20</span>    跳绳</span><br><span class="line"><span class="number">6</span>   小耿      男   <span class="number">25</span>   羽毛球</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;pandas.core.frame.DataFrame&#x27;</span>&gt;</span><br><span class="line">********************</span><br><span class="line">[[<span class="string">&#x27;小红&#x27;</span> <span class="string">&#x27;女&#x27;</span> <span class="string">&#x27;跑步&#x27;</span>]</span><br><span class="line"> [<span class="string">&#x27;小汤&#x27;</span> <span class="string">&#x27;男&#x27;</span> <span class="string">&#x27;篮球&#x27;</span>]</span><br><span class="line"> [<span class="string">&#x27;小李&#x27;</span> <span class="string">&#x27;男&#x27;</span> <span class="string">&#x27;足球&#x27;</span>]</span><br><span class="line"> [<span class="string">&#x27;小ai&#x27;</span> <span class="string">&#x27;男&#x27;</span> <span class="string">&#x27;篮球&#x27;</span>]</span><br><span class="line"> [<span class="string">&#x27;小张&#x27;</span> <span class="string">&#x27;男&#x27;</span> <span class="string">&#x27;篮球&#x27;</span>]</span><br><span class="line"> [<span class="string">&#x27;小小&#x27;</span> <span class="string">&#x27;男&#x27;</span> <span class="string">&#x27;跳绳&#x27;</span>]</span><br><span class="line"> [<span class="string">&#x27;小耿&#x27;</span> <span class="string">&#x27;男&#x27;</span> <span class="string">&#x27;羽毛球&#x27;</span>]]</span><br><span class="line">[[<span class="string">&#x27;小红&#x27;</span>, <span class="string">&#x27;女&#x27;</span>, <span class="string">&#x27;跑步&#x27;</span>], [<span class="string">&#x27;小汤&#x27;</span>, <span class="string">&#x27;男&#x27;</span>, <span class="string">&#x27;篮球&#x27;</span>], [<span class="string">&#x27;小李&#x27;</span>, <span class="string">&#x27;男&#x27;</span>, <span class="string">&#x27;足球&#x27;</span>], [<span class="string">&#x27;小ai&#x27;</span>, <span class="string">&#x27;男&#x27;</span>, <span class="string">&#x27;篮球&#x27;</span>], [<span class="string">&#x27;小张&#x27;</span>, <span class="string">&#x27;男&#x27;</span>, <span class="string">&#x27;篮球&#x27;</span>], [<span class="string">&#x27;小小&#x27;</span>, <span class="string">&#x27;男&#x27;</span>, <span class="string">&#x27;跳绳&#x27;</span>], [<span class="string">&#x27;小耿&#x27;</span>, <span class="string">&#x27;男&#x27;</span>, <span class="string">&#x27;羽毛球&#x27;</span>]]</span><br></pre></td></tr></table></figure>

<h4 id="（2）写入Excel文件"><a href="#（2）写入Excel文件" class="headerlink" title="（2）写入Excel文件"></a><strong>（2）写入Excel文件</strong></h4><p><code>to.excel()</code>保存<code>xlsx</code>文件：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">DataFrame.to_excel(excel_writer, sheet_name=<span class="string">&#x27;Sheet1&#x27;</span>, na_rep=<span class="string">&#x27;&#x27;</span>, float_format=<span class="literal">None</span>, columns=<span class="literal">None</span>, header=<span class="literal">True</span>, index=<span class="literal">True</span>, index_label=<span class="literal">None</span>, startrow=<span class="number">0</span>, startcol=<span class="number">0</span>, engine=<span class="literal">None</span>, merge_cells=<span class="literal">True</span>, encoding=<span class="literal">None</span>, inf_rep=<span class="string">&#x27;inf&#x27;</span>, verbose=<span class="literal">True</span>, freeze_panes=<span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数详解</span></span><br><span class="line">（<span class="number">1</span>）excel_writer:字符串或ExcelWriter对象；文件路径或现有的ExcelWriter。</span><br><span class="line">（<span class="number">2</span>）sheet_name:字符串，默认<span class="string">&quot;Sheet1&quot;</span>将包含DataFrame的表的名称。</span><br><span class="line">（<span class="number">3</span>）na_rep:字符串，默认<span class="string">&#x27;&#x27;</span>缺失数据表示方式。</span><br><span class="line">（<span class="number">4</span>）float_format:字符串，默认<span class="literal">None</span>格式化浮点数的字符串。</span><br><span class="line">（<span class="number">5</span>）columns:序列，可选要编写的列。</span><br><span class="line">（<span class="number">6</span>）header:布尔或字符串列表，默认为Ture。写出列名。如果给定字符串列表，则假定它是列名称的别名。</span><br><span class="line">（<span class="number">7</span>）index:布尔，默认的Ture写行名（索引）。</span><br><span class="line">......</span><br></pre></td></tr></table></figure>

<p><code>ExcelWriter()</code>可以向同一个<code>excel</code>的不同<code>sheet</code>中写入对应的表格数据，首先需要实例化一个<code>writer</code>对象，传入的主要参数为已存在容器表格的路径及文件名称。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 用于将DataFrame对象写入Excel工作表的类。默认值是对xls使用xlwt，对xlsx使用openpyxl。</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">pandas</span>.ExcelWriter(path, engine=<span class="literal">None</span>, date_format=<span class="literal">None</span>, datetime_format=<span class="literal">None</span>, mode=<span class="string">&#x27;w&#x27;</span>, **engine_kwargs)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数详解</span></span><br><span class="line">（<span class="number">1</span>）path：<span class="built_in">str</span>，xls或xlsx文件的路径。</span><br><span class="line">（<span class="number">2</span>）engine：<span class="built_in">str</span> (可选参数)，用于编写的引擎，常见的引擎有<span class="string">&quot;openpyxl&quot;</span>和<span class="string">&quot;xlsxwriter&quot;</span>。如果为无，则默认为xlsxwriter，但是<span class="string">&quot;xlsxwriter&quot;</span>模块不支持追加操作，需要追加新的sheet操作选择<span class="string">&quot;openpyxl&quot;</span>参数，否则会报错。注意：只能作为关键字参数传递。</span><br><span class="line">（<span class="number">3</span>）date_format：<span class="built_in">str</span>，默认为<span class="literal">None</span>，格式字符串，用于写入Excel文件的日期(例如<span class="string">&quot;YYYY-MM-DD&quot;</span>)。</span><br><span class="line">（<span class="number">4</span>）datetime_format：<span class="built_in">str</span>，默认为<span class="literal">None</span>，写入Excel文件的日期时间对象的格式字符串。(例如<span class="string">&quot;YYYY-MM-DD HH:MM:SS&quot;</span>)。</span><br><span class="line">（<span class="number">5</span>）mode：&#123;<span class="string">&quot;w&quot;</span>,<span class="string">&quot;a&quot;</span>&#125;，默认为<span class="string">&quot;w&quot;</span>，要使用的文件模式(写或追加)。</span><br><span class="line">（<span class="number">6</span>）if_sheet_exists：&#123;<span class="string">&#x27;error&#x27;</span>,<span class="string">&#x27;new&#x27;</span>,<span class="string">&#x27;replace&#x27;</span>,<span class="string">&#x27;overlay&#x27;</span>&#125;，默认<span class="string">&#x27;error&#x27;</span>，写入的sheet name已存在时代码操作。默认<span class="string">&#x27;error&#x27;</span>表示报错；<span class="string">&#x27;new&#x27;</span>表示engine自动创建新的其他sheet name；<span class="string">&#x27;replace&#x27;</span>表示覆盖原sheet数据，在写入之前删除工作表的内容；<span class="string">&#x27;overlay&#x27;</span>表示将内容写入现有工作表而不删除旧内容。</span><br><span class="line"></span><br><span class="line">为了与CSV编写器兼容，ExcelWriter在写入之前将列表和字典序列化为字符串。</span><br></pre></td></tr></table></figure>

<blockquote>
<p>在使用<code>pd.ExcelWriter()</code>的时候可能会出现问题：<strong>if_sheet_exists&#x3D;’overlay’ 不起作用</strong></p>
<p>查阅资料：<code>if_sheet_exists&#123;&#39;error&#39;, &#39;new&#39;, &#39;replace&#39;, &#39;overlay&#39;&#125;</code>，如果<code>pandas</code>的版本过低，是没有<code>overlay</code>参数的，需要升级<code>pandas</code>版本。我的版本：<code>pandas-2.0.1</code></p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 追加数据</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">name = [<span class="string">&quot;小伟&quot;</span>,<span class="string">&quot;小猪&quot;</span>]</span><br><span class="line">gender = [<span class="string">&quot;男&quot;</span>,<span class="string">&quot;男&quot;</span>]</span><br><span class="line">age = [<span class="number">20</span>,<span class="number">18</span>]</span><br><span class="line">hobby = [<span class="string">&quot;跳绳&quot;</span>,<span class="string">&quot;台球&quot;</span>]</span><br><span class="line">dict_data = &#123;<span class="string">&quot;name&quot;</span>:name,<span class="string">&quot;gender&quot;</span>:gender,<span class="string">&quot;age&quot;</span>:age,<span class="string">&quot;hobby&quot;</span>:hobby&#125;</span><br><span class="line">df = pd.DataFrame(dict_data)</span><br><span class="line"><span class="keyword">with</span> pd.ExcelWriter(<span class="string">r&quot;D:\Desktop\data.xlsx&quot;</span>, engine=<span class="string">&#x27;openpyxl&#x27;</span>, mode=<span class="string">&#x27;a&#x27;</span>,if_sheet_exists=<span class="string">&#x27;overlay&#x27;</span>) <span class="keyword">as</span> writer:</span><br><span class="line">	df1 = pd.DataFrame(pd.read_excel(<span class="string">r&quot;D:\Desktop\data.xlsx&quot;</span>, sheet_name=<span class="string">&#x27;data&#x27;</span>)) </span><br><span class="line">	df_rows = df1.shape[<span class="number">0</span>] <span class="comment">#获取原数据的行数</span></span><br><span class="line">	<span class="comment"># 将数据df写入excel中的sheet1表,从第一个空行开始写</span></span><br><span class="line">	<span class="comment"># 为了避免覆盖现有内容，要告诉to_excel方法从新的一行开始写，参数startrow设为&quot;原行数+1&quot;</span></span><br><span class="line">	df.to_excel(writer, sheet_name=<span class="string">&#x27;data&#x27;</span>,startrow=df_rows+<span class="number">1</span>, index=<span class="literal">False</span>, header=<span class="literal">False</span>)</span><br><span class="line">df2 = pd.read_excel(<span class="string">r&quot;D:\Desktop\data.xlsx&quot;</span>,sheet_name=<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(df2) </span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">  name gender  age hobby</span><br><span class="line"><span class="number">0</span>   小红      女   <span class="number">20</span>    跑步</span><br><span class="line"><span class="number">1</span>   小汤      男   <span class="number">22</span>    篮球</span><br><span class="line"><span class="number">2</span>   小李      男   <span class="number">24</span>    足球</span><br><span class="line"><span class="number">3</span>  小ai      男   <span class="number">21</span>    篮球</span><br><span class="line"><span class="number">4</span>   小张      男   <span class="number">25</span>    篮球</span><br><span class="line"><span class="number">5</span>   小小      男   <span class="number">20</span>    跳绳</span><br><span class="line"><span class="number">6</span>   小耿      男   <span class="number">25</span>   羽毛球</span><br><span class="line"><span class="number">7</span>   小伟      男   <span class="number">20</span>    跳绳</span><br><span class="line"><span class="number">8</span>   小猪      男   <span class="number">18</span>    台球</span><br></pre></td></tr></table></figure>

<p>写入<code>Excel</code>的几种情形与方式（覆盖、新增、追加、对齐），具体细节见：<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_46419189/article/details/123111493">参考博客①</a>、<a target="_blank" rel="noopener" href="https://blog.csdn.net/HJ_xing/article/details/112390297">参考博客②</a></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">s1 = pd.DataFrame(np.array([[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s1&#x27;</span>]]), columns=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>])</span><br><span class="line">s2 = pd.DataFrame(np.array([[<span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>]]), columns=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># （1）删除文件原有数据,只保留s2一份数据(最后一份)</span></span><br><span class="line"><span class="comment"># s1.to_excel(r&quot;D:\Desktop\test.xlsx&quot;, sheet_name=&quot;111&quot;, index=False)</span></span><br><span class="line"><span class="comment"># s2.to_excel(r&quot;D:\Desktop\test.xlsx&quot;, sheet_name=&quot;222&quot;, index=False)</span></span><br><span class="line"><span class="keyword">with</span> pd.ExcelWriter(<span class="string">r&quot;D:\Desktop\test2.xlsx&quot;</span>) <span class="keyword">as</span> writer:</span><br><span class="line">    <span class="comment"># (2) 删除文件原有数据,同时保留s1和s2两份数据</span></span><br><span class="line">    s1.to_excel(writer, sheet_name=<span class="string">&quot;111&quot;</span>, index=<span class="literal">False</span>)</span><br><span class="line">    s2.to_excel(writer, sheet_name=<span class="string">&quot;222&quot;</span>, index=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>

<h3 id="👀JSON"><a href="#👀JSON" class="headerlink" title="👀JSON"></a>👀JSON</h3><p>常见的处理<code>JSON</code>文件的第三方库（<strong>速度不同</strong>）包括：<code>json</code>、<code>simplejson</code>、<code>ujson</code>、<code>orjson</code>、<code>simdjson</code>、<code>rapidjson</code>。一般情况下的<code>json</code>文件，存储的是<code>python</code>中的一个<code>dict</code>。这里以<code>map.geojson</code>文件和<strong>CPython</strong> 本身的<code>json</code>模块为例，源文件内容如下。<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_46293423/article/details/105785007">参考博客①</a>、<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/360368839">参考博客②</a></p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;FeatureCollection&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;features&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Feature&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;properties&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;geometry&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;coordinates&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="number">116.3591064789793</span><span class="punctuation">,</span> <span class="number">40.0611769097348</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="punctuation">[</span><span class="number">116.35882714532096</span><span class="punctuation">,</span> <span class="number">40.06035824493355</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="punctuation">[</span><span class="number">116.3588680234169</span><span class="punctuation">,</span> <span class="number">40.06017052423036</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="punctuation">[</span><span class="number">116.3592154872361</span><span class="punctuation">,</span> <span class="number">40.05968557668524</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="punctuation">[</span><span class="number">116.35964470724883</span><span class="punctuation">,</span> <span class="number">40.05949263960517</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="punctuation">[</span><span class="number">116.36125939205749</span><span class="punctuation">,</span> <span class="number">40.05968557668524</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="punctuation">[</span><span class="number">116.36073478982053</span><span class="punctuation">,</span> <span class="number">40.06143241456951</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="punctuation">[</span><span class="number">116.3591064789793</span><span class="punctuation">,</span> <span class="number">40.0611769097348</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Polygon&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Feature&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;properties&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;geometry&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;coordinates&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="number">116.35838429946176</span><span class="punctuation">,</span> <span class="number">40.0595499993847</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Point&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Feature&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;properties&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;geometry&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;coordinates&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="number">116.36078873507478</span><span class="punctuation">,</span> <span class="number">40.06152377992771</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Point&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>使用<code>JSON</code>函数需要导入<code>json</code>库：<code>import json</code></p>
<table>
<thead>
<tr>
<th>函数</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><code>json.loads()</code></td>
<td>将已编码的<code>JSON</code>字符串解码为<code>Python</code>对象</td>
</tr>
<tr>
<td><code>json.dumps()</code></td>
<td>将<code>Python</code>对象编码成<code>JSON</code>字符串</td>
</tr>
</tbody></table>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">json.loads(s, *, cls=<span class="literal">None</span>, object_hook=<span class="literal">None</span>, parse_float=<span class="literal">None</span>, parse_int=<span class="literal">None</span>, parse_constant=<span class="literal">None</span>, object_pairs_hook=<span class="literal">None</span>, **kw)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数详解</span></span><br><span class="line">（<span class="number">1</span>）s：要解码的JSON字符串。</span><br><span class="line">（<span class="number">2</span>）cls：指定用于解码JSON字符串的自定义类。</span><br><span class="line">（<span class="number">3</span>）object_hook：指定一个回调函数，将解码后的JSON对象转换成其他Python对象。</span><br><span class="line">（<span class="number">4</span>）parse_float：指定一个回调函数，将解码后的JSON浮点数转换成Python浮点数。</span><br><span class="line">（<span class="number">5</span>）parse_int：指定一个回调函数，将解码后的JSON整数转换成Python整数。</span><br><span class="line">（<span class="number">6</span>）parse_constant：指定一个回调函数，用于解析JSON中的常量（例如null，true，false）。</span><br><span class="line">（<span class="number">7</span>）object_pairs_hook：指定一个回调函数，将解码后的JSON对象返回为Python的键值对。</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">json.dumps(obj, *, skipkeys=<span class="literal">False</span>, ensure_ascii=<span class="literal">True</span>, check_circular=<span class="literal">True</span>, allow_nan=<span class="literal">True</span>, cls=<span class="literal">None</span>, indent=<span class="literal">None</span>, separators=<span class="literal">None</span>, default=<span class="literal">None</span>, sort_keys=<span class="literal">False</span>, **kw)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数详解</span></span><br><span class="line">（<span class="number">1</span>）obj：转化成json的对象。</span><br><span class="line">（<span class="number">2</span>）skipkeys：是否跳过无法被JSON序列化的key（包括<span class="built_in">str</span>, <span class="built_in">int</span>, <span class="built_in">float</span>, <span class="built_in">bool</span>, <span class="literal">None</span>）。</span><br><span class="line">（<span class="number">3</span>）ensure_ascii：输出保证将所有输入的非ASCII字符转义。</span><br><span class="line">（<span class="number">4</span>）check_circular：是否检查循环引用。</span><br><span class="line">（<span class="number">5</span>）allow_nan：是否允许JSON规范外的<span class="built_in">float</span>数据(nan, inf, -inf)。</span><br><span class="line">（<span class="number">6</span>）indent：是一个正整数, 代表序列化后的缩进。</span><br><span class="line">（<span class="number">7</span>）separators：是一个格式为 (item_separator, key_separator) 的元组, 默认取值为 (<span class="string">&#x27;,&#x27;</span>,<span class="string">&#x27;:&#x27;</span>)。</span><br><span class="line">（<span class="number">8</span>）default：是一个函数, 当某个value无法被序列化时, 对其调用该函数。</span><br><span class="line">（<span class="number">9</span>）sort_keys：是否对数据按照key进行排序。</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 读取json</span></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;D:\Desktop\map.geojson&quot;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    content = f.read()</span><br><span class="line">    a = json.loads(content)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">type</span>(a))</span><br><span class="line">    <span class="built_in">print</span>(a)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line">    <span class="built_in">print</span>(a[<span class="string">&quot;features&quot;</span>][<span class="number">2</span>][<span class="string">&quot;geometry&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;dict&#x27;</span>&gt;</span><br><span class="line">&#123;<span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;FeatureCollection&#x27;</span>, <span class="string">&#x27;features&#x27;</span>: [&#123;<span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;Feature&#x27;</span>, <span class="string">&#x27;properties&#x27;</span>: &#123;&#125;, <span class="string">&#x27;geometry&#x27;</span>: &#123;<span class="string">&#x27;coordinates&#x27;</span>: [[[<span class="number">116.3591064789793</span>, <span class="number">40.0611769097348</span>], [<span class="number">116.35882714532096</span>, <span class="number">40.06035824493355</span>], [<span class="number">116.3588680234169</span>, <span class="number">40.06017052423036</span>], [<span class="number">116.3592154872361</span>, <span class="number">40.05968557668524</span>], [<span class="number">116.35964470724883</span>, <span class="number">40.05949263960517</span>], [<span class="number">116.36125939205749</span>, <span class="number">40.05968557668524</span>], [<span class="number">116.36073478982053</span>, <span class="number">40.06143241456951</span>], [<span class="number">116.3591064789793</span>, <span class="number">40.0611769097348</span>]]], <span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;Polygon&#x27;</span>&#125;&#125;, &#123;<span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;Feature&#x27;</span>, <span class="string">&#x27;properties&#x27;</span>: &#123;&#125;, <span class="string">&#x27;geometry&#x27;</span>: &#123;<span class="string">&#x27;coordinates&#x27;</span>: [<span class="number">116.35838429946176</span>, <span class="number">40.0595499993847</span>], <span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;Point&#x27;</span>&#125;&#125;, &#123;<span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;Feature&#x27;</span>, <span class="string">&#x27;properties&#x27;</span>: &#123;&#125;, <span class="string">&#x27;geometry&#x27;</span>: &#123;<span class="string">&#x27;coordinates&#x27;</span>: [<span class="number">116.36078873507478</span>, <span class="number">40.06152377992771</span>], <span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;Point&#x27;</span>&#125;&#125;]&#125;</span><br><span class="line">********************</span><br><span class="line">&#123;<span class="string">&#x27;coordinates&#x27;</span>: [<span class="number">116.36078873507478</span>, <span class="number">40.06152377992771</span>], <span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;Point&#x27;</span>&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 将字典保存成json</span></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">a = &#123;</span><br><span class="line">     <span class="string">&quot;type&quot;</span>: <span class="string">&quot;Feature&quot;</span>,</span><br><span class="line">     <span class="string">&quot;properties&quot;</span>: &#123;&#125;,</span><br><span class="line">     <span class="string">&quot;geometry&quot;</span>: &#123;</span><br><span class="line">         <span class="string">&quot;coordinates&quot;</span>: [<span class="number">116.36078873507478</span>, <span class="number">40.06152377992771</span>],</span><br><span class="line">         <span class="string">&quot;type&quot;</span>: <span class="string">&quot;Point&quot;</span></span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">b_str = json.dumps(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(b_str))</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;D:\Desktop\new_json.json&quot;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(b_str)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;D:\Desktop\new_json.json&quot;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    content = f.read()</span><br><span class="line">    a = json.loads(content)</span><br><span class="line">    <span class="built_in">print</span>(a)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;str&#x27;</span>&gt;</span><br><span class="line">&#123;<span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;Feature&#x27;</span>, <span class="string">&#x27;properties&#x27;</span>: &#123;&#125;, <span class="string">&#x27;geometry&#x27;</span>: &#123;<span class="string">&#x27;coordinates&#x27;</span>: [<span class="number">116.36078873507478</span>, <span class="number">40.06152377992771</span>], <span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;Point&#x27;</span>&#125;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="👀XML"><a href="#👀XML" class="headerlink" title="👀XML"></a>👀XML</h3><p>在<code>Python</code>中，有多个库可以用来读取和处理<code>XML</code>文档。以下是其中一些常用的库：</p>
<ul>
<li><code>xml.etree.ElementTree（</code>内置库）：这是<code>Python</code>标准库中的一个模块，提供了基本的<code>XML</code>文档解析和操作功能。它具有简单的API和高效的性能，适合处理小型到中型的<code>XML</code>文档。</li>
<li><code>lxml</code>：<code>lxml</code>是<code>Python</code>中一个功能强大的<code>XML/HTML</code>解析库，基于<code>libxml2</code>和<code>libxslt</code>库。它提供了与<code>ElementTree</code>相似的<code>API</code>，但具有更好的性能和更多的功能。<code>lxml</code>支持<code>XPath</code>、<code>XSLT</code>、<code>XML Schema</code>等高级特性，适用于处理大型和复杂的<code>XML</code>文档。</li>
<li><code>xmltodict</code>：<code>xmltodict</code>库可以将<code>XML</code>文档解析为<code>Python</code>字典，使<code>XML</code>数据的处理更加简便。它提供了一个简单的<code>API</code>，将<code>XML</code>数据转换为<code>Python</code>数据结构，便于数据的操作和处理。</li>
<li><code>minidom</code>：<code>xml.dom.minidom</code>是<code>Python</code>标准库中的一个模块，提供了基本的<code>DOM</code>（文档对象模型）接口来解析和操作<code>XML</code>文档。尽管它的<code>API</code>相对较复杂，但它具有更多的功能和灵活性，适用于需要更高级控制的场景。</li>
</ul>
<blockquote>
<p>这些库都有各自的优点和适用场景。在选择库时，可以考虑以下因素：</p>
<ul>
<li>对于简单的<code>XML</code>操作和小型文档，内置库<code>xml.etree.ElementTree</code>是一个轻量级且易于使用的选择。</li>
<li>如果需要更好的性能、更多的功能和高级特性（如<code>XPath</code>、<code>XSLT</code>），可以选择<code>lxml</code>库。</li>
<li>如果希望将<code>XML</code>数据解析为<code>Python</code>字典以便于处理，可以使用<code>xmltodict</code>库。</li>
<li>如果对<code>DOM</code>接口熟悉并且需要更多的灵活性和控制能力，可以考虑使用<code>minidom</code>库。</li>
</ul>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 说明</span></span><br><span class="line"><span class="comment"># 加载和读取xml文件，获取xml文档对象</span></span><br><span class="line"><span class="keyword">from</span> xml.dom <span class="keyword">import</span> minidom  </span><br><span class="line">doc = minidom.parse(xmlfile)</span><br><span class="line"><span class="comment"># 获取xml文档根节点</span></span><br><span class="line">root = doc.documentElement</span><br><span class="line"><span class="comment"># 节点属性</span></span><br><span class="line">root.nodeName	<span class="comment"># 每个节点都有它的nodeName，nodeValue，nodeType属性</span></span><br><span class="line">root.nodeValue	<span class="comment"># nodeValue是节点的值，只对本节点有效</span></span><br><span class="line">root.nodeType	<span class="comment"># 节点类型；</span></span><br><span class="line">root.ELEMENT_NODE</span><br><span class="line"><span class="comment"># 属性值的获取、修改、删除</span></span><br><span class="line">root.getAttribute(attributeName)		<span class="comment"># 获取xml节点属性值</span></span><br><span class="line">root.setAttribute(attributeName, value)	<span class="comment"># 修改或添加xml节点属性值</span></span><br><span class="line">root.getElementsByTagName(TagName)		<span class="comment"># 根据标签获取xml节点对象集合</span></span><br><span class="line">root.removeAttribute(attributeName)		<span class="comment"># 删除xml节点属性值</span></span><br><span class="line"><span class="comment"># 子节点的访问</span></span><br><span class="line">root.childNodes  					<span class="comment"># 获取子节点列表</span></span><br><span class="line">root.childNodes[index].nodeValue	<span class="comment"># 获取xml节点值</span></span><br><span class="line">root.firstChild						<span class="comment"># 访问第一个节点（相当于root.childNodes[0]）</span></span><br><span class="line">root.childNodes[<span class="number">0</span>].data				<span class="comment"># 获得文本值</span></span><br><span class="line"><span class="comment"># 删除子节点</span></span><br><span class="line">node.removeChild(childnode_in_node)	<span class="comment"># 删除node节点下面的子节点childnode_in_node</span></span><br><span class="line"><span class="comment"># 生成节点</span></span><br><span class="line">node.createElement(<span class="string">&#x27;activity&#x27;</span>)		<span class="comment"># 生成节点  # 文本节点.createTextNode(&#x27;xxxxx&#x27;)</span></span><br></pre></td></tr></table></figure>

<h4 id="（1）读取XML"><a href="#（1）读取XML" class="headerlink" title="（1）读取XML"></a><strong>（1）读取XML</strong></h4><p><code>XML</code>示例文件：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;ISO-8859-1&quot;</span>?&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Edited by XMLSpyÂ® --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">breakfast_menu</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">food</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">name</span>&gt;</span>Belgian Waffles<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">price</span>&gt;</span>$5.95<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">calories</span>&gt;</span>650<span class="tag">&lt;/<span class="name">calories</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">cropRegion</span> <span class="attr">x</span>=<span class="string">&quot;0&quot;</span> <span class="attr">y</span>=<span class="string">&quot;0&quot;</span> <span class="attr">width</span>=<span class="string">&quot;0000&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1234&quot;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">food</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">food</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">name</span>&gt;</span>Strawberry Belgian Waffles<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">price</span>&gt;</span>$7.95<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">calories</span>&gt;</span>900<span class="tag">&lt;/<span class="name">calories</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">cropRegion</span> <span class="attr">x</span>=<span class="string">&quot;1&quot;</span> <span class="attr">y</span>=<span class="string">&quot;1&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1111&quot;</span> <span class="attr">height</span>=<span class="string">&quot;2345&quot;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">food</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">food</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">name</span>&gt;</span>Berry-Berry Belgian Waffles<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">price</span>&gt;</span>$8.95<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">calories</span>&gt;</span>900<span class="tag">&lt;/<span class="name">calories</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">cropRegion</span> <span class="attr">x</span>=<span class="string">&quot;2&quot;</span> <span class="attr">y</span>=<span class="string">&quot;2&quot;</span> <span class="attr">width</span>=<span class="string">&quot;2222&quot;</span> <span class="attr">height</span>=<span class="string">&quot;3456&quot;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">food</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">food</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">name</span>&gt;</span>French Toast<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">price</span>&gt;</span>$4.50<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">calories</span>&gt;</span>600<span class="tag">&lt;/<span class="name">calories</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">cropRegion</span> <span class="attr">x</span>=<span class="string">&quot;3&quot;</span> <span class="attr">y</span>=<span class="string">&quot;3&quot;</span> <span class="attr">width</span>=<span class="string">&quot;3333&quot;</span> <span class="attr">height</span>=<span class="string">&quot;4567&quot;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">food</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">food</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">name</span>&gt;</span>Homestyle Breakfast<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">price</span>&gt;</span>$6.95<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">calories</span>&gt;</span>950<span class="tag">&lt;/<span class="name">calories</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">cropRegion</span> <span class="attr">x</span>=<span class="string">&quot;4&quot;</span> <span class="attr">y</span>=<span class="string">&quot;4&quot;</span> <span class="attr">width</span>=<span class="string">&quot;4444&quot;</span> <span class="attr">height</span>=<span class="string">&quot;5678&quot;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">food</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">breakfast_menu</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>DOM</code>解析<code>XML</code>文件</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> xml.dom <span class="keyword">import</span> minidom</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解析xml文件(句柄或文件路径)</span></span><br><span class="line">doc = minidom.parse(<span class="string">r&quot;D:\Desktop\simple.xml&quot;</span>)</span><br><span class="line"><span class="comment"># doc = minidom.parseString()  # 解析xml字符串</span></span><br><span class="line"><span class="built_in">print</span>(doc)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 获得根节点</span></span><br><span class="line">root_node = doc.documentElement  </span><br><span class="line"><span class="built_in">print</span>(root_node)</span><br><span class="line"><span class="comment"># 节点名称</span></span><br><span class="line"><span class="built_in">print</span>(root_node.nodeName)</span><br><span class="line"><span class="comment"># 节点类型（元素节点，文本节点，属性节点）</span></span><br><span class="line"><span class="built_in">print</span>(root_node.nodeType)</span><br><span class="line"><span class="comment"># 所有子节点，为列表</span></span><br><span class="line"><span class="built_in">print</span>(root_node.childNodes)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 通过节点名称寻找节点，返回列表</span></span><br><span class="line">filename_node = root_node.getElementsByTagName(<span class="string">&#x27;name&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(filename_node)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 子节点为文本节点，文本节点有data属性即为文本值</span></span><br><span class="line">filename = filename_node[<span class="number">1</span>].childNodes[<span class="number">0</span>].data</span><br><span class="line"><span class="built_in">print</span>(filename)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 读取指定属性值,root.setAttribute(attributeName, value)更新修改属性值</span></span><br><span class="line">cropRegion_node = root_node.getElementsByTagName(<span class="string">&#x27;cropRegion&#x27;</span>)</span><br><span class="line">width = cropRegion_node[<span class="number">1</span>].getAttribute(<span class="string">&quot;width&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(width)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">&lt;xml.dom.minidom.Document <span class="built_in">object</span> at <span class="number">0x0000016F45D0EDC0</span>&gt;</span><br><span class="line">********************</span><br><span class="line">&lt;DOM Element: breakfast_menu at <span class="number">0x16f45d011f0</span>&gt;</span><br><span class="line">breakfast_menu</span><br><span class="line"><span class="number">1</span></span><br><span class="line">[&lt;DOM Text node <span class="string">&quot;&#x27;\n\t&#x27;&quot;</span>&gt;, &lt;DOM Element: food at <span class="number">0x16f45d01f70</span>&gt;, &lt;DOM Text node <span class="string">&quot;&#x27;\n\t&#x27;&quot;</span>&gt;, &lt;DOM Element: food at <span class="number">0x16f45d01b80</span>&gt;, &lt;DOM Text node <span class="string">&quot;&#x27;\n\t&#x27;&quot;</span>&gt;, &lt;DOM Element: food at <span class="number">0x16f45ccddc0</span>&gt;, &lt;DOM Text node <span class="string">&quot;&#x27;\n\t&#x27;&quot;</span>&gt;, &lt;DOM Element: food at <span class="number">0x16f458e0dc0</span>&gt;, &lt;DOM Text node <span class="string">&quot;&#x27;\n\t&#x27;&quot;</span>&gt;, &lt;DOM Element: food at <span class="number">0x16f45cf05e0</span>&gt;, &lt;DOM Text node <span class="string">&quot;&#x27;\n&#x27;&quot;</span>&gt;]</span><br><span class="line">********************</span><br><span class="line">[&lt;DOM Element: name at <span class="number">0x16f45d01dc0</span>&gt;, &lt;DOM Element: name at <span class="number">0x16f45d018b0</span>&gt;, &lt;DOM Element: name at <span class="number">0x16f45ccdd30</span>&gt;, &lt;DOM Element: name at <span class="number">0x16f45cf0af0</span>&gt;, &lt;DOM Element: name at <span class="number">0x16f45cf0280</span>&gt;]</span><br><span class="line">********************</span><br><span class="line">Strawberry Belgian Waffles</span><br><span class="line">********************</span><br><span class="line"><span class="number">1111</span></span><br></pre></td></tr></table></figure>

<h4 id="（2）写入XML"><a href="#（2）写入XML" class="headerlink" title="（2）写入XML"></a><strong>（2）写入XML</strong></h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 写入文件</span></span><br><span class="line">DOM树对象.writexml(fh,indent=<span class="string">&#x27;&#x27;</span>,addindent=<span class="string">&#x27;\t&#x27;</span>,newl=<span class="string">&#x27;\n&#x27;</span>,encoding=<span class="string">&#x27;UTF-8&#x27;</span>)</span><br><span class="line"><span class="comment"># writexml()第一个参数是目标文件对象，第二个参数是根节点的缩进格式，第三个参数是其他子节点的缩进格式，第四个参数制定了换行格式，第五个参数制定了xml内容的编码。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># zip()函数用于将可迭代的对象作为参数，将对象中对应的元素打包成一个个元组，然后返回由这些元组组成的列表。如果各个迭代器的元素个数不一致，则返回列表长度与最短的对象相同，利用 * 号操作符，可以将元组解压为列表。</span></span><br><span class="line"><span class="comment"># zip()方法在Python2和Python3中的不同：在Python3.x中为了减少内存，zip()返回的是一个对象。如需展示列表，需手动list()转换。</span></span><br><span class="line">a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">b = [<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]</span><br><span class="line">c = [<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>]</span><br><span class="line"><span class="comment"># 返回一个对象</span></span><br><span class="line">zipped = <span class="built_in">zip</span>(a,b)</span><br><span class="line"><span class="built_in">print</span>(zipped)</span><br><span class="line"><span class="comment"># list()转换为列表</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>(zipped))</span><br><span class="line"><span class="comment"># 元素个数与最短的列表一致</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>(<span class="built_in">zip</span>(a,c)))</span><br><span class="line"><span class="comment"># 与zip相反，*zip()函数是zip()函数的逆过程，将zip对象变成原先组合前的数据</span></span><br><span class="line">a1 = <span class="built_in">zip</span>(*<span class="built_in">zip</span>(a,b))</span><br><span class="line"><span class="built_in">print</span>(a1)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>(a1))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">&lt;<span class="built_in">zip</span> <span class="built_in">object</span> at <span class="number">0x0000016F45CD6200</span>&gt;</span><br><span class="line">[(<span class="number">1</span>, <span class="number">4</span>), (<span class="number">2</span>, <span class="number">5</span>), (<span class="number">3</span>, <span class="number">6</span>)]</span><br><span class="line">[(<span class="number">1</span>, <span class="number">4</span>), (<span class="number">2</span>, <span class="number">5</span>), (<span class="number">3</span>, <span class="number">6</span>)]</span><br><span class="line">&lt;<span class="built_in">zip</span> <span class="built_in">object</span> at <span class="number">0x0000016F45CD0FC0</span>&gt;</span><br><span class="line">[(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>), (<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>)]</span><br></pre></td></tr></table></figure>

<p><code>DOM</code>写<code>XML</code>文件</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 写入XML文件</span></span><br><span class="line"><span class="keyword">from</span> xml.dom <span class="keyword">import</span> minidom</span><br><span class="line"><span class="comment"># (1)创建DOM树对象</span></span><br><span class="line">dom = minidom.Document()</span><br><span class="line"><span class="comment"># (2)创建根节点，每次都要用DOM对象来创建任何节点</span></span><br><span class="line">root_node = dom.createElement(<span class="string">&quot;people&quot;</span>)</span><br><span class="line"><span class="comment"># (3)用DOM对象添加根节点</span></span><br><span class="line">dom.appendChild(root_node)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 用DOM对象创建元素字节点</span></span><br><span class="line">name_node = dom.createElement(<span class="string">&quot;name&quot;</span>)</span><br><span class="line"><span class="comment"># 用父节点对象添加元素子节点</span></span><br><span class="line">root_node.appendChild(name_node)</span><br><span class="line"><span class="comment"># 设置该节点的属性</span></span><br><span class="line">name_node.setAttribute(<span class="string">&quot;sex&quot;</span>,<span class="string">&quot;男&quot;</span>)</span><br><span class="line">name_node.setAttribute(<span class="string">&quot;height&quot;</span>,<span class="string">&quot;180&quot;</span>)</span><br><span class="line"><span class="comment"># 用DOM创建文本节点，把文本节点（文字内容）看成子节点</span></span><br><span class="line">name_text = dom.createTextNode(<span class="string">&quot;小汤&quot;</span>)</span><br><span class="line"><span class="comment"># 用添加了文本的节点对象（看成文本节点的父节点）添加文本节点</span></span><br><span class="line">name_node.appendChild(name_text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 用DOM对象创建元素字节点</span></span><br><span class="line">hobby_node = dom.createElement(<span class="string">&quot;hobby&quot;</span>)</span><br><span class="line"><span class="comment"># 用父节点对象添加元素子节点</span></span><br><span class="line">root_node.appendChild(hobby_node)</span><br><span class="line"><span class="comment"># 用添加了文本的节点对象（看成文本节点的父节点）添加文本节点</span></span><br><span class="line">hobby_node.appendChild(dom.createTextNode(<span class="string">&quot;篮球&quot;</span>))</span><br><span class="line"></span><br><span class="line">score_node = dom.createElement(<span class="string">&quot;score&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> item, value <span class="keyword">in</span> <span class="built_in">zip</span>([<span class="string">&quot;语文&quot;</span>, <span class="string">&quot;数学&quot;</span>, <span class="string">&quot;英语&quot;</span>, <span class="string">&quot;理综&quot;</span>], [<span class="number">150</span>, <span class="number">150</span>, <span class="number">150</span>, <span class="number">300</span>]):</span><br><span class="line">        elem = dom.createElement(item)</span><br><span class="line">        elem.appendChild(dom.createTextNode(<span class="built_in">str</span>(value)))</span><br><span class="line">        score_node.appendChild(elem)</span><br><span class="line">root_node.appendChild(score_node)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;D:\Desktop\write.xml&quot;</span>,<span class="string">&#x27;w&#x27;</span>,encoding=<span class="string">&#x27;UTF-8&#x27;</span>) <span class="keyword">as</span> fh:</span><br><span class="line">        <span class="comment"># dom.writexml()第一个参数是目标文件对象，第二个参数是根节点的缩进格式，第三个参数是其他子节点的缩进格式，</span></span><br><span class="line">        <span class="comment"># 第四个参数制定了换行格式，第五个参数制定了xml内容的编码。</span></span><br><span class="line">        dom.writexml(fh, indent=<span class="string">&#x27;&#x27;</span>, addindent=<span class="string">&#x27;\t&#x27;</span>, newl=<span class="string">&#x27;\n&#x27;</span>, encoding=<span class="string">&#x27;UTF-8&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;OK&#x27;</span>)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> err:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;错误：&#123;err&#125;&#x27;</span>.<span class="built_in">format</span>(err=err))</span><br></pre></td></tr></table></figure>

<p>输出的<code>XML</code>文件内容如下：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">people</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span> <span class="attr">sex</span>=<span class="string">&quot;男&quot;</span> <span class="attr">height</span>=<span class="string">&quot;180&quot;</span>&gt;</span>小汤<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">hobby</span>&gt;</span>篮球<span class="tag">&lt;/<span class="name">hobby</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">score</span>&gt;</span></span><br><span class="line">		&lt;语文&gt;150&lt;/语文&gt;</span><br><span class="line">		&lt;数学&gt;150&lt;/数学&gt;</span><br><span class="line">		&lt;英语&gt;150&lt;/英语&gt;</span><br><span class="line">		&lt;理综&gt;300&lt;/理综&gt;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">score</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">people</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="👀TXT"><a href="#👀TXT" class="headerlink" title="👀TXT"></a>👀TXT</h3><h4 id="（1）读取TXT"><a href="#（1）读取TXT" class="headerlink" title="（1）读取TXT"></a><strong>（1）读取TXT</strong></h4><p>源数据<code>data.txt</code>内容如下：</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">name	gender	age	hobby</span><br><span class="line">小红	女	20	跑步</span><br><span class="line">小汤	男	22	篮球</span><br><span class="line">小李	男	24	足球</span><br><span class="line">小ai	男	21	篮球</span><br><span class="line">小张	男	25	篮球</span><br><span class="line">小小	男	20	跳绳</span><br><span class="line">小耿	男	25	羽毛球</span><br></pre></td></tr></table></figure>

<p>操作<code>txt</code>文件，<code>read()</code>、<code>readline()</code>、<code>readlines()</code>、以及获取某一列内容，代码示例如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># (1)read()一次性读取所有文本</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;D:\Desktop\data.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:  <span class="comment">#打开文本</span></span><br><span class="line">    data1 = f.read()   <span class="comment">#读取文本</span></span><br><span class="line">    <span class="built_in">print</span>(data1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># (2)readline()读取第一行的内容</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;D:\Desktop\data.txt&quot;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data2 = f.readline()</span><br><span class="line">    <span class="built_in">print</span>(data2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># (3)readlines()读取全部内容，以列表的格式返回结果</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;D:\Desktop\data.txt&quot;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data3 = f.readlines()</span><br><span class="line">    <span class="built_in">print</span>(data3)</span><br><span class="line">    <span class="keyword">for</span> ann <span class="keyword">in</span> data3:</span><br><span class="line">        <span class="comment"># 去除文本中的换行符</span></span><br><span class="line">        ann = ann.strip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(ann)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># (4)读取txt某一列数据，第一种方法</span></span><br><span class="line"><span class="comment"># 要读取第i列数据则可以读取每行的第i个数据再将其拼接起来</span></span><br><span class="line">column_list = []</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;D:\Desktop\data.txt&quot;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.readlines()</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> data:</span><br><span class="line">        <span class="comment"># 去除文本中的换行符</span></span><br><span class="line">        ann = line.strip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        a = ann.split(<span class="string">&quot;\t&quot;</span>)</span><br><span class="line">        column_list.append(a[<span class="number">3</span>])</span><br><span class="line"><span class="built_in">print</span>(column_list)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># (5)读取txt某一列数据，第二种方法</span></span><br><span class="line">column_list2 = []</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;D:\Desktop\data.txt&quot;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="comment"># 以行的形式进行读取文件</span></span><br><span class="line">    line2 = f.readline()</span><br><span class="line">    <span class="keyword">while</span> line2:</span><br><span class="line">        ann2 = line2.strip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        aa = ann2.split(<span class="string">&quot;\t&quot;</span>)</span><br><span class="line">        column_list2.append(aa[<span class="number">2</span>])</span><br><span class="line">        line2 = f.readline()</span><br><span class="line"><span class="built_in">print</span>(column_list2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># (6)读取txt某一列数据，第三种方法</span></span><br><span class="line"><span class="keyword">import</span> codecs</span><br><span class="line">column_list3 = []</span><br><span class="line"><span class="keyword">with</span> codecs.<span class="built_in">open</span>(<span class="string">r&quot;D:\Desktop\data.txt&quot;</span>, mode = <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="comment"># 以行的形式进行读取文件</span></span><br><span class="line">    line3 = f.readline()</span><br><span class="line">    <span class="keyword">while</span> line3:</span><br><span class="line">        ann3 = line3.strip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        aaa = ann3.split(<span class="string">&quot;\t&quot;</span>)</span><br><span class="line">        column_list3.append(aaa[<span class="number">1</span>])</span><br><span class="line">        line3 = f.readline()</span><br><span class="line"><span class="built_in">print</span>(column_list3)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">name	gender	age	hobby</span><br><span class="line">小红	女	<span class="number">20</span>	跑步</span><br><span class="line">小汤	男	<span class="number">22</span>	篮球</span><br><span class="line">小李	男	<span class="number">24</span>	足球</span><br><span class="line">小ai	男	<span class="number">21</span>	篮球</span><br><span class="line">小张	男	<span class="number">25</span>	篮球</span><br><span class="line">小小	男	<span class="number">20</span>	跳绳</span><br><span class="line">小耿	男	<span class="number">25</span>	羽毛球</span><br><span class="line"></span><br><span class="line">********************</span><br><span class="line">name	gender	age	hobby</span><br><span class="line"></span><br><span class="line">********************</span><br><span class="line">[<span class="string">&#x27;name\tgender\tage\thobby\n&#x27;</span>, <span class="string">&#x27;小红\t女\t20\t跑步\n&#x27;</span>, <span class="string">&#x27;小汤\t男\t22\t篮球\n&#x27;</span>, <span class="string">&#x27;小李\t男\t24\t足球\n&#x27;</span>, <span class="string">&#x27;小ai\t男\t21\t篮球\n&#x27;</span>, <span class="string">&#x27;小张\t男\t25\t篮球\n&#x27;</span>, <span class="string">&#x27;小小\t男\t20\t跳绳\n&#x27;</span>, <span class="string">&#x27;小耿\t男\t25\t羽毛球\n&#x27;</span>]</span><br><span class="line">name	gender	age	hobby</span><br><span class="line">小红	女	<span class="number">20</span>	跑步</span><br><span class="line">小汤	男	<span class="number">22</span>	篮球</span><br><span class="line">小李	男	<span class="number">24</span>	足球</span><br><span class="line">小ai	男	<span class="number">21</span>	篮球</span><br><span class="line">小张	男	<span class="number">25</span>	篮球</span><br><span class="line">小小	男	<span class="number">20</span>	跳绳</span><br><span class="line">小耿	男	<span class="number">25</span>	羽毛球</span><br><span class="line">********************</span><br><span class="line">[<span class="string">&#x27;hobby&#x27;</span>, <span class="string">&#x27;跑步&#x27;</span>, <span class="string">&#x27;篮球&#x27;</span>, <span class="string">&#x27;足球&#x27;</span>, <span class="string">&#x27;篮球&#x27;</span>, <span class="string">&#x27;篮球&#x27;</span>, <span class="string">&#x27;跳绳&#x27;</span>, <span class="string">&#x27;羽毛球&#x27;</span>]</span><br><span class="line">********************</span><br><span class="line">[<span class="string">&#x27;age&#x27;</span>, <span class="string">&#x27;20&#x27;</span>, <span class="string">&#x27;22&#x27;</span>, <span class="string">&#x27;24&#x27;</span>, <span class="string">&#x27;21&#x27;</span>, <span class="string">&#x27;25&#x27;</span>, <span class="string">&#x27;20&#x27;</span>, <span class="string">&#x27;25&#x27;</span>]</span><br><span class="line">********************</span><br><span class="line">[<span class="string">&#x27;gender&#x27;</span>, <span class="string">&#x27;女&#x27;</span>, <span class="string">&#x27;男&#x27;</span>, <span class="string">&#x27;男&#x27;</span>, <span class="string">&#x27;男&#x27;</span>, <span class="string">&#x27;男&#x27;</span>, <span class="string">&#x27;男&#x27;</span>, <span class="string">&#x27;男&#x27;</span>]</span><br></pre></td></tr></table></figure>

<h4 id="（2）写入TXT"><a href="#（2）写入TXT" class="headerlink" title="（2）写入TXT"></a><strong>（2）写入TXT</strong></h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 写入txt</span></span><br><span class="line">hobby =[<span class="string">&quot;hobby&quot;</span>, <span class="string">&quot;跑步&quot;</span>, <span class="string">&quot;篮球&quot;</span>, <span class="string">&quot;足球&quot;</span>, <span class="string">&quot;篮球&quot;</span>, <span class="string">&quot;篮球&quot;</span>, <span class="string">&quot;跳绳&quot;</span>, <span class="string">&quot;羽毛球&quot;</span>]</span><br><span class="line">name = [<span class="string">&quot;name&quot;</span>, <span class="string">&quot;小红&quot;</span>, <span class="string">&quot;小汤&quot;</span>, <span class="string">&quot;小李&quot;</span>, <span class="string">&quot;小ai&quot;</span>, <span class="string">&quot;小张&quot;</span>, <span class="string">&quot;小小&quot;</span>, <span class="string">&quot;小耿&quot;</span>]</span><br><span class="line">age = [<span class="string">&quot;age&quot;</span>, <span class="string">&quot;20&quot;</span>, <span class="string">&quot;22&quot;</span>, <span class="string">&quot;24&quot;</span>, <span class="string">&quot;21&quot;</span>, <span class="string">&quot;25&quot;</span>, <span class="string">&quot;30&quot;</span>, <span class="string">&quot;25&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;D:\Desktop\writeTXT.txt&quot;</span>,<span class="string">&quot;a&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    length = <span class="built_in">len</span>(age)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">        line = [hobby[i], name[i], age[i]]</span><br><span class="line">        lines = <span class="string">&quot;\t&quot;</span>.join(line)</span><br><span class="line">        <span class="comment"># lines = hobby[i] + &quot;\t&quot; + name[i] + &quot;\t&quot; + age[i]</span></span><br><span class="line">        <span class="built_in">print</span>(lines)</span><br><span class="line">        f.write(lines + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">column_list = []</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;D:\Desktop\writeTXT.txt&quot;</span>,<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.readlines()</span><br><span class="line">    <span class="comment"># print(data)</span></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> data:</span><br><span class="line">        <span class="comment"># 去除文本中的换行符</span></span><br><span class="line">        ann = line.strip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        a = ann.split(<span class="string">&quot;\t&quot;</span>)</span><br><span class="line">        column_list.append(a[<span class="number">2</span>])</span><br><span class="line"><span class="built_in">print</span>(column_list)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">hobby	name	age</span><br><span class="line">跑步	小红	<span class="number">20</span></span><br><span class="line">篮球	小汤	<span class="number">22</span></span><br><span class="line">足球	小李	<span class="number">24</span></span><br><span class="line">篮球	小ai	<span class="number">21</span></span><br><span class="line">篮球	小张	<span class="number">25</span></span><br><span class="line">跳绳	小小	<span class="number">30</span></span><br><span class="line">羽毛球	小耿	<span class="number">25</span></span><br><span class="line">[<span class="string">&#x27;age&#x27;</span>, <span class="string">&#x27;20&#x27;</span>, <span class="string">&#x27;22&#x27;</span>, <span class="string">&#x27;24&#x27;</span>, <span class="string">&#x27;21&#x27;</span>, <span class="string">&#x27;25&#x27;</span>, <span class="string">&#x27;30&#x27;</span>, <span class="string">&#x27;25&#x27;</span>]</span><br></pre></td></tr></table></figure>

<h2 id="⛄Matlab之读写文件"><a href="#⛄Matlab之读写文件" class="headerlink" title="⛄Matlab之读写文件"></a>⛄Matlab之读写文件</h2><blockquote>
<p><strong>使用过程中注意<code>MATLAB</code>版本差异问题。</strong></p>
<p><code>MATLAB</code>每一条语句后加分号与否的区别：</p>
<ul>
<li><p>代码后加分号，运行结果不会显示在命令窗口；</p>
</li>
<li><p>代码后不加分号，当点击回车时，运行结果会立即在命令窗口（<code>window command</code>）显示。</p>
</li>
</ul>
</blockquote>
<h3 id="👀CSV-1"><a href="#👀CSV-1" class="headerlink" title="👀CSV"></a>👀CSV</h3><h4 id="（1）csvread-不推荐"><a href="#（1）csvread-不推荐" class="headerlink" title="（1）csvread()(不推荐)"></a><strong>（1）<code>csvread()</code>(不推荐)</strong></h4><p><code>CSV</code>文件源数据：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">name,gender,age,语文,数学,英语</span><br><span class="line">小红,女,20,130,140,135</span><br><span class="line">小汤,男,22,131,141,136</span><br><span class="line">小李,男,24,132,142,137</span><br><span class="line">小ai,男,21,133,143,138</span><br><span class="line">小张,男,25,134,144,139</span><br><span class="line">小小,男,20,135,145,140</span><br><span class="line">小耿,男,25,136,146,141</span><br></pre></td></tr></table></figure>

<p>利用<code>csvread</code>读取<code>CSV</code>文件</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">% 读取逗号分隔值格式的文件名，结果直接返回给result，CSV文件只能包含数值。</span></span><br><span class="line">result = csvread(<span class="string">&quot;filename&quot;</span>)</span><br><span class="line"><span class="comment">% 从CSV文件中读取数据（从R行和C列开始）</span></span><br><span class="line">result = csvread(<span class="string">&quot;filename&quot;</span>, R, C)</span><br><span class="line"><span class="comment">% 只读取由range=[R1 C1 R2 C2]指定的范围，其中(R1，C1)是要读取数据的左上角，(R2，C2)是右下角。也可以使用电子表格表示法指定RNG，如range=&quot;A1..B7&quot;，而非[0 0 6 1]。</span></span><br><span class="line">result = csvread(<span class="string">&quot;filename&quot;</span>,R1,C1,[R1 C1 R2 C2])</span><br></pre></td></tr></table></figure>

<p><code>MATLAB</code>代码：<code>CTRL+R</code>（注释）、<code>CTRL+T</code>（取消注释）</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">clc</span><br><span class="line">clear all</span><br><span class="line">result1 = csvread(<span class="string">&#x27;D:\Desktop\data1.csv&#x27;</span>, <span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">result2 = csvread(<span class="string">&#x27;D:\Desktop\data1.csv&#x27;</span>, <span class="number">1</span>, <span class="number">2</span>, [<span class="number">1</span> <span class="number">2</span> <span class="number">6</span> <span class="number">4</span>])</span><br><span class="line">result3 = csvread(<span class="string">&#x27;D:\Desktop\data1.csv&#x27;</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="string">&quot;C2..F8&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">% 命令行窗口输出</span></span><br><span class="line">result1 =</span><br><span class="line">    <span class="number">20</span>   <span class="number">130</span>   <span class="number">140</span>   <span class="number">135</span></span><br><span class="line">    <span class="number">22</span>   <span class="number">131</span>   <span class="number">141</span>   <span class="number">136</span></span><br><span class="line">    <span class="number">24</span>   <span class="number">132</span>   <span class="number">142</span>   <span class="number">137</span></span><br><span class="line">    <span class="number">21</span>   <span class="number">133</span>   <span class="number">143</span>   <span class="number">138</span></span><br><span class="line">    <span class="number">25</span>   <span class="number">134</span>   <span class="number">144</span>   <span class="number">139</span></span><br><span class="line">    <span class="number">20</span>   <span class="number">135</span>   <span class="number">145</span>   <span class="number">140</span></span><br><span class="line">    <span class="number">25</span>   <span class="number">136</span>   <span class="number">146</span>   <span class="number">141</span></span><br><span class="line">result2 =</span><br><span class="line">    <span class="number">20</span>   <span class="number">130</span>   <span class="number">140</span></span><br><span class="line">    <span class="number">22</span>   <span class="number">131</span>   <span class="number">141</span></span><br><span class="line">    <span class="number">24</span>   <span class="number">132</span>   <span class="number">142</span></span><br><span class="line">    <span class="number">21</span>   <span class="number">133</span>   <span class="number">143</span></span><br><span class="line">    <span class="number">25</span>   <span class="number">134</span>   <span class="number">144</span></span><br><span class="line">    <span class="number">20</span>   <span class="number">135</span>   <span class="number">145</span></span><br><span class="line">result3 =</span><br><span class="line">    <span class="number">20</span>   <span class="number">130</span>   <span class="number">140</span>   <span class="number">135</span></span><br><span class="line">    <span class="number">22</span>   <span class="number">131</span>   <span class="number">141</span>   <span class="number">136</span></span><br><span class="line">    <span class="number">24</span>   <span class="number">132</span>   <span class="number">142</span>   <span class="number">137</span></span><br><span class="line">    <span class="number">21</span>   <span class="number">133</span>   <span class="number">143</span>   <span class="number">138</span></span><br><span class="line">    <span class="number">25</span>   <span class="number">134</span>   <span class="number">144</span>   <span class="number">139</span></span><br><span class="line">    <span class="number">20</span>   <span class="number">135</span>   <span class="number">145</span>   <span class="number">140</span></span><br><span class="line">    <span class="number">25</span>   <span class="number">136</span>   <span class="number">146</span>   <span class="number">141</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>MATLAB</code>帮助中心已经不推荐使用 <code>csvread</code>，请改用 <code>readmatrix</code>。</p>
</blockquote>
<h4 id="（2）readmatrix"><a href="#（2）readmatrix" class="headerlink" title="（2）readmatrix()"></a><strong>（2）<code>readmatrix()</code></strong></h4><blockquote>
<p><strong>参数详解见<code>MATLAB</code>帮助中心。</strong></p>
<ul>
<li>从文本文件中读取矩阵</li>
<li>从电子表格文件中读取矩阵</li>
<li>使用导入选项从指定的工作表和范围中读取矩阵</li>
<li>从指定的工作表和范围中读取矩阵</li>
</ul>
</blockquote>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">% （1）通过从文件中读取列向数据来创建数组，readmatrix函数可自动检测文件的导入参数。</span></span><br><span class="line"><span class="comment">% readmatrix基于文件的扩展名确定文件格式：</span></span><br><span class="line"><span class="comment">% .txt、.dat或.csv（带分隔符的文本文件）</span></span><br><span class="line"><span class="comment">% .xls、.xlsb、.xlsm、.xlsx、.xltm、.xltx或.ods（电子表格文件）</span></span><br><span class="line"><span class="comment">% 对于包含数值和文本混合数据的文件，默认情况下，readmatrix将数据作为数值数组导入。</span></span><br><span class="line">result = readmatrix(filename)</span><br><span class="line"><span class="comment">% （2）还使用导入选项opts</span></span><br><span class="line">result = readmatrix(filename,opts)</span><br><span class="line"><span class="comment">% （3）基于文件创建一个数组，并通过一个或多个名称-值对组参数指定其他选项。需要在输入参数之后指定名称-值对组。</span></span><br><span class="line"><span class="comment">% 要为数据设置特定的导入选项，您可以使用opts对象，也可以指定名称-值对组。当您指定除opts之外的名称-值对组时，readmatrix仅支持下列名称-值对组：</span></span><br><span class="line"><span class="comment">% 文本文件：DateLocale、Encoding</span></span><br><span class="line"><span class="comment">% 电子表格文件：Sheet、UseExcel</span></span><br><span class="line">A = readmatrix(___,Name,Value)</span><br></pre></td></tr></table></figure>

<p>利用<code>readmatrix()</code>读取<code>CSV</code>文件：</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">clc</span><br><span class="line">clear all</span><br><span class="line"><span class="comment">% readmatrix第一个参数是文件名。第二个参数指输出类型。如果不带这个参数，那字符串那一列的输出结果是Nan值</span></span><br><span class="line"><span class="comment">% 加上之后，则全部输出文本类型，后面再把要作为数值型的内容转换数据类型。</span></span><br><span class="line">result4 = readmatrix(<span class="string">&#x27;D:\Desktop\data1.csv&#x27;</span>)</span><br><span class="line">result5 = readmatrix(<span class="string">&#x27;D:\Desktop\data1.csv&#x27;</span>, <span class="string">&#x27;OutputType&#x27;</span>, <span class="string">&#x27;string&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">% 命令行窗口输出</span></span><br><span class="line">result4 =</span><br><span class="line">   NaN   NaN    <span class="number">20</span>   <span class="number">130</span>   <span class="number">140</span>   <span class="number">135</span></span><br><span class="line">   NaN     <span class="number">7</span>    <span class="number">22</span>   <span class="number">131</span>   <span class="number">141</span>   <span class="number">136</span></span><br><span class="line">   NaN     <span class="number">7</span>    <span class="number">24</span>   <span class="number">132</span>   <span class="number">142</span>   <span class="number">137</span></span><br><span class="line">   NaN     <span class="number">7</span>    <span class="number">21</span>   <span class="number">133</span>   <span class="number">143</span>   <span class="number">138</span></span><br><span class="line">   NaN     <span class="number">7</span>    <span class="number">25</span>   <span class="number">134</span>   <span class="number">144</span>   <span class="number">139</span></span><br><span class="line">   NaN     <span class="number">7</span>    <span class="number">20</span>   <span class="number">135</span>   <span class="number">145</span>   <span class="number">140</span></span><br><span class="line">   NaN     <span class="number">7</span>    <span class="number">25</span>   <span class="number">136</span>   <span class="number">146</span>   <span class="number">141</span></span><br><span class="line">result5 = </span><br><span class="line">  <span class="number">7</span>×<span class="number">6</span> string 数组</span><br><span class="line">    <span class="string">&quot;小红&quot;</span>    <span class="string">&quot;女&quot;</span>    <span class="string">&quot;20&quot;</span>    <span class="string">&quot;130&quot;</span>    <span class="string">&quot;140&quot;</span>    <span class="string">&quot;135&quot;</span></span><br><span class="line">    <span class="string">&quot;小汤&quot;</span>    <span class="string">&quot;男&quot;</span>    <span class="string">&quot;22&quot;</span>    <span class="string">&quot;131&quot;</span>    <span class="string">&quot;141&quot;</span>    <span class="string">&quot;136&quot;</span></span><br><span class="line">    <span class="string">&quot;小李&quot;</span>    <span class="string">&quot;男&quot;</span>    <span class="string">&quot;24&quot;</span>    <span class="string">&quot;132&quot;</span>    <span class="string">&quot;142&quot;</span>    <span class="string">&quot;137&quot;</span></span><br><span class="line">    <span class="string">&quot;小ai&quot;</span>    <span class="string">&quot;男&quot;</span>    <span class="string">&quot;21&quot;</span>    <span class="string">&quot;133&quot;</span>    <span class="string">&quot;143&quot;</span>    <span class="string">&quot;138&quot;</span></span><br><span class="line">    <span class="string">&quot;小张&quot;</span>    <span class="string">&quot;男&quot;</span>    <span class="string">&quot;25&quot;</span>    <span class="string">&quot;134&quot;</span>    <span class="string">&quot;144&quot;</span>    <span class="string">&quot;139&quot;</span></span><br><span class="line">    <span class="string">&quot;小小&quot;</span>    <span class="string">&quot;男&quot;</span>    <span class="string">&quot;20&quot;</span>    <span class="string">&quot;135&quot;</span>    <span class="string">&quot;145&quot;</span>    <span class="string">&quot;140&quot;</span></span><br><span class="line">    <span class="string">&quot;小耿&quot;</span>    <span class="string">&quot;男&quot;</span>    <span class="string">&quot;25&quot;</span>    <span class="string">&quot;136&quot;</span>    <span class="string">&quot;146&quot;</span>    <span class="string">&quot;141&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="（3）importdata"><a href="#（3）importdata" class="headerlink" title="（3）importdata()"></a><strong>（3）<code>importdata()</code></strong></h4><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">% （1）将数据加载到数组A中</span></span><br><span class="line">A = importdata(filename)</span><br><span class="line"><span class="comment">% （2）从系统剪贴板而不是文件加载数据。</span></span><br><span class="line">A = importdata(<span class="string">&#x27;-pastespecial&#x27;</span>)</span><br><span class="line"><span class="comment">% （3）将delimiterIn解释为ASCII文件filename或剪贴板数据中的列分隔符。您可以将delimiterIn与以上语法中的任何输入参数结合使用。</span></span><br><span class="line">A = importdata(___,delimiterIn)</span><br><span class="line"><span class="comment">% （4）从ASCII文件filename或剪贴板加载数据，并读取从第headerlinesIn+1 开始的数值数据。</span></span><br><span class="line">A = importdata(___,delimiterIn,headerlinesIn)</span><br><span class="line"><span class="comment">% （5）支持上述语法中的任何输入参数，并在delimiterOut中额外返回检测到的输入ASCII文件中的分隔符，以及在headerlinesOut中返回检测到的标题行数。</span></span><br><span class="line">[A,delimiterOut,headerlinesOut] = importdata(___)</span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">clc</span><br><span class="line">clear all</span><br><span class="line"><span class="comment">% 返回一个struct类型，默认将文本与数值分开</span></span><br><span class="line"><span class="comment">% 此方法虽然简便，但是貌似对数据量过大的数据不太友好</span></span><br><span class="line"><span class="comment">% matlab实现输出的几种方式（disp函数、fprintf函数、print函数）</span></span><br><span class="line">result6 = importdata(<span class="string">&#x27;D:\Desktop\data1.csv&#x27;</span>)</span><br><span class="line"><span class="built_in">disp</span>(result6)</span><br><span class="line">data = result6.data</span><br><span class="line">textdata = result6.textdata</span><br><span class="line"></span><br><span class="line"><span class="comment">% 命令行窗口输出</span></span><br><span class="line">        data: [<span class="number">7</span>×<span class="number">4</span> double]</span><br><span class="line">    textdata: &#123;<span class="number">8</span>×<span class="number">6</span> cell&#125;</span><br><span class="line">data =</span><br><span class="line">    <span class="number">20</span>   <span class="number">130</span>   <span class="number">140</span>   <span class="number">135</span></span><br><span class="line">    <span class="number">22</span>   <span class="number">131</span>   <span class="number">141</span>   <span class="number">136</span></span><br><span class="line">    <span class="number">24</span>   <span class="number">132</span>   <span class="number">142</span>   <span class="number">137</span></span><br><span class="line">    <span class="number">21</span>   <span class="number">133</span>   <span class="number">143</span>   <span class="number">138</span></span><br><span class="line">    <span class="number">25</span>   <span class="number">134</span>   <span class="number">144</span>   <span class="number">139</span></span><br><span class="line">    <span class="number">20</span>   <span class="number">135</span>   <span class="number">145</span>   <span class="number">140</span></span><br><span class="line">    <span class="number">25</span>   <span class="number">136</span>   <span class="number">146</span>   <span class="number">141</span></span><br><span class="line">textdata =</span><br><span class="line">  <span class="number">8</span>×<span class="number">6</span> cell 数组</span><br><span class="line">    &#123;<span class="string">&#x27;name&#x27;</span>&#125;    &#123;<span class="string">&#x27;gender&#x27;</span>&#125;    &#123;<span class="string">&#x27;age&#x27;</span>   &#125;    &#123;<span class="string">&#x27;语文&#x27;</span>  &#125;    &#123;<span class="string">&#x27;数学&#x27;</span>  &#125;    &#123;<span class="string">&#x27;英语&#x27;</span>  &#125;</span><br><span class="line">    &#123;<span class="string">&#x27;小红&#x27;</span>&#125;    &#123;<span class="string">&#x27;女&#x27;</span>    &#125;    &#123;<span class="number">0</span>×<span class="number">0</span> char&#125;    &#123;<span class="number">0</span>×<span class="number">0</span> char&#125;    &#123;<span class="number">0</span>×<span class="number">0</span> char&#125;    &#123;<span class="number">0</span>×<span class="number">0</span> char&#125;</span><br><span class="line">    &#123;<span class="string">&#x27;小汤&#x27;</span>&#125;    &#123;<span class="string">&#x27;男&#x27;</span>    &#125;    &#123;<span class="number">0</span>×<span class="number">0</span> char&#125;    &#123;<span class="number">0</span>×<span class="number">0</span> char&#125;    &#123;<span class="number">0</span>×<span class="number">0</span> char&#125;    &#123;<span class="number">0</span>×<span class="number">0</span> char&#125;</span><br><span class="line">    &#123;<span class="string">&#x27;小李&#x27;</span>&#125;    &#123;<span class="string">&#x27;男&#x27;</span>    &#125;    &#123;<span class="number">0</span>×<span class="number">0</span> char&#125;    &#123;<span class="number">0</span>×<span class="number">0</span> char&#125;    &#123;<span class="number">0</span>×<span class="number">0</span> char&#125;    &#123;<span class="number">0</span>×<span class="number">0</span> char&#125;</span><br><span class="line">    &#123;<span class="string">&#x27;小ai&#x27;</span>&#125;    &#123;<span class="string">&#x27;男&#x27;</span>    &#125;    &#123;<span class="number">0</span>×<span class="number">0</span> char&#125;    &#123;<span class="number">0</span>×<span class="number">0</span> char&#125;    &#123;<span class="number">0</span>×<span class="number">0</span> char&#125;    &#123;<span class="number">0</span>×<span class="number">0</span> char&#125;</span><br><span class="line">    &#123;<span class="string">&#x27;小张&#x27;</span>&#125;    &#123;<span class="string">&#x27;男&#x27;</span>    &#125;    &#123;<span class="number">0</span>×<span class="number">0</span> char&#125;    &#123;<span class="number">0</span>×<span class="number">0</span> char&#125;    &#123;<span class="number">0</span>×<span class="number">0</span> char&#125;    &#123;<span class="number">0</span>×<span class="number">0</span> char&#125;</span><br><span class="line">    &#123;<span class="string">&#x27;小小&#x27;</span>&#125;    &#123;<span class="string">&#x27;男&#x27;</span>    &#125;    &#123;<span class="number">0</span>×<span class="number">0</span> char&#125;    &#123;<span class="number">0</span>×<span class="number">0</span> char&#125;    &#123;<span class="number">0</span>×<span class="number">0</span> char&#125;    &#123;<span class="number">0</span>×<span class="number">0</span> char&#125;</span><br><span class="line">    &#123;<span class="string">&#x27;小耿&#x27;</span>&#125;    &#123;<span class="string">&#x27;男&#x27;</span>    &#125;    &#123;<span class="number">0</span>×<span class="number">0</span> char&#125;    &#123;<span class="number">0</span>×<span class="number">0</span> char&#125;    &#123;<span class="number">0</span>×<span class="number">0</span> char&#125;    &#123;<span class="number">0</span>×<span class="number">0</span> char&#125;</span><br></pre></td></tr></table></figure>

<h4 id="（4）readtable"><a href="#（4）readtable" class="headerlink" title="（4）readtable()"></a><strong>（4）<code>readtable()</code></strong></h4><blockquote>
<p><strong>参数详解见<code>MATLAB</code>帮助中心。</strong></p>
<ul>
<li>基于文本文件创建表</li>
<li>忽略标题并填充缺失值</li>
<li>基于文本文件创建表，无列标题</li>
<li>基于文本文件创建格式表</li>
<li>从文本文件读取外语日期</li>
<li>基于包含行名称的电子表格创建表</li>
<li>从电子表格中读取特定范围的数据</li>
<li>检测并使用针对文本文件的导入选项</li>
<li>检测并使用针对电子表格文件的导入选项</li>
<li>读取包含任意变量名称的表格数据</li>
<li>从文件中读取十六进制和二进制数字</li>
<li>为<code>XML</code>文件创建<code>XML</code>导入选项</li>
<li>注册自定义<code>XML</code>命名空间前缀</li>
<li>从<code>Microsoft Word</code>文档中读取特定表</li>
<li>从<code>HTML</code>网页读取表</li>
</ul>
</blockquote>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">% (1)通过从文件中读取列向数据来创建表。</span></span><br><span class="line"><span class="comment">% readtable基于文件的扩展名确定文件格式：</span></span><br><span class="line"><span class="comment">% .txt、.dat或.csv（带分隔符的文本文件）</span></span><br><span class="line"><span class="comment">% .xls、.xlsb、.xlsm、.xlsx、.xltm、.xltx或.ods（电子表格文件）</span></span><br><span class="line"><span class="comment">% .xml（可扩展标记语言(XML)文件）</span></span><br><span class="line"><span class="comment">% .docx（Microsoft® Word文档文件）</span></span><br><span class="line"><span class="comment">% .html、.xhtml或.htm（超文本标记语言(HTML)文件）</span></span><br><span class="line"><span class="comment">% 对于文本和电子表格文件，readtable为该文件中的每列在T中创建一个变量并从文件的第一行中读取变量名称。对于XML文件，readtable在T中为检测为表变量的每个元素或属性节点创建一个变量。变量名称对应于元素和属性名称。对于 Microsoft Word文档文件，默认情况下readtable从文档中的第一个表导入数据，为该文件中的每列在T中创建一个变量并从该表的第一行中读取变量名称。对于HTML文件，默认情况下readtable从第一个&lt;TABLE&gt;元素导入数据，为该文件中的每列在T中创建一个变量并从该表的第一行中读取变量名称。</span></span><br><span class="line"><span class="comment">% 默认情况下，readtable会根据在输入文件的每列中检测到的数据值来创建具有适当数据类型的变量。</span></span><br><span class="line">T = <span class="built_in">readtable</span>(filename)</span><br><span class="line"><span class="comment">% （2）使用导入选项opts创建表。</span></span><br><span class="line">T = <span class="built_in">readtable</span>(filename,opts)</span><br><span class="line"><span class="comment">% （3）基于文件创建一个表，并通过一个或多个名称-值对组参数指定其他选项。例如，您可以指定readtable是将文件的第一行读取为变量名称还是数据。</span></span><br><span class="line"><span class="comment">% 要为数据设置特定的导入选项，您可以使用opts对象，也可以指定名称-值对组。当您指定除opts之外的名称-值对组时，readtable仅支持下列名称-值对组：</span></span><br><span class="line"><span class="comment">% 文本和电子表格参数 -ReadVariableNames、ReadRowNames</span></span><br><span class="line"><span class="comment">% 仅文本参数 -DateLocale、Encoding</span></span><br><span class="line"><span class="comment">% 仅电子表格参数 -Sheet、UseExcel</span></span><br><span class="line">T = <span class="built_in">readtable</span>(___,Name,Value)</span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">clc</span><br><span class="line">clear all</span><br><span class="line">result7 = <span class="built_in">readtable</span>(<span class="string">&#x27;D:\Desktop\data1.csv&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">% 命令行窗口输出</span></span><br><span class="line">result7 =</span><br><span class="line">  <span class="number">7</span>×<span class="number">6</span> <span class="built_in">table</span></span><br><span class="line">     name     gender    age    x__    x___1    x___2</span><br><span class="line">    ______    ______    ___    ___    _____    _____</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;小红&#x27;</span>     <span class="string">&#x27;女&#x27;</span>      <span class="number">20</span>     <span class="number">130</span>     <span class="number">140</span>      <span class="number">135</span> </span><br><span class="line">    <span class="string">&#x27;小汤&#x27;</span>     <span class="string">&#x27;男&#x27;</span>      <span class="number">22</span>     <span class="number">131</span>     <span class="number">141</span>      <span class="number">136</span> </span><br><span class="line">    <span class="string">&#x27;小李&#x27;</span>     <span class="string">&#x27;男&#x27;</span>      <span class="number">24</span>     <span class="number">132</span>     <span class="number">142</span>      <span class="number">137</span> </span><br><span class="line">    <span class="string">&#x27;小ai&#x27;</span>     <span class="string">&#x27;男&#x27;</span>     <span class="number">21</span>     <span class="number">133</span>     <span class="number">143</span>      <span class="number">138</span> </span><br><span class="line">    <span class="string">&#x27;小张&#x27;</span>     <span class="string">&#x27;男&#x27;</span>      <span class="number">25</span>     <span class="number">134</span>     <span class="number">144</span>      <span class="number">139</span> </span><br><span class="line">    <span class="string">&#x27;小小&#x27;</span>     <span class="string">&#x27;男&#x27;</span>      <span class="number">20</span>     <span class="number">135</span>     <span class="number">145</span>      <span class="number">140</span> </span><br><span class="line">    <span class="string">&#x27;小耿&#x27;</span>     <span class="string">&#x27;男&#x27;</span>      <span class="number">25</span>     <span class="number">136</span>     <span class="number">146</span>      <span class="number">141</span> </span><br></pre></td></tr></table></figure>

<h4 id="（5）csvwrite-不推荐"><a href="#（5）csvwrite-不推荐" class="headerlink" title="（5）csvwrite()(不推荐)"></a><strong>（5）<code>csvwrite()</code>(不推荐)</strong></h4><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">% 可查看帮助中心函数说明</span></span><br><span class="line"><span class="comment">% 将矩阵M以逗号分隔值形式写入文件filename。</span></span><br><span class="line">csvwrite(filename,M)</span><br><span class="line"><span class="comment">% 从指定的行和列偏移量开始将矩阵M写入文件filename。行和列参数从0开始，因此row=0和col=0指定文件中的第一个值。</span></span><br><span class="line">csvwrite(filename,M,row,col)</span><br></pre></td></tr></table></figure>

<blockquote>
<ul>
<li>对于字符串类型<code>csvwrite</code>可能不支持；</li>
<li><strong>帮助中心</strong>：不推荐使用<code>csvwrite</code>，请改用<code>writematrix</code>。</li>
</ul>
</blockquote>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">clc</span><br><span class="line">clear all</span><br><span class="line"></span><br><span class="line">csv_data = importdata(<span class="string">&#x27;D:\Desktop\data1.csv&#x27;</span>)</span><br><span class="line">data = csv_data.data;</span><br><span class="line">textdata = csv_data.textdata;</span><br><span class="line">csvwrite(<span class="string">&#x27;D:\Desktop\output.csv&#x27;</span>,data, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line"><span class="comment">% 输出结果为double</span></span><br><span class="line">res1 = readmatrix(<span class="string">&#x27;D:\Desktop\output.csv&#x27;</span>)</span><br><span class="line"><span class="comment">% 输出结果为string</span></span><br><span class="line">res2 = readmatrix(<span class="string">&#x27;D:\Desktop\output.csv&#x27;</span>, <span class="string">&#x27;OutputType&#x27;</span>, <span class="string">&#x27;string&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">% 命令行窗口输出结果</span></span><br><span class="line">csv_data = </span><br><span class="line">  包含以下字段的 struct:</span><br><span class="line">        data: [<span class="number">7</span>×<span class="number">4</span> double]</span><br><span class="line">    textdata: &#123;<span class="number">8</span>×<span class="number">6</span> cell&#125;</span><br><span class="line">res1 =</span><br><span class="line">    <span class="number">20</span>   <span class="number">130</span>   <span class="number">140</span>   <span class="number">135</span></span><br><span class="line">    <span class="number">22</span>   <span class="number">131</span>   <span class="number">141</span>   <span class="number">136</span></span><br><span class="line">    <span class="number">24</span>   <span class="number">132</span>   <span class="number">142</span>   <span class="number">137</span></span><br><span class="line">    <span class="number">21</span>   <span class="number">133</span>   <span class="number">143</span>   <span class="number">138</span></span><br><span class="line">    <span class="number">25</span>   <span class="number">134</span>   <span class="number">144</span>   <span class="number">139</span></span><br><span class="line">    <span class="number">20</span>   <span class="number">135</span>   <span class="number">145</span>   <span class="number">140</span></span><br><span class="line">    <span class="number">25</span>   <span class="number">136</span>   <span class="number">146</span>   <span class="number">141</span></span><br><span class="line">res2 = </span><br><span class="line">  <span class="number">7</span>×<span class="number">4</span> string 数组</span><br><span class="line">    <span class="string">&quot;20&quot;</span>    <span class="string">&quot;130&quot;</span>    <span class="string">&quot;140&quot;</span>    <span class="string">&quot;135&quot;</span></span><br><span class="line">    <span class="string">&quot;22&quot;</span>    <span class="string">&quot;131&quot;</span>    <span class="string">&quot;141&quot;</span>    <span class="string">&quot;136&quot;</span></span><br><span class="line">    <span class="string">&quot;24&quot;</span>    <span class="string">&quot;132&quot;</span>    <span class="string">&quot;142&quot;</span>    <span class="string">&quot;137&quot;</span></span><br><span class="line">    <span class="string">&quot;21&quot;</span>    <span class="string">&quot;133&quot;</span>    <span class="string">&quot;143&quot;</span>    <span class="string">&quot;138&quot;</span></span><br><span class="line">    <span class="string">&quot;25&quot;</span>    <span class="string">&quot;134&quot;</span>    <span class="string">&quot;144&quot;</span>    <span class="string">&quot;139&quot;</span></span><br><span class="line">    <span class="string">&quot;20&quot;</span>    <span class="string">&quot;135&quot;</span>    <span class="string">&quot;145&quot;</span>    <span class="string">&quot;140&quot;</span></span><br><span class="line">    <span class="string">&quot;25&quot;</span>    <span class="string">&quot;136&quot;</span>    <span class="string">&quot;146&quot;</span>    <span class="string">&quot;141&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="（6）writematrix"><a href="#（6）writematrix" class="headerlink" title="（6）writematrix()"></a><strong>（6）<code>writematrix()</code></strong></h4><blockquote>
<p><strong>参数详解见<code>MATLAB</code>帮助中心。</strong></p>
<ul>
<li>将矩阵写入到文本文件</li>
<li>将矩阵写入电子表格文件</li>
<li>将矩阵写入指定的工作表和范围</li>
<li>将数据追加到电子表格</li>
<li>将矩阵数据追加到文本文件</li>
</ul>
</blockquote>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">% writematrix()将矩阵写入文件，自R2019a起</span></span><br><span class="line"><span class="comment">% （1）将同构数组A写入以逗号分隔的文本文件。文件名为数组的工作区变量名称，附加扩展名.txt。如果writematrix无法根据数组名称构造文件名，那么它会写入matrix.txt文件中。A中每个变量的每一列都将成为输出文件中的列。writematrix函数会覆盖任何现有文件。</span></span><br><span class="line">writematrix(A)</span><br><span class="line"><span class="comment">% （2）写入具有filename指定的名称和扩展名的文件。</span></span><br><span class="line"><span class="comment">% writematrix 根据指定扩展名确定文件格式。扩展名必须是下列格式之一：</span></span><br><span class="line"><span class="comment">% .txt、.dat或.csv（带分隔符的文本文件）</span></span><br><span class="line"><span class="comment">% .xls、.xlsm或.xlsx（适用于Excel® 电子表格文件）</span></span><br><span class="line"><span class="comment">% .xlsb（适用于安装了Windows® Excel的系统上支持的Excel电子表格文件）</span></span><br><span class="line">writematrix(A,filename)</span><br><span class="line"><span class="comment">% （3）支持上述语法中的任何输入参数，且可使用一个或多个Name,Value对组参数指定其他选项将数组写入文件中。</span></span><br><span class="line">writematrix(___,Name,Value)</span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">clc</span><br><span class="line">clear all</span><br><span class="line"></span><br><span class="line">csv_data = readmatrix(<span class="string">&#x27;D:\Desktop\data1.csv&#x27;</span>, <span class="string">&#x27;OutputType&#x27;</span>, <span class="string">&#x27;string&#x27;</span>)</span><br><span class="line"><span class="comment">% 没有标题,可以根据自己创建的矩阵添加标题</span></span><br><span class="line">writematrix(csv_data,<span class="string">&#x27;D:\Desktop\output1.csv&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">% 命令行窗口输出结果</span></span><br><span class="line">csv_data = </span><br><span class="line">  <span class="number">7</span>×<span class="number">6</span> string 数组</span><br><span class="line">    <span class="string">&quot;小红&quot;</span>    <span class="string">&quot;女&quot;</span>    <span class="string">&quot;20&quot;</span>    <span class="string">&quot;130&quot;</span>    <span class="string">&quot;140&quot;</span>    <span class="string">&quot;135&quot;</span></span><br><span class="line">    <span class="string">&quot;小汤&quot;</span>    <span class="string">&quot;男&quot;</span>    <span class="string">&quot;22&quot;</span>    <span class="string">&quot;131&quot;</span>    <span class="string">&quot;141&quot;</span>    <span class="string">&quot;136&quot;</span></span><br><span class="line">    <span class="string">&quot;小李&quot;</span>    <span class="string">&quot;男&quot;</span>    <span class="string">&quot;24&quot;</span>    <span class="string">&quot;132&quot;</span>    <span class="string">&quot;142&quot;</span>    <span class="string">&quot;137&quot;</span></span><br><span class="line">    <span class="string">&quot;小ai&quot;</span>    <span class="string">&quot;男&quot;</span>    <span class="string">&quot;21&quot;</span>    <span class="string">&quot;133&quot;</span>    <span class="string">&quot;143&quot;</span>    <span class="string">&quot;138&quot;</span></span><br><span class="line">    <span class="string">&quot;小张&quot;</span>    <span class="string">&quot;男&quot;</span>    <span class="string">&quot;25&quot;</span>    <span class="string">&quot;134&quot;</span>    <span class="string">&quot;144&quot;</span>    <span class="string">&quot;139&quot;</span></span><br><span class="line">    <span class="string">&quot;小小&quot;</span>    <span class="string">&quot;男&quot;</span>    <span class="string">&quot;20&quot;</span>    <span class="string">&quot;135&quot;</span>    <span class="string">&quot;145&quot;</span>    <span class="string">&quot;140&quot;</span></span><br><span class="line">    <span class="string">&quot;小耿&quot;</span>    <span class="string">&quot;男&quot;</span>    <span class="string">&quot;25&quot;</span>    <span class="string">&quot;136&quot;</span>    <span class="string">&quot;146&quot;</span>    <span class="string">&quot;141&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="（7）dlmwrite-不推荐"><a href="#（7）dlmwrite-不推荐" class="headerlink" title="（7）dlmwrite()(不推荐)"></a><strong>（7）<code>dlmwrite()</code>(不推荐)</strong></h4><blockquote>
<p>帮助中心：不推荐使用<code>dlmwrite</code>，请改用<code>writematrix</code>。</p>
<p><code>dlmwrite</code>支持数值数据，不支持字符串类型。具体参数解释可以查看<code>MATLAB</code>帮助中心文档。</p>
</blockquote>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">% (1)将数组M中的数值数据写入一个ASCII格式的文件filename，并使用默认分隔符(,)分隔各数组元素。如果文件filename已存在，则dlmwrite将覆盖该文件。</span></span><br><span class="line">dlmwrite(filename,M)</span><br><span class="line"><span class="comment">% (2)将数据追加到现有文件filename的末尾。</span></span><br><span class="line">dlmwrite(filename,M,<span class="string">&#x27;-append&#x27;</span>)</span><br><span class="line"><span class="comment">% (3)使用一个或多个名称-值对组参数另外指定分隔符、换行符、偏移量和精度选项。</span></span><br><span class="line">dlmwrite(___,Name,Value)</span><br><span class="line"><span class="comment">% (4)将数组M写入文件filename，并使用指定分隔符delimiter分隔各数组元素。</span></span><br><span class="line">dlmwrite(filename,M,delimiter)</span><br><span class="line"><span class="comment">% (5)从目标文件中指定的第row行和第col列开始写入数组。前导行和列用delimiter分隔的空元素填充。</span></span><br><span class="line">dlmwrite(filename,M,delimiter,row,col)</span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">clc</span><br><span class="line">clear all</span><br><span class="line"></span><br><span class="line"><span class="comment">% 支持数值型</span></span><br><span class="line">csv_data = importdata(<span class="string">&#x27;D:\Desktop\data1.csv&#x27;</span>)</span><br><span class="line">data = csv_data.data</span><br><span class="line"><span class="comment">% 添加到csv中，并且以逗号为分隔符</span></span><br><span class="line">dlmwrite(<span class="string">&#x27;D:\Desktop\output2.csv&#x27;</span>,data,<span class="string">&#x27;delimiter&#x27;</span>,<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line"><span class="comment">% 添加到csv中，并且从行后添加</span></span><br><span class="line">dlmwrite(<span class="string">&#x27;D:\Desktop\output2.csv&#x27;</span>,data,<span class="string">&#x27;delimiter&#x27;</span>,<span class="string">&#x27;,&#x27;</span>,<span class="string">&#x27;-append&#x27;</span>)</span><br><span class="line"><span class="comment">% 添加到csv中，并且以相对于已有数据偏移的方式</span></span><br><span class="line">dlmwrite(<span class="string">&#x27;D:\Desktop\output2.csv&#x27;</span>,data,<span class="string">&#x27;delimiter&#x27;</span>,<span class="string">&#x27;,&#x27;</span>,<span class="string">&#x27;-append&#x27;</span>,<span class="string">&#x27;roffset&#x27;</span>,<span class="number">2</span>,<span class="string">&#x27;coffset&#x27;</span>,<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">% 命令行窗口输出结果</span></span><br><span class="line">csv_data = </span><br><span class="line">  包含以下字段的 struct:</span><br><span class="line">        data: [<span class="number">7</span>×<span class="number">4</span> double]</span><br><span class="line">    textdata: &#123;<span class="number">8</span>×<span class="number">6</span> cell&#125;</span><br><span class="line">data =</span><br><span class="line">    <span class="number">20</span>   <span class="number">130</span>   <span class="number">140</span>   <span class="number">135</span></span><br><span class="line">    <span class="number">22</span>   <span class="number">131</span>   <span class="number">141</span>   <span class="number">136</span></span><br><span class="line">    <span class="number">24</span>   <span class="number">132</span>   <span class="number">142</span>   <span class="number">137</span></span><br><span class="line">    <span class="number">21</span>   <span class="number">133</span>   <span class="number">143</span>   <span class="number">138</span></span><br><span class="line">    <span class="number">25</span>   <span class="number">134</span>   <span class="number">144</span>   <span class="number">139</span></span><br><span class="line">    <span class="number">20</span>   <span class="number">135</span>   <span class="number">145</span>   <span class="number">140</span></span><br><span class="line">    <span class="number">25</span>   <span class="number">136</span>   <span class="number">146</span>   <span class="number">141</span></span><br></pre></td></tr></table></figure>

<h4 id="（8）writetable"><a href="#（8）writetable" class="headerlink" title="（8）writetable()"></a><strong>（8）<code>writetable()</code></strong></h4><blockquote>
<p><strong>参数详解见<code>MATLAB</code>帮助中心</strong>。也可实现：</p>
<ul>
<li>将表写入到<strong>文本文件</strong></li>
<li>将表写入空格分隔的文本文件</li>
<li>将表写入包含行名称的文本文件</li>
<li>将外语日期写入文本文件</li>
<li>将外语字符写入文本文件</li>
<li>将引用文本写入**<code>CSV</code>文件**</li>
<li>将表写入到电子表格中特定的工作表和范围</li>
<li>写入包含任意变量名称的表格数据</li>
<li>将数据追加到表的底部</li>
<li>保留现有列宽（将数据追加到文件底部时，保留电子表格文件的现有列宽）</li>
<li>修改现有单元格格式</li>
<li>将表写入**<code>XML</code>文件**</li>
</ul>
</blockquote>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">% (1)将表T写入逗号分隔的文本文件。文件名为表的工作区变量名称，附加扩展名.txt。如果writetable无法根据输入表名称构造文件名，那么它会写入table.txt 文件中。</span></span><br><span class="line"><span class="comment">% 对于文本文件和电子表格文件，T中每个变量的每列都成为输出文件中的一列。T的变量名称将成为文件第一行的列标题。</span></span><br><span class="line"><span class="comment">% 对于XML文件，T中的每列都成为输出文件中的一个XML节点。T的变量名称成为输出XML文件中元素节点的名称。</span></span><br><span class="line"><span class="built_in">writetable</span>(T)</span><br><span class="line"><span class="comment">% (2)写入具有filename指定的名称和扩展名的文件。</span></span><br><span class="line"><span class="comment">% writetable根据指定扩展名确定文件格式。扩展名必须是下列格式之一：</span></span><br><span class="line"><span class="comment">% .txt、.dat或.csv（带分隔符的文本文件）</span></span><br><span class="line"><span class="comment">% .xls、.xlsm或.xlsx（适用于Excel®电子表格文件）</span></span><br><span class="line"><span class="comment">% .xlsb（适用于安装了Windows® Excel的系统上支持的Excel电子表格文件）</span></span><br><span class="line"><span class="comment">% .xml（可扩展标记语言(XML)文件）</span></span><br><span class="line"><span class="built_in">writetable</span>(T,filename)</span><br><span class="line"><span class="comment">% (3)通过一个或多个Name,Value对组参数指定的其他选项将表写入文件中，并且可以包含以前语法中的任何输入参数。例如，您可以指定是否将变量名称写入为输出文件中的列标题。</span></span><br><span class="line"><span class="built_in">writetable</span>(___,Name,Value)</span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">clc</span><br><span class="line">clear all</span><br><span class="line"></span><br><span class="line">LastName = &#123;<span class="string">&#x27;Sanchez&#x27;</span>;<span class="string">&#x27;Johnson&#x27;</span>;<span class="string">&#x27;Li&#x27;</span>;<span class="string">&#x27;Diaz&#x27;</span>;<span class="string">&#x27;Brown&#x27;</span>&#125;</span><br><span class="line">Age = [<span class="number">38</span>;<span class="number">43</span>;<span class="number">38</span>;<span class="number">40</span>;<span class="number">49</span>]</span><br><span class="line">Smoker = logical([<span class="number">1</span>;<span class="number">0</span>;<span class="number">1</span>;<span class="number">0</span>;<span class="number">1</span>])</span><br><span class="line">Height = [<span class="number">71</span>;<span class="number">69</span>;<span class="number">64</span>;<span class="number">67</span>;<span class="number">64</span>]</span><br><span class="line">Weight = [<span class="number">176</span>;<span class="number">163</span>;<span class="number">131</span>;<span class="number">133</span>;<span class="number">119</span>]</span><br><span class="line">BloodPressure = [<span class="number">124</span> <span class="number">93</span>; <span class="number">109</span> <span class="number">77</span>; <span class="number">125</span> <span class="number">83</span>; <span class="number">117</span> <span class="number">75</span>; <span class="number">122</span> <span class="number">80</span>]</span><br><span class="line">table_csv = <span class="built_in">table</span>(LastName,Age,Smoker,Height,Weight,BloodPressure)</span><br><span class="line"><span class="comment">% 自定义列索引和行索引</span></span><br><span class="line">table_csv.Properties.VariableNames = &#123;<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;f&#x27;</span>&#125;</span><br><span class="line">table_csv.Properties.RowNames = &#123;<span class="string">&#x27;g&#x27;</span>,<span class="string">&#x27;h&#x27;</span>,<span class="string">&#x27;i&#x27;</span>,<span class="string">&#x27;j&#x27;</span>,<span class="string">&#x27;k&#x27;</span>&#125;</span><br><span class="line"><span class="built_in">writetable</span>(table_csv,<span class="string">&quot;D:\Desktop\output3.csv&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="👀Excel-1"><a href="#👀Excel-1" class="headerlink" title="👀Excel"></a>👀Excel</h3><blockquote>
<p>函数详解见上，或者<code>MATLAB</code>帮助中心。</p>
<p><strong>读取全部内容</strong>、<strong>读取特定部分内容</strong>、<strong>追加内容</strong>……</p>
</blockquote>
<h4 id="（1）xlsread-不推荐"><a href="#（1）xlsread-不推荐" class="headerlink" title="（1）xlsread()(不推荐)"></a><strong>（1）<code>xlsread()</code>(不推荐)</strong></h4><blockquote>
<ul>
<li>将工作表读取到数值矩阵</li>
<li>读取元胞的范围</li>
<li>读取列</li>
<li>请求数值、文本和原始数据</li>
<li>对工作表执行函数</li>
<li>请求自定义输出</li>
</ul>
</blockquote>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">% （1）读取名为filename的 Microsoft®Excel®电子表格工作表中的第一个工作表，并在一个矩阵中返回数值数据。</span></span><br><span class="line">num = xlsread(filename)</span><br><span class="line"><span class="comment">% （2）读取指定的工作表。</span></span><br><span class="line">num = xlsread(filename,sheet)</span><br><span class="line"><span class="comment">% （3）从工作簿的第一个工作表的指定范围内读取数据。使用Excel范围语法，例如&#x27;A1:C3&#x27;。</span></span><br><span class="line">num = xlsread(filename,xlRange)</span><br><span class="line"><span class="comment">% （4）读取指定的工作表和范围。</span></span><br><span class="line">num = xlsread(filename,sheet,xlRange)</span><br><span class="line"><span class="comment">% （5）在basic导入模式下读取电子表格中的数据。如果您的计算机未安装Windows®版 Excel或者您正在使用MATLAB®Online™，xlsread会自动在basic导入模式下运行，该模式支持XLS、XLSX、XLSM、XLTX和XLTM文件。</span></span><br><span class="line"><span class="comment">% 如果不指定所有参数，请使用空字符向量&#x27;&#x27;作为占位符，例如，num=xlsread(filename,&#x27;&#x27;,&#x27;&#x27;,&#x27;basic&#x27;)。</span></span><br><span class="line">num = xlsread(filename,sheet,xlRange,<span class="string">&#x27;basic&#x27;</span>)</span><br><span class="line"><span class="comment">% （6）支持上述语法中的任何输入参数，且可在元胞数组txt中返回文本字段，在元胞数组raw中返回数值数据和文本数据。</span></span><br><span class="line">[num,txt,raw] = xlsread(___)</span><br><span class="line"><span class="comment">% （7）打开一个Excel窗口以便按交互方式来选择数据。选择工作表，将鼠标拖放到所需范围上，然后点击确定。只有安装了Microsoft Excel软件的Windows计算机才支持此语法。</span></span><br><span class="line">___ = xlsread(filename,<span class="number">-1</span>)</span><br><span class="line"><span class="comment">% （8）读取电子表格，对数据调用processFcn，并在数组num中以数值数据的形式返回最终结果。xlsread函数在元胞数组txt中返回文本字段、在元胞数组raw中返回数值和文本数据，并在数组custom中返回processFcn的第二个输出。xlsread函数不会更改电子表格中存储的数据。只有安装了Excel软件的Windows计算机才支持此语法。</span></span><br><span class="line"><span class="comment">% （其中processFcn是函数句柄）</span></span><br><span class="line">[num,txt,raw,custom] = xlsread(filename,sheet,xlRange,<span class="string">&#x27;&#x27;</span>,processFcn)</span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">clc</span><br><span class="line">clear all</span><br><span class="line"></span><br><span class="line">values = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ; <span class="number">4</span>, <span class="number">5</span>, <span class="string">&#x27;x&#x27;</span> ; <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>&#125;</span><br><span class="line">headers = &#123;<span class="string">&#x27;First&#x27;</span>,<span class="string">&#x27;Second&#x27;</span>,<span class="string">&#x27;Third&#x27;</span>&#125;</span><br><span class="line">xlswrite(<span class="string">&#x27;D:\Desktop\myExample.xlsx&#x27;</span>,[headers; values])</span><br><span class="line">filename = <span class="string">&#x27;D:\Desktop\myExample.xlsx&#x27;</span></span><br><span class="line">data = xlsread(filename)</span><br><span class="line"></span><br><span class="line"><span class="comment">% 命令行窗口输出结果</span></span><br><span class="line">values =</span><br><span class="line">  <span class="number">3</span>×<span class="number">3</span> cell 数组</span><br><span class="line">    &#123;[<span class="number">1</span>]&#125;    &#123;[<span class="number">2</span>]&#125;    &#123;[<span class="number">3</span>]&#125;</span><br><span class="line">    &#123;[<span class="number">4</span>]&#125;    &#123;[<span class="number">5</span>]&#125;    &#123;<span class="string">&#x27;x&#x27;</span>&#125;</span><br><span class="line">    &#123;[<span class="number">7</span>]&#125;    &#123;[<span class="number">8</span>]&#125;    &#123;[<span class="number">9</span>]&#125;</span><br><span class="line">headers =</span><br><span class="line">  <span class="number">1</span>×<span class="number">3</span> cell 数组</span><br><span class="line">    &#123;<span class="string">&#x27;First&#x27;</span>&#125;    &#123;<span class="string">&#x27;Second&#x27;</span>&#125;    &#123;<span class="string">&#x27;Third&#x27;</span>&#125;</span><br><span class="line">data =</span><br><span class="line">     <span class="number">1</span>     <span class="number">2</span>     <span class="number">3</span></span><br><span class="line">     <span class="number">4</span>     <span class="number">5</span>   NaN</span><br><span class="line">     <span class="number">7</span>     <span class="number">8</span>     <span class="number">9</span></span><br></pre></td></tr></table></figure>

<h4 id="（2）readmatrix-1"><a href="#（2）readmatrix-1" class="headerlink" title="（2）readmatrix()"></a><strong>（2）<code>readmatrix()</code></strong></h4><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">clc</span><br><span class="line">clear all</span><br><span class="line"><span class="comment">% readmatrix第一个参数是文件名。第二个参数指输出类型。如果不带这个参数，那么字符串那一列的输出结果是Nan值</span></span><br><span class="line"><span class="comment">% 加上之后，则全部输出文本类型，后面再把要作为数值型的内容转换数据类型。</span></span><br><span class="line">data1 = readmatrix(<span class="string">&#x27;D:\Desktop\data2.xlsx&#x27;</span>, <span class="string">&#x27;OutputType&#x27;</span>, <span class="string">&#x27;string&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">% 命令行窗口输出结果</span></span><br><span class="line">data1 = </span><br><span class="line">  <span class="number">7</span>×<span class="number">6</span> string 数组</span><br><span class="line">    <span class="string">&quot;小红&quot;</span>    <span class="string">&quot;女&quot;</span>    <span class="string">&quot;20&quot;</span>    <span class="string">&quot;130&quot;</span>    <span class="string">&quot;140&quot;</span>    <span class="string">&quot;135&quot;</span></span><br><span class="line">    <span class="string">&quot;小汤&quot;</span>    <span class="string">&quot;男&quot;</span>    <span class="string">&quot;22&quot;</span>    <span class="string">&quot;131&quot;</span>    <span class="string">&quot;141&quot;</span>    <span class="string">&quot;136&quot;</span></span><br><span class="line">    <span class="string">&quot;小李&quot;</span>    <span class="string">&quot;男&quot;</span>    <span class="string">&quot;24&quot;</span>    <span class="string">&quot;132&quot;</span>    <span class="string">&quot;142&quot;</span>    <span class="string">&quot;137&quot;</span></span><br><span class="line">    <span class="string">&quot;小ai&quot;</span>    <span class="string">&quot;男&quot;</span>    <span class="string">&quot;21&quot;</span>    <span class="string">&quot;133&quot;</span>    <span class="string">&quot;143&quot;</span>    <span class="string">&quot;138&quot;</span></span><br><span class="line">    <span class="string">&quot;小张&quot;</span>    <span class="string">&quot;男&quot;</span>    <span class="string">&quot;25&quot;</span>    <span class="string">&quot;134&quot;</span>    <span class="string">&quot;144&quot;</span>    <span class="string">&quot;139&quot;</span></span><br><span class="line">    <span class="string">&quot;小小&quot;</span>    <span class="string">&quot;男&quot;</span>    <span class="string">&quot;20&quot;</span>    <span class="string">&quot;135&quot;</span>    <span class="string">&quot;145&quot;</span>    <span class="string">&quot;140&quot;</span></span><br><span class="line">    <span class="string">&quot;小耿&quot;</span>    <span class="string">&quot;男&quot;</span>    <span class="string">&quot;25&quot;</span>    <span class="string">&quot;136&quot;</span>    <span class="string">&quot;146&quot;</span>    <span class="string">&quot;141&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="（3）readtable"><a href="#（3）readtable" class="headerlink" title="（3）readtable()"></a><strong>（3）<code>readtable()</code></strong></h4><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">clc</span><br><span class="line">clear all</span><br><span class="line">data2 = <span class="built_in">readtable</span>(<span class="string">&#x27;D:\Desktop\data2.xlsx&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">% 命令行窗口输出结果</span></span><br><span class="line">data2 =</span><br><span class="line">  <span class="number">7</span>×<span class="number">6</span> <span class="built_in">table</span></span><br><span class="line">     name     gender    age    x__    x___1    x___2</span><br><span class="line">    ______    ______    ___    ___    _____    _____</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;小红&#x27;</span>     <span class="string">&#x27;女&#x27;</span>      <span class="number">20</span>     <span class="number">130</span>     <span class="number">140</span>      <span class="number">135</span> </span><br><span class="line">    <span class="string">&#x27;小汤&#x27;</span>     <span class="string">&#x27;男&#x27;</span>      <span class="number">22</span>     <span class="number">131</span>     <span class="number">141</span>      <span class="number">136</span> </span><br><span class="line">    <span class="string">&#x27;小李&#x27;</span>     <span class="string">&#x27;男&#x27;</span>      <span class="number">24</span>     <span class="number">132</span>     <span class="number">142</span>      <span class="number">137</span> </span><br><span class="line">    <span class="string">&#x27;小ai&#x27;</span>     <span class="string">&#x27;男&#x27;</span>     <span class="number">21</span>     <span class="number">133</span>     <span class="number">143</span>      <span class="number">138</span> </span><br><span class="line">    <span class="string">&#x27;小张&#x27;</span>     <span class="string">&#x27;男&#x27;</span>      <span class="number">25</span>     <span class="number">134</span>     <span class="number">144</span>      <span class="number">139</span> </span><br><span class="line">    <span class="string">&#x27;小小&#x27;</span>     <span class="string">&#x27;男&#x27;</span>      <span class="number">20</span>     <span class="number">135</span>     <span class="number">145</span>      <span class="number">140</span> </span><br><span class="line">    <span class="string">&#x27;小耿&#x27;</span>     <span class="string">&#x27;男&#x27;</span>      <span class="number">25</span>     <span class="number">136</span>     <span class="number">146</span>      <span class="number">141</span> </span><br></pre></td></tr></table></figure>

<h4 id="（4）xlswrite-不推荐"><a href="#（4）xlswrite-不推荐" class="headerlink" title="（4）xlswrite()(不推荐)"></a><strong>（4）<code>xlswrite()</code>(不推荐)</strong></h4><blockquote>
<ul>
<li>将向量写入电子表格</li>
<li>写入电子表格的特定工作表和范围</li>
</ul>
</blockquote>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">% （1）将矩阵A写入Microsoft®Excel®电子表格工作簿filename中的第一个工作表，从单元格A1开始写入。</span></span><br><span class="line">xlswrite(filename,A)</span><br><span class="line"><span class="comment">% （2）将数据写入指定的工作表。</span></span><br><span class="line">xlswrite(filename,A,sheet)</span><br><span class="line"><span class="comment">% （3）将数据写入工作簿的第一个工作表中由xlRange指定的矩形区域内。使用Excel范围语法，例如&#x27;A1:C3&#x27;。</span></span><br><span class="line">xlswrite(filename,A,xlRange)</span><br><span class="line"><span class="comment">% （4）将数据写入指定的工作表和范围。</span></span><br><span class="line">xlswrite(filename,A,sheet,xlRange)</span><br><span class="line"><span class="comment">% （5）使用先前语法中的任何输入参数返回写入操作的状态。当操作成功时，status为1。否则，status为0。</span></span><br><span class="line">status = xlswrite(___)</span><br><span class="line"><span class="comment">% （6）还在结构体message中返回写入操作生成的任何警告或错误消息。</span></span><br><span class="line">[status,message] = xlswrite(___)</span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">clc</span><br><span class="line">clear all</span><br><span class="line"></span><br><span class="line"><span class="comment">% 写入电子表格的特定工作表和范围</span></span><br><span class="line">A = &#123;<span class="string">&#x27;Time&#x27;</span>,<span class="string">&#x27;Temperature&#x27;</span>; <span class="number">12</span>,<span class="number">98</span>; <span class="number">13</span>,<span class="number">99</span>; <span class="number">14</span>,<span class="number">97</span>&#125;</span><br><span class="line">sheet = <span class="number">2</span></span><br><span class="line">xlRange = <span class="string">&#x27;E1&#x27;</span></span><br><span class="line">xlswrite(<span class="string">&#x27;D:\Desktop\mytest.xlsx&#x27;</span>,A,sheet,xlRange)</span><br></pre></td></tr></table></figure>

<h4 id="（5）writematrix"><a href="#（5）writematrix" class="headerlink" title="（5）writematrix()"></a><strong>（5）<code>writematrix()</code></strong></h4><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">clc</span><br><span class="line">clear all</span><br><span class="line"></span><br><span class="line">Excel_data = readmatrix(<span class="string">&#x27;D:\Desktop\data2.xlsx&#x27;</span>, <span class="string">&#x27;OutputType&#x27;</span>, <span class="string">&#x27;string&#x27;</span>)</span><br><span class="line">writematrix(Excel_data,<span class="string">&#x27;D:\Desktop\output2.xlsx&#x27;</span>)</span><br><span class="line"><span class="comment">% 我的MATLAB版本是R2019a,追加时显示参数名称 WriteMode无效</span></span><br><span class="line"><span class="comment">% writematrix(Excel_data,&#x27;D:\Desktop\output2.xlsx&#x27;,&#x27;WriteMode&#x27;,&#x27;append&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% 命令行窗口输出结果</span></span><br><span class="line">Excel_data = </span><br><span class="line">  <span class="number">7</span>×<span class="number">6</span> string 数组</span><br><span class="line">    <span class="string">&quot;小红&quot;</span>    <span class="string">&quot;女&quot;</span>    <span class="string">&quot;20&quot;</span>    <span class="string">&quot;130&quot;</span>    <span class="string">&quot;140&quot;</span>    <span class="string">&quot;135&quot;</span></span><br><span class="line">    <span class="string">&quot;小汤&quot;</span>    <span class="string">&quot;男&quot;</span>    <span class="string">&quot;22&quot;</span>    <span class="string">&quot;131&quot;</span>    <span class="string">&quot;141&quot;</span>    <span class="string">&quot;136&quot;</span></span><br><span class="line">    <span class="string">&quot;小李&quot;</span>    <span class="string">&quot;男&quot;</span>    <span class="string">&quot;24&quot;</span>    <span class="string">&quot;132&quot;</span>    <span class="string">&quot;142&quot;</span>    <span class="string">&quot;137&quot;</span></span><br><span class="line">    <span class="string">&quot;小ai&quot;</span>    <span class="string">&quot;男&quot;</span>    <span class="string">&quot;21&quot;</span>    <span class="string">&quot;133&quot;</span>    <span class="string">&quot;143&quot;</span>    <span class="string">&quot;138&quot;</span></span><br><span class="line">    <span class="string">&quot;小张&quot;</span>    <span class="string">&quot;男&quot;</span>    <span class="string">&quot;25&quot;</span>    <span class="string">&quot;134&quot;</span>    <span class="string">&quot;144&quot;</span>    <span class="string">&quot;139&quot;</span></span><br><span class="line">    <span class="string">&quot;小小&quot;</span>    <span class="string">&quot;男&quot;</span>    <span class="string">&quot;20&quot;</span>    <span class="string">&quot;135&quot;</span>    <span class="string">&quot;145&quot;</span>    <span class="string">&quot;140&quot;</span></span><br><span class="line">    <span class="string">&quot;小耿&quot;</span>    <span class="string">&quot;男&quot;</span>    <span class="string">&quot;25&quot;</span>    <span class="string">&quot;136&quot;</span>    <span class="string">&quot;146&quot;</span>    <span class="string">&quot;141&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="（6）writetable"><a href="#（6）writetable" class="headerlink" title="（6）writetable()"></a><strong>（6）<code>writetable()</code></strong></h4><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">clc</span><br><span class="line">clear all</span><br><span class="line"></span><br><span class="line">LastName = &#123;<span class="string">&#x27;Sanchez&#x27;</span>;<span class="string">&#x27;Johnson&#x27;</span>;<span class="string">&#x27;Li&#x27;</span>;<span class="string">&#x27;Diaz&#x27;</span>;<span class="string">&#x27;Brown&#x27;</span>&#125;</span><br><span class="line">Age = [<span class="number">38</span>;<span class="number">43</span>;<span class="number">38</span>;<span class="number">40</span>;<span class="number">49</span>]</span><br><span class="line">Smoker = logical([<span class="number">1</span>;<span class="number">0</span>;<span class="number">1</span>;<span class="number">0</span>;<span class="number">1</span>])</span><br><span class="line">Height = [<span class="number">71</span>;<span class="number">69</span>;<span class="number">64</span>;<span class="number">67</span>;<span class="number">64</span>]</span><br><span class="line">Weight = [<span class="number">176</span>;<span class="number">163</span>;<span class="number">131</span>;<span class="number">133</span>;<span class="number">119</span>]</span><br><span class="line">BloodPressure = [<span class="number">124</span> <span class="number">93</span>; <span class="number">109</span> <span class="number">77</span>; <span class="number">125</span> <span class="number">83</span>; <span class="number">117</span> <span class="number">75</span>; <span class="number">122</span> <span class="number">80</span>]</span><br><span class="line">table_csv = <span class="built_in">table</span>(LastName,Age,Smoker,Height,Weight,BloodPressure)</span><br><span class="line"><span class="comment">% 自定义列索引和行索引</span></span><br><span class="line">table_csv.Properties.VariableNames = &#123;<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;f&#x27;</span>&#125;</span><br><span class="line">table_csv.Properties.RowNames = &#123;<span class="string">&#x27;g&#x27;</span>,<span class="string">&#x27;h&#x27;</span>,<span class="string">&#x27;i&#x27;</span>,<span class="string">&#x27;j&#x27;</span>,<span class="string">&#x27;k&#x27;</span>&#125;</span><br><span class="line"><span class="built_in">writetable</span>(table_csv,<span class="string">&quot;D:\Desktop\output3.xlsx&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">% 命令行窗口输出结果</span></span><br><span class="line">table_csv =</span><br><span class="line">  <span class="number">5</span>×<span class="number">6</span> <span class="built_in">table</span></span><br><span class="line">             a        b       c      d      e         f     </span><br><span class="line">         _________    __    _____    __    ___    __________</span><br><span class="line">    g    <span class="string">&#x27;Sanchez&#x27;</span>    <span class="number">38</span>    <span class="built_in">true</span>     <span class="number">71</span>    <span class="number">176</span>    <span class="number">124</span>     <span class="number">93</span></span><br><span class="line">    h    <span class="string">&#x27;Johnson&#x27;</span>    <span class="number">43</span>    <span class="built_in">false</span>    <span class="number">69</span>    <span class="number">163</span>    <span class="number">109</span>     <span class="number">77</span></span><br><span class="line">    <span class="built_in">i</span>    <span class="string">&#x27;Li&#x27;</span>         <span class="number">38</span>    <span class="built_in">true</span>     <span class="number">64</span>    <span class="number">131</span>    <span class="number">125</span>     <span class="number">83</span></span><br><span class="line">    <span class="built_in">j</span>    <span class="string">&#x27;Diaz&#x27;</span>       <span class="number">40</span>    <span class="built_in">false</span>    <span class="number">67</span>    <span class="number">133</span>    <span class="number">117</span>     <span class="number">75</span></span><br><span class="line">    k    <span class="string">&#x27;Brown&#x27;</span>      <span class="number">49</span>    <span class="built_in">true</span>     <span class="number">64</span>    <span class="number">119</span>    <span class="number">122</span>     <span class="number">80</span></span><br></pre></td></tr></table></figure>

<h3 id="👀JSON-1"><a href="#👀JSON-1" class="headerlink" title="👀JSON"></a>👀JSON</h3><blockquote>
<p><code>MATLAB</code>读取<code>JSON</code>的方式利用<a target="_blank" rel="noopener" href="https://github.com/fangq/jsonlab"><strong><code>JSONlab</code>工具箱</strong></a></p>
<p>①将下载的工具箱安装包解压缩放入<code>MATLAB</code>安装目录下的<code>toolbox</code>文件夹下；</p>
<p>②打开<code>MATLAB</code>，选择”主页“→”设置路径“，将工具箱所在文件夹导入。</p>
</blockquote>
<p><code>JSON</code>源文件</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;FeatureCollection&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;features&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Feature&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;properties&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;geometry&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;coordinates&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="number">116.3591064789793</span><span class="punctuation">,</span> <span class="number">40.0611769097348</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="punctuation">[</span><span class="number">116.35882714532096</span><span class="punctuation">,</span> <span class="number">40.06035824493355</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="punctuation">[</span><span class="number">116.3588680234169</span><span class="punctuation">,</span> <span class="number">40.06017052423036</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="punctuation">[</span><span class="number">116.3592154872361</span><span class="punctuation">,</span> <span class="number">40.05968557668524</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="punctuation">[</span><span class="number">116.35964470724883</span><span class="punctuation">,</span> <span class="number">40.05949263960517</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="punctuation">[</span><span class="number">116.36125939205749</span><span class="punctuation">,</span> <span class="number">40.05968557668524</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="punctuation">[</span><span class="number">116.36073478982053</span><span class="punctuation">,</span> <span class="number">40.06143241456951</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="punctuation">[</span><span class="number">116.3591064789793</span><span class="punctuation">,</span> <span class="number">40.0611769097348</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Polygon&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Feature&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;properties&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;geometry&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;coordinates&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="number">116.35838429946176</span><span class="punctuation">,</span> <span class="number">40.0595499993847</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Point&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Feature&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;properties&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;geometry&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;coordinates&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="number">116.36078873507478</span><span class="punctuation">,</span> <span class="number">40.06152377992771</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Point&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>利用<code>Matlab</code>读取<code>JSON</code></p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">clc</span><br><span class="line">clear all</span><br><span class="line"></span><br><span class="line"><span class="comment">% 读取json需要导入JSONlab工具箱</span></span><br><span class="line">jsonData = loadjson(<span class="string">&#x27;D:\Desktop\map.geojson&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">% 命令行窗口输出结果</span></span><br><span class="line">jsonData = </span><br><span class="line">  包含以下字段的 struct:</span><br><span class="line">        <span class="built_in">type</span>: <span class="string">&#x27;FeatureCollection&#x27;</span></span><br><span class="line">    features: [<span class="number">1</span>×<span class="number">3</span> struct]</span><br></pre></td></tr></table></figure>

<p>利用<code>Matlab</code>写入<code>JSON</code></p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">clc</span><br><span class="line">clear all</span><br><span class="line"></span><br><span class="line"><span class="comment">% 创建结构体变量</span></span><br><span class="line">data.<span class="built_in">type</span> = <span class="string">&#x27;Feature&#x27;</span></span><br><span class="line">data.<span class="keyword">properties</span> = &#123;&#125;</span><br><span class="line">data.geometry.coordinates = [<span class="number">116.36078873507478</span>, <span class="number">40.06152377992771</span>]</span><br><span class="line">data.geometry.<span class="built_in">type</span> = <span class="string">&#x27;Point&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% 将结构体变量写入JSON文件</span></span><br><span class="line">savejson(<span class="string">&#x27;&#x27;</span>, data, <span class="string">&#x27;D:\Desktop\test.json&#x27;</span>)</span><br><span class="line"><span class="comment">% 从JSON文件中读取数据</span></span><br><span class="line">jsonData = loadjson(<span class="string">&#x27;D:\Desktop\test.json&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">% 命令行窗口输出结果</span></span><br><span class="line">data = </span><br><span class="line">  包含以下字段的 struct:</span><br><span class="line">    <span class="built_in">type</span>: <span class="string">&#x27;Feature&#x27;</span></span><br><span class="line">data = </span><br><span class="line">  包含以下字段的 struct:</span><br><span class="line">          <span class="built_in">type</span>: <span class="string">&#x27;Feature&#x27;</span></span><br><span class="line">    <span class="keyword">properties</span>: &#123;&#125;</span><br><span class="line">data = </span><br><span class="line">  包含以下字段的 struct:</span><br><span class="line">          <span class="built_in">type</span>: <span class="string">&#x27;Feature&#x27;</span></span><br><span class="line">    <span class="keyword">properties</span>: &#123;&#125;</span><br><span class="line">      geometry: [<span class="number">1</span>×<span class="number">1</span> struct]</span><br><span class="line">data = </span><br><span class="line">  包含以下字段的 struct:</span><br><span class="line">          <span class="built_in">type</span>: <span class="string">&#x27;Feature&#x27;</span></span><br><span class="line">    <span class="keyword">properties</span>: &#123;&#125;</span><br><span class="line">      geometry: [<span class="number">1</span>×<span class="number">1</span> struct]</span><br><span class="line">jsonData = </span><br><span class="line">  包含以下字段的 struct:</span><br><span class="line">          <span class="built_in">type</span>: <span class="string">&#x27;Feature&#x27;</span></span><br><span class="line">    <span class="keyword">properties</span>: &#123;<span class="number">0</span>×<span class="number">1</span> cell&#125;</span><br><span class="line">      geometry: [<span class="number">1</span>×<span class="number">1</span> struct]</span><br></pre></td></tr></table></figure>

<h3 id="👀XML-1"><a href="#👀XML-1" class="headerlink" title="👀XML"></a>👀XML</h3><blockquote>
<p><strong>参数详解见<code>MATLAB</code>帮助中心。</strong></p>
<p><code>xmlread()</code>读取<code>XML</code>文档并返回文档对象模型节点</p>
<ul>
<li><p>将<code>XML</code>文件读入文档对象模型 (<code>DOM</code>) 节点中</p>
</li>
<li><p>将该<code>XML</code>文件读入<code>MATLAB®</code>结构体数组中</p>
</li>
</ul>
<p><code>xmlwrite()</code>写入<code>XML</code>文档对象模型节点</p>
<ul>
<li><p>创建<code>XML</code>文件</p>
</li>
<li><p>以串行化文本形式获取文档对象模型 (<code>DOM</code>) 节点</p>
</li>
</ul>
</blockquote>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">% （1）读取指定的XML文件并返回一个Apache®Xerces-J文档对象，该对象表示该XML文件的解析版本。Apache Xerces-J实现用于XML处理的Java®API(JAXP)。使用JAXP函数来操作此文档对象。有关Apache Xerces-J的详细信息，请参阅https://xerces.apache.org/xerces-j/apiDocs/。</span></span><br><span class="line">DOMnode = xmlread(filename)</span><br><span class="line"><span class="comment">% （2）还指定是否允许DOCTYPE声明。如果tf为false，则读取包含DOCTYPE声明的输入XML文件会导致错误。如果为true，xmlread则会为XML文件返回输出DOMnode。tf的默认值是true。</span></span><br><span class="line">DOMnode = xmlread(filename,<span class="string">&#x27;AllowDoctype&#x27;</span>,tf)</span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">% （1）将文档对象模型(DOM)节点DOMnode写入到文件filename。使用xmlwrite要求您使用用于XML处理的Java® API(JAXP)。有关详细信息，请参阅https://docs.oracle.com/javase/7/docs/api。</span></span><br><span class="line">xmlwrite(filename,DOMnode)</span><br><span class="line"><span class="comment">% （2）以字符向量形式返回串行化DOM节点。</span></span><br><span class="line">chr = xmlwrite(DOMnode)</span><br></pre></td></tr></table></figure>

<h4 id="（1）读取XML-1"><a href="#（1）读取XML-1" class="headerlink" title="（1）读取XML"></a><strong>（1）读取XML</strong></h4><p><code>XML</code>源文件：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;ISO-8859-1&quot;</span>?&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Edited by XMLSpyÂ® --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">breakfast_menu</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">food</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">name</span>&gt;</span>Belgian Waffles<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">price</span>&gt;</span>$5.95<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">calories</span>&gt;</span>650<span class="tag">&lt;/<span class="name">calories</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">cropRegion</span> <span class="attr">x</span>=<span class="string">&quot;0&quot;</span> <span class="attr">y</span>=<span class="string">&quot;0&quot;</span> <span class="attr">width</span>=<span class="string">&quot;0000&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1234&quot;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">food</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">food</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">name</span>&gt;</span>Strawberry Belgian Waffles<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">price</span>&gt;</span>$7.95<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">calories</span>&gt;</span>900<span class="tag">&lt;/<span class="name">calories</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">cropRegion</span> <span class="attr">x</span>=<span class="string">&quot;1&quot;</span> <span class="attr">y</span>=<span class="string">&quot;1&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1111&quot;</span> <span class="attr">height</span>=<span class="string">&quot;2345&quot;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">food</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">food</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">name</span>&gt;</span>Berry-Berry Belgian Waffles<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">price</span>&gt;</span>$8.95<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">calories</span>&gt;</span>900<span class="tag">&lt;/<span class="name">calories</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">cropRegion</span> <span class="attr">x</span>=<span class="string">&quot;2&quot;</span> <span class="attr">y</span>=<span class="string">&quot;2&quot;</span> <span class="attr">width</span>=<span class="string">&quot;2222&quot;</span> <span class="attr">height</span>=<span class="string">&quot;3456&quot;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">food</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">food</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">name</span>&gt;</span>French Toast<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">price</span>&gt;</span>$4.50<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">calories</span>&gt;</span>600<span class="tag">&lt;/<span class="name">calories</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">cropRegion</span> <span class="attr">x</span>=<span class="string">&quot;3&quot;</span> <span class="attr">y</span>=<span class="string">&quot;3&quot;</span> <span class="attr">width</span>=<span class="string">&quot;3333&quot;</span> <span class="attr">height</span>=<span class="string">&quot;4567&quot;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">food</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">food</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">name</span>&gt;</span>Homestyle Breakfast<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">price</span>&gt;</span>$6.95<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">calories</span>&gt;</span>950<span class="tag">&lt;/<span class="name">calories</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">cropRegion</span> <span class="attr">x</span>=<span class="string">&quot;4&quot;</span> <span class="attr">y</span>=<span class="string">&quot;4&quot;</span> <span class="attr">width</span>=<span class="string">&quot;4444&quot;</span> <span class="attr">height</span>=<span class="string">&quot;5678&quot;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">food</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">breakfast_menu</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>利用<code>xmlread()</code>读取<code>XML</code>，同时利用函数 <code>parseXML()</code>将该<code>XML</code>文件读入<code>MATLAB</code>®结构体数组中：</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">% 创建一个解析函数以将一个XML文件读入MATLAB®结构体中，然后将一个示例XML文件读入MATLAB工作区中。要创建函数parseXML，请将以下代码复制并粘贴到m文件parseXML.m中。parseXML函数将一个XML文件中的数据解析为一个MATLAB结构体数组，该数组包含字段Name、Attributes、Data和Children。</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">theStruct</span> = <span class="title">parseXML</span><span class="params">(filename)</span></span></span><br><span class="line"><span class="comment">% PARSEXML Convert XML file to a MATLAB structure.</span></span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">   tree = xmlread(filename);</span><br><span class="line"><span class="keyword">catch</span></span><br><span class="line">   error(<span class="string">&#x27;Failed to read XML file %s.&#x27;</span>,filename);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% Recurse over child nodes. This could run into problems </span></span><br><span class="line"><span class="comment">% with very deeply nested trees.</span></span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">   theStruct = parseChildNodes(tree);</span><br><span class="line"><span class="keyword">catch</span></span><br><span class="line">   error(<span class="string">&#x27;Unable to parse XML file %s.&#x27;</span>,filename);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">% ----- Local function PARSECHILDNODES -----</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">children</span> = <span class="title">parseChildNodes</span><span class="params">(theNode)</span></span></span><br><span class="line"><span class="comment">% Recurse over node children.</span></span><br><span class="line">children = [];</span><br><span class="line"><span class="keyword">if</span> theNode.hasChildNodes</span><br><span class="line">   childNodes = theNode.getChildNodes;</span><br><span class="line">   numChildNodes = childNodes.getLength;</span><br><span class="line">   allocCell = cell(<span class="number">1</span>, numChildNodes);</span><br><span class="line"></span><br><span class="line">   children = struct(             ...</span><br><span class="line">      <span class="string">&#x27;Name&#x27;</span>, allocCell, <span class="string">&#x27;Attributes&#x27;</span>, allocCell,    ...</span><br><span class="line">      <span class="string">&#x27;Data&#x27;</span>, allocCell, <span class="string">&#x27;Children&#x27;</span>, allocCell);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> count = <span class="number">1</span>:numChildNodes</span><br><span class="line">        theChild = childNodes.item(count<span class="number">-1</span>);</span><br><span class="line">        children(count) = makeStructFromNode(theChild);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% ----- Local function MAKESTRUCTFROMNODE -----</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">nodeStruct</span> = <span class="title">makeStructFromNode</span><span class="params">(theNode)</span></span></span><br><span class="line"><span class="comment">% Create structure of node info.</span></span><br><span class="line"></span><br><span class="line">nodeStruct = struct(                        ...</span><br><span class="line">   <span class="string">&#x27;Name&#x27;</span>, char(theNode.getNodeName),       ...</span><br><span class="line">   <span class="string">&#x27;Attributes&#x27;</span>, parseAttributes(theNode),  ...</span><br><span class="line">   <span class="string">&#x27;Data&#x27;</span>, <span class="string">&#x27;&#x27;</span>,                              ...</span><br><span class="line">   <span class="string">&#x27;Children&#x27;</span>, parseChildNodes(theNode));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> any(strcmp(<span class="keyword">methods</span>(theNode), <span class="string">&#x27;getData&#x27;</span>))</span><br><span class="line">   nodeStruct.Data = char(theNode.getData); </span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   nodeStruct.Data = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% ----- Local function PARSEATTRIBUTES -----</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">attributes</span> = <span class="title">parseAttributes</span><span class="params">(theNode)</span></span></span><br><span class="line"><span class="comment">% Create attributes structure.</span></span><br><span class="line"></span><br><span class="line">attributes = [];</span><br><span class="line"><span class="keyword">if</span> theNode.hasAttributes</span><br><span class="line">   theAttributes = theNode.getAttributes;</span><br><span class="line">   numAttributes = theAttributes.getLength;</span><br><span class="line">   allocCell = cell(<span class="number">1</span>, numAttributes);</span><br><span class="line">   attributes = struct(<span class="string">&#x27;Name&#x27;</span>, allocCell, <span class="string">&#x27;Value&#x27;</span>, ...</span><br><span class="line">                       allocCell);</span><br><span class="line"></span><br><span class="line">   <span class="keyword">for</span> count = <span class="number">1</span>:numAttributes</span><br><span class="line">      attrib = theAttributes.item(count<span class="number">-1</span>);</span><br><span class="line">      attributes(count).Name = char(attrib.getName);</span><br><span class="line">      attributes(count).Value = char(attrib.getValue);</span><br><span class="line">   <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">clc</span><br><span class="line">clear all</span><br><span class="line"></span><br><span class="line">sampleXMLfile = <span class="string">&#x27;D:\Desktop\simple.xml&#x27;</span>;</span><br><span class="line"><span class="comment">% 显示simple.xml文件内容</span></span><br><span class="line"><span class="built_in">type</span>(sampleXMLfile)</span><br><span class="line"><span class="comment">% 将该XML文件读入DOM节点中</span></span><br><span class="line"><span class="comment">% DOMnode = xmlread(sampleXMLfile)</span></span><br><span class="line"><span class="comment">% 使用parseXML函数将示例文件info.xml解析为一个MATLAB结构体。</span></span><br><span class="line">mlStruct = parseXML(sampleXMLfile)</span><br><span class="line"></span><br><span class="line"><span class="comment">% 命令行窗口输出结果</span></span><br><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;ISO-8859-1&quot;</span>?&gt;</span><br><span class="line">&lt;!-- Edited by XMLSpy庐 --&gt;</span><br><span class="line">&lt;breakfast_menu&gt;</span><br><span class="line">	&lt;food&gt;</span><br><span class="line">		&lt;name&gt;Belgian Waffles&lt;/name&gt;</span><br><span class="line">		&lt;price&gt;$<span class="number">5.95</span>&lt;/price&gt;</span><br><span class="line">		&lt;calories&gt;<span class="number">650</span>&lt;/calories&gt;</span><br><span class="line">		&lt;cropRegion x=<span class="string">&quot;0&quot;</span> y=<span class="string">&quot;0&quot;</span> width=<span class="string">&quot;0000&quot;</span> height=<span class="string">&quot;1234&quot;</span>/&gt;</span><br><span class="line">	&lt;/food&gt;</span><br><span class="line">	&lt;food&gt;</span><br><span class="line">		&lt;name&gt;Strawberry Belgian Waffles&lt;/name&gt;</span><br><span class="line">		&lt;price&gt;$<span class="number">7.95</span>&lt;/price&gt;</span><br><span class="line">		&lt;calories&gt;<span class="number">900</span>&lt;/calories&gt;</span><br><span class="line">		&lt;cropRegion x=<span class="string">&quot;1&quot;</span> y=<span class="string">&quot;1&quot;</span> width=<span class="string">&quot;1111&quot;</span> height=<span class="string">&quot;2345&quot;</span>/&gt;</span><br><span class="line">	&lt;/food&gt;</span><br><span class="line">	&lt;food&gt;</span><br><span class="line">		&lt;name&gt;Berry-Berry Belgian Waffles&lt;/name&gt;</span><br><span class="line">		&lt;price&gt;$<span class="number">8.95</span>&lt;/price&gt;</span><br><span class="line">		&lt;calories&gt;<span class="number">900</span>&lt;/calories&gt;</span><br><span class="line">		&lt;cropRegion x=<span class="string">&quot;2&quot;</span> y=<span class="string">&quot;2&quot;</span> width=<span class="string">&quot;2222&quot;</span> height=<span class="string">&quot;3456&quot;</span>/&gt;</span><br><span class="line">	&lt;/food&gt;</span><br><span class="line">	&lt;food&gt;</span><br><span class="line">		&lt;name&gt;French Toast&lt;/name&gt;</span><br><span class="line">		&lt;price&gt;$<span class="number">4.50</span>&lt;/price&gt;</span><br><span class="line">		&lt;calories&gt;<span class="number">600</span>&lt;/calories&gt;</span><br><span class="line">		&lt;cropRegion x=<span class="string">&quot;3&quot;</span> y=<span class="string">&quot;3&quot;</span> width=<span class="string">&quot;3333&quot;</span> height=<span class="string">&quot;4567&quot;</span>/&gt;</span><br><span class="line">	&lt;/food&gt;</span><br><span class="line">	&lt;food&gt;</span><br><span class="line">		&lt;name&gt;Homestyle Breakfast&lt;/name&gt;</span><br><span class="line">		&lt;price&gt;$<span class="number">6.95</span>&lt;/price&gt;</span><br><span class="line">		&lt;calories&gt;<span class="number">950</span>&lt;/calories&gt;</span><br><span class="line">		&lt;cropRegion x=<span class="string">&quot;4&quot;</span> y=<span class="string">&quot;4&quot;</span> width=<span class="string">&quot;4444&quot;</span> height=<span class="string">&quot;5678&quot;</span>/&gt;</span><br><span class="line">	&lt;/food&gt;</span><br><span class="line">&lt;/breakfast_menu&gt;</span><br><span class="line"></span><br><span class="line">mlStruct = </span><br><span class="line">  包含以下字段的 <span class="number">1</span>×<span class="number">2</span> struct 数组:</span><br><span class="line">    Name</span><br><span class="line">    Attributes</span><br><span class="line">    Data</span><br><span class="line">    Children</span><br></pre></td></tr></table></figure>

<h4 id="（2）写入XML-1"><a href="#（2）写入XML-1" class="headerlink" title="（2）写入XML"></a><strong>（2）写入XML</strong></h4><blockquote>
<p>分两步编写<code>XML</code>文件：</p>
<p>①创建一个包含<code>XML</code>数据的文档对象模型 (<code>DOM</code>) 节点；</p>
<p>②将该<code>DOM</code>节点写入一个<code>XML</code>文件。</p>
</blockquote>
<p>要实现的写入内容：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">toc</span> <span class="attr">version</span>=<span class="string">&quot;2.0&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">tocitem</span> <span class="attr">target</span>=<span class="string">&quot;upslope_product_page.html&quot;</span>&gt;</span>Upslope Area Toolbox<span class="comment">&lt;!-- Functions --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">tocitem</span> <span class="attr">target</span>=<span class="string">&quot;demFlow_help.html&quot;</span>&gt;</span>demFlow<span class="tag">&lt;/<span class="name">tocitem</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">tocitem</span> <span class="attr">target</span>=<span class="string">&quot;facetFlow_help.html&quot;</span>&gt;</span>facetFlow<span class="tag">&lt;/<span class="name">tocitem</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">tocitem</span> <span class="attr">target</span>=<span class="string">&quot;flowMatrix_help.html&quot;</span>&gt;</span>flowMatrix<span class="tag">&lt;/<span class="name">tocitem</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">tocitem</span> <span class="attr">target</span>=<span class="string">&quot;pixelFlow_help.html&quot;</span>&gt;</span>pixelFlow<span class="tag">&lt;/<span class="name">tocitem</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">tocitem</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">toc</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>利用<code>xmlwrite()</code>写入<code>XML</code>文档：</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">clc</span><br><span class="line">clear all</span><br><span class="line"></span><br><span class="line"><span class="comment">% 创建DOM节点对象和根元素，然后根据XML数据填充节点元素和节点属性。</span></span><br><span class="line">docNode = com.mathworks.xml.XMLUtils.createDocument(<span class="string">&#x27;toc&#x27;</span>);</span><br><span class="line"><span class="comment">% 确定根元素并设置version属性。</span></span><br><span class="line">toc = docNode.getDocumentElement;</span><br><span class="line">toc.setAttribute(<span class="string">&#x27;version&#x27;</span>,<span class="string">&#x27;2.0&#x27;</span>);</span><br><span class="line"><span class="comment">% 添加tocitem元素。此文件中的每个tocitem元素都有一个target属性和一个子文本节点。</span></span><br><span class="line">product = docNode.createElement(<span class="string">&#x27;tocitem&#x27;</span>);</span><br><span class="line">product.setAttribute(<span class="string">&#x27;target&#x27;</span>,<span class="string">&#x27;upslope_product_page.html&#x27;</span>);</span><br><span class="line">product.appendChild(docNode.createTextNode(<span class="string">&#x27;Upslope Area Toolbox&#x27;</span>));</span><br><span class="line">toc.appendChild(product);</span><br><span class="line"><span class="comment">% 添加注释</span></span><br><span class="line">product.appendChild(docNode.createComment(<span class="string">&#x27; Functions &#x27;</span>));</span><br><span class="line"><span class="comment">% 为每个函数添加一个tocitem元素</span></span><br><span class="line">functions = &#123;<span class="string">&#x27;demFlow&#x27;</span>,<span class="string">&#x27;facetFlow&#x27;</span>,<span class="string">&#x27;flowMatrix&#x27;</span>,<span class="string">&#x27;pixelFlow&#x27;</span>&#125;;</span><br><span class="line"><span class="keyword">for</span> idx = <span class="number">1</span>:<span class="built_in">numel</span>(functions)</span><br><span class="line">    curr_node = docNode.createElement(<span class="string">&#x27;tocitem&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">    curr_file = [functions&#123;idx&#125; <span class="string">&#x27;_help.html&#x27;</span>]; </span><br><span class="line">    curr_node.setAttribute(<span class="string">&#x27;target&#x27;</span>,curr_file);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">% Child text is the function name.</span></span><br><span class="line">    curr_node.appendChild(docNode.createTextNode(functions&#123;idx&#125;));</span><br><span class="line">    product.appendChild(curr_node);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">% 将DOM节点导出到名为infoUAT.xml的XML文件中，并使用type函数查看该文件</span></span><br><span class="line">xmlwrite(<span class="string">&#x27;D:\Desktop\infoUAT.xml&#x27;</span>,docNode);</span><br><span class="line"><span class="built_in">type</span>(<span class="string">&#x27;D:\Desktop\infoUAT.xml&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">% 命令行窗口输出结果</span></span><br><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="line">&lt;toc version=<span class="string">&quot;2.0&quot;</span>&gt;</span><br><span class="line">   &lt;tocitem target=<span class="string">&quot;upslope_product_page.html&quot;</span>&gt;Upslope Area Toolbox&lt;!-- Functions --&gt;		  &lt;tocitem target=<span class="string">&quot;demFlow_help.html&quot;</span>&gt;demFlow&lt;/tocitem&gt;</span><br><span class="line">      &lt;tocitem target=<span class="string">&quot;facetFlow_help.html&quot;</span>&gt;facetFlow&lt;/tocitem&gt;</span><br><span class="line">      &lt;tocitem target=<span class="string">&quot;flowMatrix_help.html&quot;</span>&gt;flowMatrix&lt;/tocitem&gt;</span><br><span class="line">      &lt;tocitem target=<span class="string">&quot;pixelFlow_help.html&quot;</span>&gt;pixelFlow&lt;/tocitem&gt;</span><br><span class="line">   &lt;/tocitem&gt;</span><br><span class="line">&lt;/toc&gt;</span><br></pre></td></tr></table></figure>

<h3 id="👀TXT（函数例举）"><a href="#👀TXT（函数例举）" class="headerlink" title="👀TXT（函数例举）"></a>👀TXT（函数例举）</h3><blockquote>
<ul>
<li><p><code>textread()</code></p>
</li>
<li><p><code>textscan()</code></p>
</li>
<li><p><code>readmatrix()</code></p>
</li>
<li><p><code>writematrix()</code></p>
</li>
<li><p><code>readtable()</code></p>
</li>
<li><p><code>writetable()</code></p>
</li>
<li><p><code>load()</code></p>
</li>
<li><p><code>dlmread()</code></p>
</li>
<li><p><code>dlmwrite()</code></p>
</li>
<li><p><code>importdata()</code></p>
</li>
<li><p><code>save()</code></p>
</li>
<li><p>……</p>
</li>
</ul>
</blockquote>
<h2 id="⛄IDL之读写文件"><a href="#⛄IDL之读写文件" class="headerlink" title="⛄IDL之读写文件"></a>⛄IDL之读写文件</h2><p><code>IDL</code>从磁盘上的文件读写数据，必须首先把一个逻辑设备号连接到一个特定的文件，然后进行文件操作如打开、关闭和读取等。<code>IDL</code>中的逻辑设备号范围是<code>-2—128</code>，其中<code>1-99</code>是可以用户任意指定的，<code>100-128</code>是根据<code>get_lun</code>和<code>free_lun</code>来管理的，其他是特殊函数专用的。<code>IDL</code>中文件操作的函数列表：</p>
<table>
<thead>
<tr>
<th>函数名字</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td><code>OpenR</code></td>
<td>以只读方式打开已存在文件；</td>
</tr>
<tr>
<td><code>OpenW</code></td>
<td>创建一个可以读写的新文件；</td>
</tr>
<tr>
<td><code>OpenU</code></td>
<td>以更新模式打开已存在文件；</td>
</tr>
<tr>
<td><code>File_Search()</code></td>
<td>对文件名进行特定的查找；</td>
</tr>
<tr>
<td><code>Dialog_Pickfile()</code></td>
<td>对话框方式选择文件；</td>
</tr>
<tr>
<td><code>Fstat()</code></td>
<td>返回一个已打开文件的信息；</td>
</tr>
<tr>
<td><code>EOF()</code></td>
<td>检测是否到文件末；</td>
</tr>
<tr>
<td><code>CLOSE</code></td>
<td>关闭一个文件；</td>
</tr>
<tr>
<td><code>Free_Lun</code></td>
<td>释放一个逻辑设备号并关闭文件；</td>
</tr>
</tbody></table>
<p><code>IDL</code>在读写该文件分为有两种格式化文件：自由文件格式和确定的文件格式。</p>
<p>自由文件格式是用逗号或空白（<code>tab</code>键和空格键）分开文件中的每个元素的<code>ASCII</code>文件。确定的格式文件是用格式说明按照给定的规范进行编排的。二者相比后者比前者更正规一些。</p>
<p><strong>读写自由文件格式：</strong><code>IDL</code>下用<code>ReadF</code>从文件中读入自由格式数据，<code>Printf</code>写入自由格式数据到文件中。<code>IDL</code>中读写自由格式文件遵循下面的几个规则：</p>
<ul>
<li><p>如果读入到字符串变量中，那么，在当前行剩下的所有字符都将读入该变量中；</p>
</li>
<li><p>输入数据必须用逗号或空白分隔（空格键或 tab 键）；</p>
</li>
<li><p>输入通过数字变量完成。数组和结构都可作为数字变量的集合；</p>
</li>
<li><p>如果当前读入行是空的，并且还有变量要求输入，则读取另一行；</p>
</li>
<li><p>如果当前读入行不是空的，但是没有变量要求输入，则忽略此行剩下的数；</p>
</li>
<li><p>尽量将数据转换为变量所希望的数据类型；</p>
</li>
<li><p>复数数据必须有实数和虚数两部分，用逗号分隔，并用括号括起来。</p>
</li>
</ul>
<p><strong>读写确定的文件格式：</strong>读写确定文件格式可同样用<code>ReadF</code>和<code>PrintF</code>命令，它们刚才已用于自由格式文件，但现在文件格式已由<code>Format</code>关键字明确声明。（在读写标准输入和输出时，也可将<code>Format</code>关键字用于<code>Read</code>和<code>Print</code>令）。</p>
<h3 id="👀CSV-2"><a href="#👀CSV-2" class="headerlink" title="👀CSV"></a>👀CSV</h3><p><code>CSV</code>示例源文件：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">lon,lat,area</span><br><span class="line">101,50,20</span><br><span class="line">102,51,22</span><br><span class="line">103,52,24</span><br><span class="line">104,53,21</span><br><span class="line">105,54,25</span><br><span class="line">106,55,20</span><br><span class="line">107,56,25</span><br><span class="line">108,57,20</span><br><span class="line">109,58,18</span><br><span class="line">110,59,20.58333333</span><br><span class="line">111,60,20.36666667</span><br><span class="line">112,61,20.15</span><br><span class="line">113,62,19.93333333</span><br><span class="line">114,63,19.71666667</span><br><span class="line">115,64,19.5</span><br><span class="line">116,65,19.28333333</span><br></pre></td></tr></table></figure>

<p>读取<code>CSV</code>文件：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pro Demo02</span><br><span class="line">  ; 打开csv文件</span><br><span class="line">  csv_file = &#x27;D:\Desktop\data_p2.csv&#x27;</span><br><span class="line">  ; 读取文件</span><br><span class="line">  ; 第一行是索引,参数par_name(无论需不需要第一行索引数据，read_csv()函数默认都不会去读取第一行的数据)</span><br><span class="line">  data_csv = Read_csv(csv_file, header=par_name)</span><br><span class="line">  ; 查看data的类型,是一个结构体</span><br><span class="line">  ; Help, data_csv</span><br><span class="line">  ; 输出第一列数据</span><br><span class="line">  Print, data_csv.(0)</span><br><span class="line">  ; 输出第一行的索引数据</span><br><span class="line">  Print, par_name</span><br><span class="line">  ; 输出列索引是lat的数据(第一种方法可以数它所在的列号按上面的方式进行读取并输出，也可按下面这种方法)</span><br><span class="line">  lon = Where(par_name EQ &#x27;lat&#x27;)</span><br><span class="line">  Print, data_csv.(lon) </span><br><span class="line">END</span><br><span class="line"></span><br><span class="line">; IDL控制台输出结果（结果样式与控制台的宽度有关）</span><br><span class="line">% Compiled module: DEMO02.</span><br><span class="line">         101         102         103         104         105</span><br><span class="line">         106         107         108         109         110</span><br><span class="line">         111         112         113         114         115</span><br><span class="line">         116</span><br><span class="line">lon lat area</span><br><span class="line">          50          51          52          53          54</span><br><span class="line">          55          56          57          58          59</span><br><span class="line">          60          61          62          63          64</span><br><span class="line">          65</span><br></pre></td></tr></table></figure>

<p>写入<code>CSV</code>文件：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pro Demo04_csv</span><br><span class="line">    ; 打开csv文件,获取数据</span><br><span class="line">    csv_file = &#x27;D:\Desktop\data_p2.csv&#x27;</span><br><span class="line">    ; 读取文件</span><br><span class="line">    ; 第一行的索引给了,参数par_name(但是无论你需不需要第一行索引数据，read_csv()函数默认都不会去读取第一行的数据)</span><br><span class="line">    data_csv = Read_csv(csv_file, header=par_name)</span><br><span class="line">    ; 查看data的类型,是一个结构体</span><br><span class="line">    ; Help, data_csv</span><br><span class="line">    ; 输出第一列数据</span><br><span class="line">    Print, data_csv.(0)</span><br><span class="line">    ; 输出第一行的索引数据</span><br><span class="line">    Print, par_name</span><br><span class="line">    ; 输出列索引是lat的数据(第一种方法你可以自己去数它所在的列号按上面的方式进行读取并输出，也可以按下面这种方法)</span><br><span class="line">    lon = Where(par_name EQ &#x27;lat&#x27;)</span><br><span class="line">    Print, data_csv.(lon)</span><br><span class="line">    </span><br><span class="line">    ; 写入csv文件</span><br><span class="line">    save_file = &#x27;D:\Desktop\data_p3.csv&#x27;</span><br><span class="line">    data_size = size(data_csv.(2))</span><br><span class="line">    length = data_size[-1]</span><br><span class="line">    data_box = fltarr(3,length)</span><br><span class="line">    data_box[0,*] = data_csv.(0)</span><br><span class="line">    data_box[1,*] = data_csv.(1)</span><br><span class="line">    data_box[2,*] = data_csv.(2)</span><br><span class="line">    print,data_box</span><br><span class="line">    Write_csv, save_file, data_box</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">; IDL控制台输出结果</span><br><span class="line">% Compiled module: DEMO04_CSV.</span><br><span class="line">         101         102         103</span><br><span class="line">         104         105         106</span><br><span class="line">         107         108         109</span><br><span class="line">         110         111         112</span><br><span class="line">         113         114         115</span><br><span class="line">         116</span><br><span class="line">lon lat area</span><br><span class="line">          50          51          52</span><br><span class="line">          53          54          55</span><br><span class="line">          56          57          58</span><br><span class="line">          59          60          61</span><br><span class="line">          62          63          64</span><br><span class="line">          65</span><br><span class="line">      101.000      50.0000      20.0000</span><br><span class="line">      102.000      51.0000      22.0000</span><br><span class="line">      103.000      52.0000      24.0000</span><br><span class="line">      104.000      53.0000      21.0000</span><br><span class="line">      105.000      54.0000      25.0000</span><br><span class="line">      106.000      55.0000      20.0000</span><br><span class="line">      107.000      56.0000      25.0000</span><br><span class="line">      108.000      57.0000      20.0000</span><br><span class="line">      109.000      58.0000      18.0000</span><br><span class="line">      110.000      59.0000      20.5833</span><br><span class="line">      111.000      60.0000      20.3667</span><br><span class="line">      112.000      61.0000      20.1500</span><br><span class="line">      113.000      62.0000      19.9333</span><br><span class="line">      114.000      63.0000      19.7167</span><br><span class="line">      115.000      64.0000      19.5000</span><br><span class="line">      116.000      65.0000      19.2833</span><br><span class="line">% Compiled module: WRITE_CSV.</span><br></pre></td></tr></table></figure>

<h3 id="👀XML-2"><a href="#👀XML-2" class="headerlink" title="👀XML"></a>👀XML</h3><p><code>XML</code>示例源文件：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;ISO-8859-1&quot;</span>?&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Edited by XMLSpyÂ® --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">breakfast_menu</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">food</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">name</span>&gt;</span>Belgian Waffles<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">price</span>&gt;</span>$5.95<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">calories</span>&gt;</span>650<span class="tag">&lt;/<span class="name">calories</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">cropRegion</span> <span class="attr">x</span>=<span class="string">&quot;0&quot;</span> <span class="attr">y</span>=<span class="string">&quot;0&quot;</span> <span class="attr">width</span>=<span class="string">&quot;0000&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1234&quot;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">food</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">food</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">name</span>&gt;</span>Strawberry Belgian Waffles<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">price</span>&gt;</span>$7.95<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">calories</span>&gt;</span>900<span class="tag">&lt;/<span class="name">calories</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">cropRegion</span> <span class="attr">x</span>=<span class="string">&quot;1&quot;</span> <span class="attr">y</span>=<span class="string">&quot;1&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1111&quot;</span> <span class="attr">height</span>=<span class="string">&quot;2345&quot;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">food</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">food</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">name</span>&gt;</span>Berry-Berry Belgian Waffles<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">price</span>&gt;</span>$8.95<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">calories</span>&gt;</span>900<span class="tag">&lt;/<span class="name">calories</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">cropRegion</span> <span class="attr">x</span>=<span class="string">&quot;2&quot;</span> <span class="attr">y</span>=<span class="string">&quot;2&quot;</span> <span class="attr">width</span>=<span class="string">&quot;2222&quot;</span> <span class="attr">height</span>=<span class="string">&quot;3456&quot;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">food</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">food</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">name</span>&gt;</span>French Toast<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">price</span>&gt;</span>$4.50<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">calories</span>&gt;</span>600<span class="tag">&lt;/<span class="name">calories</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">cropRegion</span> <span class="attr">x</span>=<span class="string">&quot;3&quot;</span> <span class="attr">y</span>=<span class="string">&quot;3&quot;</span> <span class="attr">width</span>=<span class="string">&quot;3333&quot;</span> <span class="attr">height</span>=<span class="string">&quot;4567&quot;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">food</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">food</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">name</span>&gt;</span>Homestyle Breakfast<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">price</span>&gt;</span>$6.95<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">calories</span>&gt;</span>950<span class="tag">&lt;/<span class="name">calories</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">cropRegion</span> <span class="attr">x</span>=<span class="string">&quot;4&quot;</span> <span class="attr">y</span>=<span class="string">&quot;4&quot;</span> <span class="attr">width</span>=<span class="string">&quot;4444&quot;</span> <span class="attr">height</span>=<span class="string">&quot;5678&quot;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">food</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">breakfast_menu</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>读取<code>XML</code>文件：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pro Demo02</span><br><span class="line">  XML_file = &#x27;D:\Desktop\simple.xml&#x27;</span><br><span class="line">  XML = IDLffXMLDOMDocument(filename = XML_file)</span><br><span class="line">  name = XML.Getelementsbytagname(&#x27;name&#x27;)</span><br><span class="line">  name = name.item(4)</span><br><span class="line">  print,(name.getfirstchild()).getnodevalue()</span><br><span class="line">  ; 获取属性值</span><br><span class="line">  cropRegion = XML.Getelementsbytagname(&#x27;cropRegion&#x27;)</span><br><span class="line">  cropRegion = cropRegion.Item(4)</span><br><span class="line">  print,cropRegion.GetAttribute(&#x27;height&#x27;)</span><br><span class="line">  ; 销毁对象</span><br><span class="line">  Obj_destroy, name</span><br><span class="line">  Obj_destroy, XML</span><br><span class="line">END</span><br><span class="line"></span><br><span class="line">; IDL控制台输出结果</span><br><span class="line">% Compiled module: DEMO02.</span><br><span class="line">Homestyle Breakfast</span><br><span class="line">5678</span><br></pre></td></tr></table></figure>

<h3 id="👀TXT-1"><a href="#👀TXT-1" class="headerlink" title="👀TXT"></a>👀TXT</h3><p><code>TXT</code>示例源文件：</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">lon	lat	area</span><br><span class="line">101	50	20</span><br><span class="line">102	51	22</span><br><span class="line">103	52	24</span><br><span class="line">104	53	21</span><br><span class="line">105	54	25</span><br><span class="line">106	55	20</span><br><span class="line">107	56	25</span><br><span class="line">108	57	20</span><br><span class="line">109	58	18</span><br><span class="line">110	59	20.58333333</span><br><span class="line">111	60	20.36666667</span><br><span class="line">112	61	20.15</span><br><span class="line">113	62	19.93333333</span><br><span class="line">114	63	19.71666667</span><br><span class="line">115	64	19.5</span><br><span class="line">116	65	19.28333333</span><br></pre></td></tr></table></figure>

<p>读取<code>TXT</code>文件：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pro Demo02</span><br><span class="line">  ; 文件路径 </span><br><span class="line">  fn = &#x27;D:\Desktop\data_p1.txt&#x27;</span><br><span class="line">  ; （1）第一种方法，打开txt文件</span><br><span class="line">  ; 如果你只是读文件openr就可以了，openw既可以读也可以写(会覆盖原来的文件，慎用)</span><br><span class="line">  ; 第一个lun用来表示这个文件的内存地址,第二个fn是该文件的路径，第三个/get_lun动态获取地址</span><br><span class="line">  openr, lun, fn, /get_lun</span><br><span class="line">  ; 由于第一行是索引，索引是文字，索引下面是数字， 两者类型不一致，不能放在一个数组里面存储，所以需要跳过</span><br><span class="line">  ; 第一个lun表示文件的编号或者说是内存地址的代称，第二个1表示需要跳过的行数，这里只跳过第一行，所以是1，第三个表示第二个参数的单位是行而不是列</span><br><span class="line">  skip_lun, lun, 1, /lines</span><br><span class="line">  ; 创建存储的数组</span><br><span class="line">  ; 通过记事本打开该文件事先查看到该文件的数据的行列数(共有3列17行，但是第一行跳过所以只需要16行)</span><br><span class="line">  data = fltarr(3,16)</span><br><span class="line">  ; 获取文件的数据</span><br><span class="line">  readf, lun, data</span><br><span class="line">  ; 检验一下，获取某一个数据</span><br><span class="line">  print, data[2, -1]</span><br><span class="line">  ; 关闭文件</span><br><span class="line">  free_lun,lun</span><br><span class="line">  </span><br><span class="line">  ; （2）第二种方法，打开txt文件</span><br><span class="line">  openr, lun, fn, /get_lun</span><br><span class="line">  ; 获得第一行的索引数据，也是有用的(获取列数)</span><br><span class="line">  ; 预先有一个str变量存储</span><br><span class="line">  str = &#x27;&#x27;</span><br><span class="line">  ; readf是秉承着有多少给多少，现在str是一个字符串，默认输出一行，如果你是数组，那么根据数组的行列数有多少给多少</span><br><span class="line">  ; 对得到的存储有第一行索引数据的str变量进行分析，通过该字符串分析出整个数据有多少列</span><br><span class="line">  Readf, lun, str</span><br><span class="line">  ; 默认以空格作为该字符串的分隔符  </span><br><span class="line">  son_str_array = Strsplit(str, /extract)</span><br><span class="line">  ; son_str_array里面有几个元素，那么整个数据就有几列</span><br><span class="line">  column = N_elements(son_str_array)</span><br><span class="line">  ; 现在获取行数,第一行是索引,所以需要减去1</span><br><span class="line">  row = File_lines(fn) - 1</span><br><span class="line">  ; 创建存储的数组</span><br><span class="line">  box_data = Fltarr(column, row)</span><br><span class="line">  ; 获取数据（这里行数是从第二行开头开始的，因为前面已经readf, lun, str，文件指针已经指到第二行开头处）</span><br><span class="line">  Readf, lun, box_data</span><br><span class="line">  ; 检验一下，获取某一个数据</span><br><span class="line">  Print, box_data[2, -1]</span><br><span class="line">  ; 关闭文件</span><br><span class="line">  Free_lun, 1</span><br><span class="line">  </span><br><span class="line">  ; （3）第三种方法，打开txt文件</span><br><span class="line">  Openr, lun, fn, /get_lun</span><br><span class="line">  skip_lun, lun, 1, /lines</span><br><span class="line">  ; 读取文件的行数</span><br><span class="line">  row = File_lines(fn) - 1</span><br><span class="line">  ; 创建存储的列表,列数是通过txt记事本打开看到的</span><br><span class="line">  ; 相对来说，列数比较固定，行数不确定</span><br><span class="line">  box_data2 = Fltarr(5, row)</span><br><span class="line">  Readf, lun, box_data</span><br><span class="line">  ; 检验一下</span><br><span class="line">  Print, box_data[2, -1]</span><br><span class="line">  ; 关闭文件</span><br><span class="line">  Free_lun, lun</span><br><span class="line">END</span><br><span class="line"></span><br><span class="line">; IDL控制台输出结果</span><br><span class="line">% Compiled module: DEMO02.</span><br><span class="line">      19.2833</span><br><span class="line">      19.2833</span><br><span class="line">      19.2833</span><br></pre></td></tr></table></figure>

<p>写入<code>TXT</code>文件：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pro print_test</span><br><span class="line">  ;  写入txt</span><br><span class="line">  outfilepath=&#x27;D:\Desktop\&#x27;</span><br><span class="line">  outfilename = STRCOMPRESS(outfilepath+&#x27;navi_route.txt&#x27;,/remove_all)</span><br><span class="line">  openw,var_lun,outfilename,/get_lun</span><br><span class="line">  for i=1,365 do begin</span><br><span class="line">      z=i/2</span><br><span class="line">      if z gt 10 then begin</span><br><span class="line">        z=1024</span><br><span class="line">      endif else begin</span><br><span class="line">        z=150+i</span><br><span class="line">      endelse</span><br><span class="line">      printf,var_lun,FORMAT=&#x27;(I3,I10)&#x27;,i,z</span><br><span class="line">  endfor</span><br><span class="line">  close,var_lun</span><br><span class="line">  free_lun,var_lun</span><br><span class="line">  </span><br><span class="line">  ; 读取对应txt</span><br><span class="line">  infilepath=&#x27;D:\Desktop\&#x27;</span><br><span class="line">  Cd,infilepath</span><br><span class="line">  thesefiles = File_search(&#x27;navi_route.txt&#x27;)</span><br><span class="line">  result=Intarr(2,365)</span><br><span class="line">  Openr,lun,thesefiles[0],/get_lun</span><br><span class="line">  FOR i=0,365-1 DO BEGIN</span><br><span class="line">    Readf,lun,FORMAT=&#x27;(I3,I10)&#x27;,day,value</span><br><span class="line">    result[0,i]=Long(day)</span><br><span class="line">    result[1,i]=Long(value)</span><br><span class="line">  ENDFOR</span><br><span class="line">  Free_lun,lun</span><br><span class="line">  Print,result</span><br><span class="line">END</span><br><span class="line"></span><br><span class="line">; IDL控制台输出结果</span><br><span class="line">% Compiled module: PRINT_TEST.</span><br><span class="line">       1     151</span><br><span class="line">       2     152</span><br><span class="line">       3     153</span><br><span class="line">       4     154</span><br><span class="line">       5     155</span><br><span class="line">       6     156</span><br><span class="line">       7     157</span><br><span class="line">       8     158</span><br><span class="line">       9     159</span><br><span class="line">      10     160</span><br><span class="line">      11     161</span><br><span class="line">      ... 	...</span><br><span class="line">     358    1024</span><br><span class="line">	 359    1024</span><br><span class="line">     360    1024</span><br><span class="line">     361    1024</span><br><span class="line">     362    1024</span><br><span class="line">     363    1024</span><br><span class="line">     364    1024</span><br><span class="line">     365    1024</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://heartlovelife.github.io">Xiaotangsmiles</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://heartlovelife.github.io/2023/11/28/Files-ReadWrite/">https://heartlovelife.github.io/2023/11/28/Files-ReadWrite/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://heartlovelife.github.io" target="_blank">江湖是你画中亦是你</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%96%87%E4%BB%B6%E8%AF%BB%E5%86%99/">文件读写</a></div><div class="post_share"><div class="social-share" data-image="https://s2.loli.net/2024/01/17/5fyvO89JhpKPiz4.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/gh/overtrue/share.js@master/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/loading1.gif" data-original="/img/wechat.jpg" alt="wechat(微信)"/></a><div class="post-qr-code-desc">wechat(微信)</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/loading1.gif" data-original="/img/alipay.jpg" alt="alipay(支付宝)"/></a><div class="post-qr-code-desc">alipay(支付宝)</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/01/20/RS-LST-Method/"><img class="prev-cover" src="/img/loading1.gif" data-original="https://s2.loli.net/2024/05/05/SHmUYgArEMzfLph.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">辐射传输基础理论详解与LST反演方法</div></div></a></div><div class="next-post pull-right"><a href="/2023/10/28/Sentinel-Download/"><img class="next-cover" src="/img/loading1.gif" data-original="https://s2.loli.net/2023/10/28/Ure9cF4EkpH8QZJ.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">哨兵系列数据下载地址及流程更新【202310】</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/loading1.gif" data-original="/img/touxiang.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Xiaotangsmiles</div><div class="author-info__description">我们总以为来日方长，却忘了世事无常</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">25</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">25</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/HeartLoveLife"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/HeartLoveLife" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://blog.csdn.net/twg666" target="_blank" title="CSDN"><i class="fa fa-book-open"></i></a><a class="social-icon" href="tencent://AddContact/?fromId=45&amp;fromSubId=1&amp;subcmd=all&amp;uin=491037927&amp;website=www.oicqzone.com" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="mailto:xiaotangsmiles@163.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">我有我自己的太阳、月亮和星星，我有一个完全属于我自己的小世界。</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%9B%84%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">⛄前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%9B%84Python%E4%B9%8B%E8%AF%BB%E5%86%99%E6%96%87%E4%BB%B6"><span class="toc-number">2.</span> <span class="toc-text">⛄Python之读写文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%91%80CSV"><span class="toc-number">2.1.</span> <span class="toc-text">👀CSV</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%881%EF%BC%89CSV%E5%BA%93%E8%AF%BB%E5%8F%96"><span class="toc-number">2.1.1.</span> <span class="toc-text">（1）CSV库读取</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%882%EF%BC%89CSV%E5%BA%93%E5%86%99%E5%85%A5"><span class="toc-number">2.1.2.</span> <span class="toc-text">（2）CSV库写入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%883%EF%BC%89pandas%E5%BA%93%E8%AF%BB%E5%8F%96"><span class="toc-number">2.1.3.</span> <span class="toc-text">（3）pandas库读取</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%884%EF%BC%89pandas%E5%BA%93%E5%86%99%E5%85%A5"><span class="toc-number">2.1.4.</span> <span class="toc-text">（4）pandas库写入</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%91%80Excel"><span class="toc-number">2.2.</span> <span class="toc-text">👀Excel</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%881%EF%BC%89%E8%AF%BB%E5%8F%96Excel%E6%96%87%E4%BB%B6"><span class="toc-number">2.2.1.</span> <span class="toc-text">（1）读取Excel文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%882%EF%BC%89%E5%86%99%E5%85%A5Excel%E6%96%87%E4%BB%B6"><span class="toc-number">2.2.2.</span> <span class="toc-text">（2）写入Excel文件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%91%80JSON"><span class="toc-number">2.3.</span> <span class="toc-text">👀JSON</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%91%80XML"><span class="toc-number">2.4.</span> <span class="toc-text">👀XML</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%881%EF%BC%89%E8%AF%BB%E5%8F%96XML"><span class="toc-number">2.4.1.</span> <span class="toc-text">（1）读取XML</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%882%EF%BC%89%E5%86%99%E5%85%A5XML"><span class="toc-number">2.4.2.</span> <span class="toc-text">（2）写入XML</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%91%80TXT"><span class="toc-number">2.5.</span> <span class="toc-text">👀TXT</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%881%EF%BC%89%E8%AF%BB%E5%8F%96TXT"><span class="toc-number">2.5.1.</span> <span class="toc-text">（1）读取TXT</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%882%EF%BC%89%E5%86%99%E5%85%A5TXT"><span class="toc-number">2.5.2.</span> <span class="toc-text">（2）写入TXT</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%9B%84Matlab%E4%B9%8B%E8%AF%BB%E5%86%99%E6%96%87%E4%BB%B6"><span class="toc-number">3.</span> <span class="toc-text">⛄Matlab之读写文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%91%80CSV-1"><span class="toc-number">3.1.</span> <span class="toc-text">👀CSV</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%881%EF%BC%89csvread-%E4%B8%8D%E6%8E%A8%E8%8D%90"><span class="toc-number">3.1.1.</span> <span class="toc-text">（1）csvread()(不推荐)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%882%EF%BC%89readmatrix"><span class="toc-number">3.1.2.</span> <span class="toc-text">（2）readmatrix()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%883%EF%BC%89importdata"><span class="toc-number">3.1.3.</span> <span class="toc-text">（3）importdata()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%884%EF%BC%89readtable"><span class="toc-number">3.1.4.</span> <span class="toc-text">（4）readtable()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%885%EF%BC%89csvwrite-%E4%B8%8D%E6%8E%A8%E8%8D%90"><span class="toc-number">3.1.5.</span> <span class="toc-text">（5）csvwrite()(不推荐)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%886%EF%BC%89writematrix"><span class="toc-number">3.1.6.</span> <span class="toc-text">（6）writematrix()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%887%EF%BC%89dlmwrite-%E4%B8%8D%E6%8E%A8%E8%8D%90"><span class="toc-number">3.1.7.</span> <span class="toc-text">（7）dlmwrite()(不推荐)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%888%EF%BC%89writetable"><span class="toc-number">3.1.8.</span> <span class="toc-text">（8）writetable()</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%91%80Excel-1"><span class="toc-number">3.2.</span> <span class="toc-text">👀Excel</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%881%EF%BC%89xlsread-%E4%B8%8D%E6%8E%A8%E8%8D%90"><span class="toc-number">3.2.1.</span> <span class="toc-text">（1）xlsread()(不推荐)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%882%EF%BC%89readmatrix-1"><span class="toc-number">3.2.2.</span> <span class="toc-text">（2）readmatrix()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%883%EF%BC%89readtable"><span class="toc-number">3.2.3.</span> <span class="toc-text">（3）readtable()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%884%EF%BC%89xlswrite-%E4%B8%8D%E6%8E%A8%E8%8D%90"><span class="toc-number">3.2.4.</span> <span class="toc-text">（4）xlswrite()(不推荐)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%885%EF%BC%89writematrix"><span class="toc-number">3.2.5.</span> <span class="toc-text">（5）writematrix()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%886%EF%BC%89writetable"><span class="toc-number">3.2.6.</span> <span class="toc-text">（6）writetable()</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%91%80JSON-1"><span class="toc-number">3.3.</span> <span class="toc-text">👀JSON</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%91%80XML-1"><span class="toc-number">3.4.</span> <span class="toc-text">👀XML</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%881%EF%BC%89%E8%AF%BB%E5%8F%96XML-1"><span class="toc-number">3.4.1.</span> <span class="toc-text">（1）读取XML</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%882%EF%BC%89%E5%86%99%E5%85%A5XML-1"><span class="toc-number">3.4.2.</span> <span class="toc-text">（2）写入XML</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%91%80TXT%EF%BC%88%E5%87%BD%E6%95%B0%E4%BE%8B%E4%B8%BE%EF%BC%89"><span class="toc-number">3.5.</span> <span class="toc-text">👀TXT（函数例举）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%9B%84IDL%E4%B9%8B%E8%AF%BB%E5%86%99%E6%96%87%E4%BB%B6"><span class="toc-number">4.</span> <span class="toc-text">⛄IDL之读写文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%91%80CSV-2"><span class="toc-number">4.1.</span> <span class="toc-text">👀CSV</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%91%80XML-2"><span class="toc-number">4.2.</span> <span class="toc-text">👀XML</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%91%80TXT-1"><span class="toc-number">4.3.</span> <span class="toc-text">👀TXT</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/09/23/Matlab-GUI-Design/" title="GUI编程之MATLAB入门详解（01）"><img src="/img/loading1.gif" data-original="https://s2.loli.net/2024/08/25/u7qX6PLeFUzxHvV.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="GUI编程之MATLAB入门详解（01）"/></a><div class="content"><a class="title" href="/2024/09/23/Matlab-GUI-Design/" title="GUI编程之MATLAB入门详解（01）">GUI编程之MATLAB入门详解（01）</a><time datetime="2024-09-23T14:22:08.000Z" title="发表于 2024-09-23 22:22:08">2024-09-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/09/15/RS-data-dowmload/" title="MODIS/Landsat/Sentinel下载教程详解【常用网站及方法枚举】"><img src="/img/loading1.gif" data-original="https://s2.loli.net/2024/09/15/xhwoIklLQq2mFp8.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MODIS/Landsat/Sentinel下载教程详解【常用网站及方法枚举】"/></a><div class="content"><a class="title" href="/2024/09/15/RS-data-dowmload/" title="MODIS/Landsat/Sentinel下载教程详解【常用网站及方法枚举】">MODIS/Landsat/Sentinel下载教程详解【常用网站及方法枚举】</a><time datetime="2024-09-15T03:24:52.000Z" title="发表于 2024-09-15 11:24:52">2024-09-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/08/25/Python-GUI-Design/" title="GUI编程之PyQt5入门详解（01）"><img src="/img/loading1.gif" data-original="https://s2.loli.net/2024/08/25/u7qX6PLeFUzxHvV.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="GUI编程之PyQt5入门详解（01）"/></a><div class="content"><a class="title" href="/2024/08/25/Python-GUI-Design/" title="GUI编程之PyQt5入门详解（01）">GUI编程之PyQt5入门详解（01）</a><time datetime="2024-08-25T12:36:36.000Z" title="发表于 2024-08-25 20:36:36">2024-08-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/06/10/DL-PyTorch-Basic/" title="Python深度学习之PyTorch基础教程"><img src="/img/loading1.gif" data-original="https://s2.loli.net/2024/06/10/KdBQXSmlCgFOWR1.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Python深度学习之PyTorch基础教程"/></a><div class="content"><a class="title" href="/2024/06/10/DL-PyTorch-Basic/" title="Python深度学习之PyTorch基础教程">Python深度学习之PyTorch基础教程</a><time datetime="2024-06-10T14:00:05.000Z" title="发表于 2024-06-10 22:00:05">2024-06-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/01/20/RS-LST-Method/" title="辐射传输基础理论详解与LST反演方法"><img src="/img/loading1.gif" data-original="https://s2.loli.net/2024/05/05/SHmUYgArEMzfLph.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="辐射传输基础理论详解与LST反演方法"/></a><div class="content"><a class="title" href="/2024/01/20/RS-LST-Method/" title="辐射传输基础理论详解与LST反演方法">辐射传输基础理论详解与LST反演方法</a><time datetime="2024-01-20T14:16:05.000Z" title="发表于 2024-01-20 22:16:05">2024-01-20</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2024 By Xiaotangsmiles</div><div class="framework-info"><span>地址 </span><a href="https://heartlovelife.github.io">HeartLoveLife</a><span class="footer-separator">|</span><span>邮箱 </span><a href="javascript:void(0);">xiaotangsmiles@163.com</a></div><div class="footer_custom_text">Hi, welcome to my <a href="https://heartlovelife.github.io/">blog</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div>
        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(r){r.imageLazyLoadSetting.processImages=t;var e=r.imageLazyLoadSetting.isSPA,n=r.imageLazyLoadSetting.preloadRatio||1,c=a();function a(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(){e&&(c=a());for(var t,o=0;o<c.length;o++)0<=(t=(t=c[o]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(r.innerHeight*n||document.documentElement.clientHeight*n)&&function(){var t,e,n,a,i=c[o];e=function(){c=c.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(n=new Image,a=t.getAttribute("data-original"),n.onload=function(){t.src=a,t.removeAttribute("data-original"),e&&e()},t.src!==a&&(n.src=a))}()}function i(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",i),r.addEventListener("resize",i),r.addEventListener("orientationchange",i)}(this);</script></body></html>